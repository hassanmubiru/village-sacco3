(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5170],{899:(e,s,a)=>{Promise.resolve().then(a.bind(a,5159))},2045:(e,s,a)=>{"use strict";a.d(s,{G:()=>l,j:()=>t});var r=a(3415);let t=()=>(0,r.wA)(),l=r.d4},5159:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>o});var r=a(5155),t=a(2115),l=a(2045);let n=e=>{let s,{card:a,onCreateCard:l}=e,[n,i]=(0,t.useState)(!1),[d,c]=(0,t.useState)(!1),o=async()=>{c(!0);try{await l()}finally{c(!1)}},x=e=>e?e.replace(/(\d{4})(\d{4})(\d{4})(\d{4})/,"$1 $2 $3 $4"):"";return a?(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Virtual Card"}),(0,r.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("active"===a.status?"bg-green-100 text-green-800":"blocked"===a.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:a.status.charAt(0).toUpperCase()+a.status.slice(1)})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl p-6 text-white shadow-lg",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-blue-100 text-sm",children:"SACCO Card"}),(0,r.jsx)("p",{className:"text-xs text-blue-100",children:"Virtual"})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-white bg-opacity-20 rounded-full"}),(0,r.jsx)("div",{className:"w-8 h-8 bg-white bg-opacity-30 rounded-full -ml-4"})]})]}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("p",{className:"text-xl font-mono tracking-wider",children:n?x(a.cardNumber):(e=>e?e.replace(/(\d{4})(\d{4})(\d{4})(\d{4})/,"$1 **** **** $4"):"")(a.cardNumber)})}),(0,r.jsxs)("div",{className:"flex justify-between items-end",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-blue-100 text-xs",children:"CARD HOLDER"}),(0,r.jsx)("p",{className:"font-semibold",children:a.holderName})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-blue-100 text-xs",children:"EXPIRES"}),(0,r.jsx)("p",{className:"font-semibold",children:a.expiryDate})]})]})]}),(0,r.jsx)("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Available Balance"}),(0,r.jsx)("span",{className:"font-semibold text-lg",children:(s=a.balance,new Intl.NumberFormat("en-UG",{style:"currency",currency:"UGX",minimumFractionDigits:0}).format(s).replace("UGX","UGX "))})]})})]}),(0,r.jsxs)("div",{className:"mt-6 space-y-3",children:[(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("button",{onClick:()=>i(!n),className:"flex-1 bg-gray-100 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-200 transition-colors",children:n?"Hide Details":"Show Details"}),(0,r.jsx)("button",{className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"Top Up"})]}),n&&(0,r.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"Card Number"}),(0,r.jsx)("p",{className:"font-mono",children:x(a.cardNumber)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"CVV"}),(0,r.jsx)("p",{className:"font-mono",children:a.cvv})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"Expiry Date"}),(0,r.jsx)("p",{children:a.expiryDate})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"Card ID"}),(0,r.jsx)("p",{className:"font-mono text-xs",children:a.id})]})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,r.jsxs)("button",{className:"flex flex-col items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-gray-600 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),(0,r.jsx)("span",{className:"text-xs text-gray-600",children:"Block"})]}),(0,r.jsxs)("button",{className:"flex flex-col items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-gray-600 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,r.jsx)("span",{className:"text-xs text-gray-600",children:"Statement"})]}),(0,r.jsxs)("button",{className:"flex flex-col items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,r.jsxs)("svg",{className:"w-5 h-5 text-gray-600 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,r.jsx)("span",{className:"text-xs text-gray-600",children:"Settings"})]})]})]})]}):(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Virtual Card"}),(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("svg",{className:"w-10 h-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"No virtual card found"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mb-6",children:"Create a virtual card to make online payments and transactions"}),(0,r.jsx)("button",{onClick:o,disabled:d,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:d?"Creating...":"Create Virtual Card"})]})]})};var i=a(6874),d=a.n(i);let c=()=>{let{user:e}=(0,l.G)(e=>e.auth),[s,a]=(0,t.useState)({balance:0,totalContributions:0,groupCount:0}),[i,c]=(0,t.useState)(null),[o,x]=(0,t.useState)(!0),[m,h]=(0,t.useState)(null);(0,t.useEffect)(()=>{(null==e?void 0:e.id)&&(u(),g())},[e]);let u=async()=>{try{x(!0),h(null);let t=await fetch("/api/dashboard/summary?userId=".concat(null==e?void 0:e.id));if(!t.ok)throw Error("Failed to fetch savings data");let l=await t.json();if(l.success){var s,r;a({balance:l.summary.totalSavings,totalContributions:l.summary.totalSavings,groupCount:l.summary.userMemberships,lastContribution:null==(r=l.summary.recentTransactions)||null==(s=r[0])?void 0:s.date})}else h(l.error||"Failed to load savings data")}catch(e){console.error("Error fetching savings data:",e),h("Failed to load savings data")}finally{x(!1)}},g=async()=>{try{let s=await fetch("/api/virtual-cards?userId=".concat(null==e?void 0:e.id));if(!s.ok)throw Error("Failed to fetch virtual card");let a=await s.json();if(a.success&&a.cards.length>0){let e=a.cards[0];c({id:e.id,cardNumber:e.card_number,holderName:e.holder_name,expiryDate:e.expiry_date,cvv:e.cvv,balance:e.balance,status:e.status})}}catch(e){console.error("Error fetching virtual card:",e)}},j=async()=>{try{let s="".concat((null==e?void 0:e.first_name)||""," ").concat((null==e?void 0:e.last_name)||"").trim()||(null==e?void 0:e.name)||"SACCO Member",a=await fetch("/api/virtual-cards",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:null==e?void 0:e.id,holderName:s})});if(!a.ok)throw Error("Failed to create virtual card");let r=await a.json();if(r.success){let e=r.card;c({id:e.id,cardNumber:e.card_number,holderName:e.holder_name,expiryDate:e.expiry_date,cvv:e.cvv,balance:e.balance,status:e.status})}}catch(e){console.error("Error creating virtual card:",e),h("Failed to create virtual card")}},v=e=>new Intl.NumberFormat("en-UG",{style:"currency",currency:"UGX",minimumFractionDigits:0}).format(e).replace("UGX","UGX ");return o?(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 animate-pulse",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-32 mb-4"}),(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded w-48 mb-2"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-24"})]})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"bg-gradient-to-r from-green-600 to-green-700 rounded-lg shadow-lg p-6 text-white",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-green-100",children:"Total Savings Balance"}),(0,r.jsx)("p",{className:"text-3xl font-bold mt-1",children:v(s.balance)}),(0,r.jsxs)("p",{className:"text-green-100 text-sm mt-1",children:["Across ",s.groupCount," SACCO group",1!==s.groupCount?"s":""]})]}),(0,r.jsx)("div",{className:"text-right",children:(0,r.jsx)("button",{onClick:u,className:"bg-green-500 hover:bg-green-400 text-white px-4 py-2 rounded-lg transition-colors text-sm",children:"Refresh"})})]})}),m&&(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,r.jsx)("p",{className:"text-red-600",children:m}),(0,r.jsx)("button",{onClick:u,className:"mt-2 text-sm text-red-700 hover:text-red-900 underline",children:"Try again"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Contributions"}),(0,r.jsx)("p",{className:"text-xl font-bold text-gray-900",children:v(s.totalContributions)})]})]})}),(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"SACCO Groups"}),(0,r.jsx)("p",{className:"text-xl font-bold text-gray-900",children:s.groupCount})]})]})}),(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Last Activity"}),(0,r.jsx)("p",{className:"text-xl font-bold text-gray-900",children:s.lastContribution?new Date(s.lastContribution).toLocaleDateString():"No activity"})]})]})})]}),(0,r.jsx)(n,{card:i||void 0,onCreateCard:j}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)(d(),{href:"/sacco",className:"flex flex-col items-center p-4 border-2 border-dashed border-gray-200 rounded-lg hover:border-green-500 hover:bg-green-50 transition-colors",children:[(0,r.jsx)("svg",{className:"w-8 h-8 text-green-600 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Add Savings"}),(0,r.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:"Contribute to your SACCO"})]}),(0,r.jsxs)(d(),{href:"/transactions",className:"flex flex-col items-center p-4 border-2 border-dashed border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors",children:[(0,r.jsx)("svg",{className:"w-8 h-8 text-blue-600 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"View Transactions"}),(0,r.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:"Check your history"})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center p-4 border-2 border-dashed border-gray-200 rounded-lg opacity-50",children:[(0,r.jsx)("svg",{className:"w-8 h-8 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-500",children:"Bitcoin Wallet"}),(0,r.jsx)("span",{className:"text-xs text-gray-400 mt-1",children:"Coming soon"})]})]})]})]})};function o(){return(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:["      ",(0,r.jsxs)("div",{className:"mb-8",children:["        ",(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"My Wallet"}),"        ",(0,r.jsx)("p",{className:"text-gray-600",children:"          Manage your SACCO savings and view your financial overview        "}),"      "]}),"            ",(0,r.jsx)(c,{}),"    "]})}}},e=>{e.O(0,[3415,6874,8441,5964,7358],()=>e(e.s=899)),_N_E=e.O()}]);