(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[879],{2045:(e,a,t)=>{"use strict";t.d(a,{G:()=>n,j:()=>s});var r=t(3415);let s=()=>(0,r.wA)(),n=r.d4},2099:(e,a,t)=>{"use strict";t.d(a,{ND:()=>l});var r=t(5647);t(9509);let s="https://zvelgxclmqgohntjimyf.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp2ZWxneGNsbXFnb2hudGppbXlmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkyOTkzMDUsImV4cCI6MjA2NDg3NTMwNX0.CFdW-XH8y7hkOm7LUtqQxs36hPTRBYtha4EIeRhIXto";if(!s||!n)throw Error("Missing Supabase environment variables");let l=(0,r.UU)(s,n,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0},global:{fetch:function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return fetch(e,{...a,signal:AbortSignal.timeout(3e4)})}},db:{schema:"public"},realtime:{params:{eventsPerSecond:10}}})},5695:(e,a,t)=>{"use strict";var r=t(8999);t.o(r,"useRouter")&&t.d(a,{useRouter:function(){return r.useRouter}})},8814:(e,a,t)=>{Promise.resolve().then(t.bind(t,9349))},9349:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>c});var r=t(5155),s=t(2115),n=t(6874),l=t.n(n),o=t(5695),i=t(2045),d=t(9519),u=t(3568);function c(){let[e,a]=(0,s.useState)({name:"",email:"",phone:"",password:"",confirmPassword:""}),[t,n]=(0,s.useState)(!1),c=(0,i.j)(),m=(0,o.useRouter)(),h=e=>{let{name:t,value:r}=e.target;a(e=>({...e,[t]:r}))},p=async a=>{if(a.preventDefault(),!e.name||!e.email||!e.phone||!e.password)return void u.Ay.error("Please fill in all fields");if(e.password!==e.confirmPassword)return void u.Ay.error("Passwords do not match");if(e.password.length<6)return void u.Ay.error("Password must be at least 6 characters long");n(!0);try{let[a,...t]=e.name.split(" "),r=t.join(" ")||a,s=await c((0,d.DY)({email:e.email,password:e.password,firstName:a,lastName:r,phone:e.phone}));d.DY.fulfilled.match(s)?(u.Ay.success("Account created successfully!"),m.push("/dashboard")):u.Ay.error(s.payload||"Registration failed")}catch(e){u.Ay.error("Registration failed. Please try again.")}finally{n(!1)}};return(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center p-4",children:(0,r.jsx)("div",{className:"w-full max-w-md",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-8",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Village SACCO"}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"Create your account"})]}),(0,r.jsxs)("form",{onSubmit:p,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),(0,r.jsx)("input",{id:"name",name:"name",type:"text",value:e.name,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your full name",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),(0,r.jsx)("input",{id:"email",name:"email",type:"email",value:e.email,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your email",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),(0,r.jsx)("input",{id:"phone",name:"phone",type:"tel",value:e.phone,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"+256 701 234 567",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),(0,r.jsx)("input",{id:"password",name:"password",type:"password",value:e.password,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your password",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),(0,r.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:"password",value:e.confirmPassword,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Confirm your password",required:!0})]}),(0,r.jsx)("button",{type:"submit",disabled:t,className:"w-full py-2 px-4 rounded-md text-white font-medium ".concat(t?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"),children:t?"Creating Account...":"Sign Up"})]}),(0,r.jsx)("div",{className:"text-center mt-6",children:(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",(0,r.jsx)(l(),{href:"/login",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Sign in"})]})})]})})})}},9519:(e,a,t)=>{"use strict";t.d(a,{Ay:()=>m,DY:()=>l,Lx:()=>n,y4:()=>o,z:()=>i});var r=t(4536),s=t(2099);let n=(0,r.zD)("auth/loginUser",async(e,a)=>{let{email:t,password:r}=e,{rejectWithValue:n}=a;try{var l;let{data:e,error:a}=await s.ND.auth.signInWithPassword({email:t,password:r});if(a)throw a;let{data:n,error:o}=await s.ND.from("users").select("*").eq("id",e.user.id).single();if(o)throw o;return{user:{id:n.id,email:n.email,first_name:n.first_name,last_name:n.last_name,phone:n.phone,bitnob_wallet_id:n.bitnob_wallet_id,kyc_status:n.kyc_status,is_active:n.is_active,created_at:n.created_at,updated_at:n.updated_at,name:"".concat(n.first_name," ").concat(n.last_name)},token:(null==(l=e.session)?void 0:l.access_token)||""}}catch(e){return n(e.message)}}),l=(0,r.zD)("auth/registerUser",async(e,a)=>{let{email:t,password:r,firstName:s,lastName:n,phone:l}=e,{rejectWithValue:o}=a;try{let e=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"".concat(s," ").concat(n),email:t,phone:l,password:r})}),a=await e.json();if(!e.ok)throw Error(a.message);return{user:a.user,token:a.token||""}}catch(e){return o(e.message)}}),o=(0,r.zD)("auth/logoutUser",async()=>{await s.ND.auth.signOut()}),i=(0,r.zD)("auth/checkAuthStatus",async(e,a)=>{let{rejectWithValue:t}=a;try{let{data:{session:e}}=await s.ND.auth.getSession();if(!e)throw Error("No session found");let{data:a,error:t}=await s.ND.from("users").select("*").eq("id",e.user.id).single();if(t)throw t;return{user:{id:a.id,email:a.email,first_name:a.first_name,last_name:a.last_name,phone:a.phone,bitnob_wallet_id:a.bitnob_wallet_id,kyc_status:a.kyc_status,is_active:a.is_active,created_at:a.created_at,updated_at:a.updated_at,name:"".concat(a.first_name," ").concat(a.last_name)},token:e.access_token}}catch(e){return t(e.message)}}),d=(0,r.Z0)({name:"auth",initialState:{user:null,token:null,isAuthenticated:!1,loading:!1,error:null},reducers:{clearError:e=>{e.error=null},updateUser:(e,a)=>{e.user&&(e.user={...e.user,...a.payload})}},extraReducers:e=>{e.addCase(n.pending,e=>{e.loading=!0,e.error=null}).addCase(n.fulfilled,(e,a)=>{e.loading=!1,e.user=a.payload.user,e.token=a.payload.token,e.isAuthenticated=!0,e.error=null}).addCase(n.rejected,(e,a)=>{e.loading=!1,e.user=null,e.token=null,e.isAuthenticated=!1,e.error=a.payload}),e.addCase(l.pending,e=>{e.loading=!0,e.error=null}).addCase(l.fulfilled,(e,a)=>{e.loading=!1,e.user=a.payload.user,e.token=a.payload.token,e.isAuthenticated=!0,e.error=null}).addCase(l.rejected,(e,a)=>{e.loading=!1,e.user=null,e.token=null,e.isAuthenticated=!1,e.error=a.payload}),e.addCase(o.fulfilled,e=>{e.user=null,e.token=null,e.isAuthenticated=!1,e.loading=!1,e.error=null}),e.addCase(i.pending,e=>{e.loading=!0}).addCase(i.fulfilled,(e,a)=>{e.loading=!1,e.user=a.payload.user,e.token=a.payload.token,e.isAuthenticated=!0,e.error=null}).addCase(i.rejected,e=>{e.loading=!1,e.user=null,e.token=null,e.isAuthenticated=!1})}}),{clearError:u,updateUser:c}=d.actions,m=d.reducer}},e=>{e.O(0,[3415,5647,4536,6874,3568,8441,5964,7358],()=>e(e.s=8814)),_N_E=e.O()}]);