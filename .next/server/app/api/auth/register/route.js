/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/register/route";
exports.ids = ["app/api/auth/register/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2Fregister%2Froute&page=%2Fapi%2Fauth%2Fregister%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fregister%2Froute.ts&appDir=%2Fhome%2Ferror51%2Fbitnob%2Fproject%2Fvillage-sacco%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Ferror51%2Fbitnob%2Fproject%2Fvillage-sacco&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2Fregister%2Froute&page=%2Fapi%2Fauth%2Fregister%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fregister%2Froute.ts&appDir=%2Fhome%2Ferror51%2Fbitnob%2Fproject%2Fvillage-sacco%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Ferror51%2Fbitnob%2Fproject%2Fvillage-sacco&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=! ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handler: () => (/* binding */ handler),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/server/request-meta */ \"(rsc)/./node_modules/next/dist/server/request-meta.js\");\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(rsc)/./node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/app-paths */ \"next/dist/shared/lib/router/utils/app-paths\");\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/base-http/node */ \"(rsc)/./node_modules/next/dist/server/base-http/node.js\");\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! next/dist/server/web/spec-extension/adapters/next-request */ \"(rsc)/./node_modules/next/dist/server/web/spec-extension/adapters/next-request.js\");\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(rsc)/./node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! next/dist/server/instrumentation/utils */ \"(rsc)/./node_modules/next/dist/server/instrumentation/utils.js\");\n/* harmony import */ var next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! next/dist/server/send-response */ \"(rsc)/./node_modules/next/dist/server/send-response.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! next/dist/server/web/utils */ \"(rsc)/./node_modules/next/dist/server/web/utils.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! next/dist/server/lib/cache-control */ \"(rsc)/./node_modules/next/dist/server/lib/cache-control.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! next/dist/lib/constants */ \"(rsc)/./node_modules/next/dist/lib/constants.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__);\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! next/dist/shared/lib/no-fallback-error.external */ \"next/dist/shared/lib/no-fallback-error.external\");\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__);\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! next/dist/server/response-cache */ \"(rsc)/./node_modules/next/dist/server/response-cache/index.js\");\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__);\n/* harmony import */ var _home_error51_bitnob_project_village_sacco_src_app_api_auth_register_route_ts__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./src/app/api/auth/register/route.ts */ \"(rsc)/./src/app/api/auth/register/route.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/register/route\",\n        pathname: \"/api/auth/register\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/register/route\"\n    },\n    distDir: \".next\" || 0,\n    projectDir:  false || '',\n    resolvedPagePath: \"/home/error51/bitnob/project/village-sacco/src/app/api/auth/register/route.ts\",\n    nextConfigOutput,\n    userland: _home_error51_bitnob_project_village_sacco_src_app_api_auth_register_route_ts__WEBPACK_IMPORTED_MODULE_16__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\nasync function handler(req, res, ctx) {\n    var _nextConfig_experimental;\n    let srcPage = \"/api/auth/register/route\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {} else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = \"false\";\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return null;\n    }\n    const { buildId, params, nextConfig, isDraftMode, prerenderManifest, routerServerContext, isOnDemandRevalidate, revalidateOnlyGenerated, resolvedPathname } = prepareResult;\n    const normalizedSrcPage = (0,next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__.normalizeAppPath)(srcPage);\n    let isIsr = Boolean(prerenderManifest.dynamicRoutes[normalizedSrcPage] || prerenderManifest.routes[resolvedPathname]);\n    if (isIsr && !isDraftMode) {\n        const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname]);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                throw new next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError();\n            }\n        }\n    }\n    let cacheKey = null;\n    if (isIsr && !routeModule.isDev && !isDraftMode) {\n        cacheKey = resolvedPathname;\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    const supportsDynamicResponse = // If we're in development, we always support dynamic HTML\n    routeModule.isDev === true || // If this is not SSG or does not have static paths, then it supports\n    // dynamic HTML.\n    !isIsr;\n    // This is a revalidation request if the request is for a static\n    // page and it is not being resumed from a postponed render and\n    // it is not a dynamic RSC request then it is a revalidation\n    // request.\n    const isRevalidate = isIsr && !supportsDynamicResponse;\n    const method = req.method || 'GET';\n    const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.getTracer)();\n    const activeSpan = tracer.getActiveScopeSpan();\n    const context = {\n        params,\n        prerenderManifest,\n        renderOpts: {\n            experimental: {\n                dynamicIO: Boolean(nextConfig.experimental.dynamicIO),\n                authInterrupts: Boolean(nextConfig.experimental.authInterrupts)\n            },\n            supportsDynamicResponse,\n            incrementalCache: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'incrementalCache'),\n            cacheLifeProfiles: (_nextConfig_experimental = nextConfig.experimental) == null ? void 0 : _nextConfig_experimental.cacheLife,\n            isRevalidate,\n            waitUntil: ctx.waitUntil,\n            onClose: (cb)=>{\n                res.on('close', cb);\n            },\n            onAfterTaskError: undefined,\n            onInstrumentationRequestError: (error, _request, errorContext)=>routeModule.onRequestError(req, error, errorContext, routerServerContext)\n        },\n        sharedContext: {\n            buildId\n        }\n    };\n    const nodeNextReq = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextRequest(req);\n    const nodeNextRes = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextResponse(res);\n    const nextReq = next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.NextRequestAdapter.fromNodeNextRequest(nodeNextReq, (0,next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.signalFromNodeResponse)(res));\n    try {\n        const invokeRouteModule = async (span)=>{\n            return routeModule.handle(nextReq, context).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        };\n        const handleResponse = async (currentSpan)=>{\n            var _cacheEntry_value;\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                try {\n                    if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                        res.statusCode = 404;\n                        // on-demand revalidate always sets this header\n                        res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                        res.end('This page could not be found');\n                        return null;\n                    }\n                    const response = await invokeRouteModule(currentSpan);\n                    req.fetchMetrics = context.renderOpts.fetchMetrics;\n                    let pendingWaitUntil = context.renderOpts.pendingWaitUntil;\n                    // Attempt using provided waitUntil if available\n                    // if it's not we fallback to sendResponse's handling\n                    if (pendingWaitUntil) {\n                        if (ctx.waitUntil) {\n                            ctx.waitUntil(pendingWaitUntil);\n                            pendingWaitUntil = undefined;\n                        }\n                    }\n                    const cacheTags = context.renderOpts.collectedTags;\n                    // If the request is for a static response, we can cache it so long\n                    // as it's not edge.\n                    if (isIsr) {\n                        const blob = await response.blob();\n                        // Copy the headers from the response.\n                        const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.toNodeOutgoingHttpHeaders)(response.headers);\n                        if (cacheTags) {\n                            headers[next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER] = cacheTags;\n                        }\n                        if (!headers['content-type'] && blob.type) {\n                            headers['content-type'] = blob.type;\n                        }\n                        const revalidate = typeof context.renderOpts.collectedRevalidate === 'undefined' || context.renderOpts.collectedRevalidate >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? false : context.renderOpts.collectedRevalidate;\n                        const expire = typeof context.renderOpts.collectedExpire === 'undefined' || context.renderOpts.collectedExpire >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? undefined : context.renderOpts.collectedExpire;\n                        // Create the cache entry for the response.\n                        const cacheEntry = {\n                            value: {\n                                kind: next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE,\n                                status: response.status,\n                                body: Buffer.from(await blob.arrayBuffer()),\n                                headers\n                            },\n                            cacheControl: {\n                                revalidate,\n                                expire\n                            }\n                        };\n                        return cacheEntry;\n                    } else {\n                        // send response without caching if not ISR\n                        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, response, context.renderOpts.pendingWaitUntil);\n                        return null;\n                    }\n                } catch (err) {\n                    // if this is a background revalidate we need to report\n                    // the request error here as it won't be bubbled\n                    if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                        await routeModule.onRequestError(req, err, {\n                            routerKind: 'App Router',\n                            routePath: srcPage,\n                            routeType: 'route',\n                            revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                                isRevalidate,\n                                isOnDemandRevalidate\n                            })\n                        }, routerServerContext);\n                    }\n                    throw err;\n                }\n            };\n            const cacheEntry = await routeModule.handleResponse({\n                req,\n                nextConfig,\n                cacheKey,\n                routeKind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n                isFallback: false,\n                prerenderManifest,\n                isRoutePPREnabled: false,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                responseGenerator,\n                waitUntil: ctx.waitUntil\n            });\n            // we don't create a cacheEntry for ISR\n            if (!isIsr) {\n                return null;\n            }\n            if ((cacheEntry == null ? void 0 : (_cacheEntry_value = cacheEntry.value) == null ? void 0 : _cacheEntry_value.kind) !== next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE) {\n                var _cacheEntry_value1;\n                throw Object.defineProperty(new Error(`Invariant: app-route received invalid cache entry ${cacheEntry == null ? void 0 : (_cacheEntry_value1 = cacheEntry.value) == null ? void 0 : _cacheEntry_value1.kind}`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E701\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode')) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : cacheEntry.isMiss ? 'MISS' : cacheEntry.isStale ? 'STALE' : 'HIT');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.fromNodeOutgoingHttpHeaders)(cacheEntry.value.headers);\n            if (!((0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isIsr)) {\n                headers.delete(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER);\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheEntry.cacheControl && !res.getHeader('Cache-Control') && !headers.get('Cache-Control')) {\n                headers.set('Cache-Control', (0,next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__.getCacheControlHeader)(cacheEntry.cacheControl));\n            }\n            await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(cacheEntry.value.body, {\n                headers,\n                status: cacheEntry.value.status || 200\n            }));\n            return null;\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        // if we aren't wrapped by base-server handle here\n        if (!activeSpan) {\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'App Router',\n                routePath: normalizedSrcPage,\n                routeType: 'route',\n                revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                    isRevalidate,\n                    isOnDemandRevalidate\n                })\n            });\n        }\n        // rethrow so that we can handle serving error page\n        // If this is during static generation, throw the error again.\n        if (isIsr) throw err;\n        // Otherwise, send a 500 response.\n        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(null, {\n            status: 500\n        }));\n        return null;\n    }\n}\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZhdXRoJTJGcmVnaXN0ZXIlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmF1dGglMkZyZWdpc3RlciUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmF1dGglMkZyZWdpc3RlciUyRnJvdXRlLnRzJmFwcERpcj0lMkZob21lJTJGZXJyb3I1MSUyRmJpdG5vYiUyRnByb2plY3QlMkZ2aWxsYWdlLXNhY2NvJTJGc3JjJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZob21lJTJGZXJyb3I1MSUyRmJpdG5vYiUyRnByb2plY3QlMkZ2aWxsYWdlLXNhY2NvJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEJmlzR2xvYmFsTm90Rm91bmRFbmFibGVkPSEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDcUI7QUFDZDtBQUNTO0FBQ087QUFDSztBQUNtQztBQUNqRDtBQUNPO0FBQ2Y7QUFDc0M7QUFDekI7QUFDTTtBQUNDO0FBQ2hCO0FBQ3dDO0FBQzFHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix5R0FBbUI7QUFDM0M7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLGFBQWEsT0FBb0MsSUFBSSxDQUFFO0FBQ3ZELGdCQUFnQixNQUF1QztBQUN2RDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHNEQUFzRDtBQUM5RDtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUMwRjtBQUNuRjtBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLEtBQXFCLEVBQUUsRUFFMUIsQ0FBQztBQUNOO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixPQUF3QztBQUN2RTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxvSkFBb0o7QUFDaEssOEJBQThCLDZGQUFnQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsNkZBQWU7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsNEVBQVM7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLDhCQUE4Qiw2RUFBYztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsNEVBQWU7QUFDM0MsNEJBQTRCLDZFQUFnQjtBQUM1QyxvQkFBb0IseUdBQWtCLGtDQUFrQyxpSEFBc0I7QUFDOUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlFQUFpRSxnRkFBYztBQUMvRSwrREFBK0QseUNBQXlDO0FBQ3hHO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLFFBQVEsRUFBRSxNQUFNO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0Esa0JBQWtCO0FBQ2xCLHVDQUF1QyxRQUFRLEVBQUUsUUFBUTtBQUN6RDtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0Msb0JBQW9CO0FBQ25FO0FBQ0EseUJBQXlCLDZFQUFjO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0Msc0ZBQXlCO0FBQ2pFO0FBQ0Esb0NBQW9DLDRFQUFzQjtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNKQUFzSixvRUFBYztBQUNwSywwSUFBMEksb0VBQWM7QUFDeEo7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLDZFQUFlO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0I7QUFDdEI7QUFDQSw4QkFBOEIsNkVBQVk7QUFDMUM7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QywyRkFBbUI7QUFDakU7QUFDQTtBQUNBLDZCQUE2QjtBQUM3Qix5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixrRUFBUztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFJQUFxSSw2RUFBZTtBQUNwSjtBQUNBLDJHQUEyRyxpSEFBaUg7QUFDNU47QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsaUJBQWlCLDZFQUFjO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0Qix3RkFBMkI7QUFDdkQsa0JBQWtCLDZFQUFjO0FBQ2hDLCtCQUErQiw0RUFBc0I7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMsMEZBQXFCO0FBQ2xFO0FBQ0Esa0JBQWtCLDZFQUFZO0FBQzlCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLDZFQUE2RSxnRkFBYztBQUMzRixpQ0FBaUMsUUFBUSxFQUFFLFFBQVE7QUFDbkQsMEJBQTBCLHVFQUFRO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQywyRkFBbUI7QUFDckQ7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsNkVBQVk7QUFDMUI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBOztBQUVBIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0IHsgZ2V0UmVxdWVzdE1ldGEgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yZXF1ZXN0LW1ldGFcIjtcbmltcG9ydCB7IGdldFRyYWNlciwgU3BhbktpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvdHJhY2UvdHJhY2VyXCI7XG5pbXBvcnQgeyBub3JtYWxpemVBcHBQYXRoIH0gZnJvbSBcIm5leHQvZGlzdC9zaGFyZWQvbGliL3JvdXRlci91dGlscy9hcHAtcGF0aHNcIjtcbmltcG9ydCB7IE5vZGVOZXh0UmVxdWVzdCwgTm9kZU5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Jhc2UtaHR0cC9ub2RlXCI7XG5pbXBvcnQgeyBOZXh0UmVxdWVzdEFkYXB0ZXIsIHNpZ25hbEZyb21Ob2RlUmVzcG9uc2UgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci93ZWIvc3BlYy1leHRlbnNpb24vYWRhcHRlcnMvbmV4dC1yZXF1ZXN0XCI7XG5pbXBvcnQgeyBCYXNlU2VydmVyU3BhbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS9jb25zdGFudHNcIjtcbmltcG9ydCB7IGdldFJldmFsaWRhdGVSZWFzb24gfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9pbnN0cnVtZW50YXRpb24vdXRpbHNcIjtcbmltcG9ydCB7IHNlbmRSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3NlbmQtcmVzcG9uc2VcIjtcbmltcG9ydCB7IGZyb21Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycywgdG9Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycyB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3dlYi91dGlsc1wiO1xuaW1wb3J0IHsgZ2V0Q2FjaGVDb250cm9sSGVhZGVyIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL2NhY2hlLWNvbnRyb2xcIjtcbmltcG9ydCB7IElORklOSVRFX0NBQ0hFLCBORVhUX0NBQ0hFX1RBR1NfSEVBREVSIH0gZnJvbSBcIm5leHQvZGlzdC9saWIvY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBOb0ZhbGxiYWNrRXJyb3IgfSBmcm9tIFwibmV4dC9kaXN0L3NoYXJlZC9saWIvbm8tZmFsbGJhY2stZXJyb3IuZXh0ZXJuYWxcIjtcbmltcG9ydCB7IENhY2hlZFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3Jlc3BvbnNlLWNhY2hlXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL2hvbWUvZXJyb3I1MS9iaXRub2IvcHJvamVjdC92aWxsYWdlLXNhY2NvL3NyYy9hcHAvYXBpL2F1dGgvcmVnaXN0ZXIvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2F1dGgvcmVnaXN0ZXIvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9hdXRoL3JlZ2lzdGVyXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9hdXRoL3JlZ2lzdGVyL3JvdXRlXCJcbiAgICB9LFxuICAgIGRpc3REaXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9SRUxBVElWRV9ESVNUX0RJUiB8fCAnJyxcbiAgICBwcm9qZWN0RGlyOiBwcm9jZXNzLmVudi5fX05FWFRfUkVMQVRJVkVfUFJPSkVDVF9ESVIgfHwgJycsXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvaG9tZS9lcnJvcjUxL2JpdG5vYi9wcm9qZWN0L3ZpbGxhZ2Utc2FjY28vc3JjL2FwcC9hcGkvYXV0aC9yZWdpc3Rlci9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHdvcmtBc3luY1N0b3JhZ2UsXG4gICAgICAgIHdvcmtVbml0QXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBwYXRjaEZldGNoLCAgfTtcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzLCBjdHgpIHtcbiAgICB2YXIgX25leHRDb25maWdfZXhwZXJpbWVudGFsO1xuICAgIGxldCBzcmNQYWdlID0gXCIvYXBpL2F1dGgvcmVnaXN0ZXIvcm91dGVcIjtcbiAgICAvLyB0dXJib3BhY2sgZG9lc24ndCBub3JtYWxpemUgYC9pbmRleGAgaW4gdGhlIHBhZ2UgbmFtZVxuICAgIC8vIHNvIHdlIG5lZWQgdG8gdG8gcHJvY2VzcyBkeW5hbWljIHJvdXRlcyBwcm9wZXJseVxuICAgIC8vIFRPRE86IGZpeCB0dXJib3BhY2sgcHJvdmlkaW5nIGRpZmZlcmluZyB2YWx1ZSBmcm9tIHdlYnBhY2tcbiAgICBpZiAocHJvY2Vzcy5lbnYuVFVSQk9QQUNLKSB7XG4gICAgICAgIHNyY1BhZ2UgPSBzcmNQYWdlLnJlcGxhY2UoL1xcL2luZGV4JC8sICcnKSB8fCAnLyc7XG4gICAgfSBlbHNlIGlmIChzcmNQYWdlID09PSAnL2luZGV4Jykge1xuICAgICAgICAvLyB3ZSBhbHdheXMgbm9ybWFsaXplIC9pbmRleCBzcGVjaWZpY2FsbHlcbiAgICAgICAgc3JjUGFnZSA9ICcvJztcbiAgICB9XG4gICAgY29uc3QgbXVsdGlab25lRHJhZnRNb2RlID0gcHJvY2Vzcy5lbnYuX19ORVhUX01VTFRJX1pPTkVfRFJBRlRfTU9ERTtcbiAgICBjb25zdCBwcmVwYXJlUmVzdWx0ID0gYXdhaXQgcm91dGVNb2R1bGUucHJlcGFyZShyZXEsIHJlcywge1xuICAgICAgICBzcmNQYWdlLFxuICAgICAgICBtdWx0aVpvbmVEcmFmdE1vZGVcbiAgICB9KTtcbiAgICBpZiAoIXByZXBhcmVSZXN1bHQpIHtcbiAgICAgICAgcmVzLnN0YXR1c0NvZGUgPSA0MDA7XG4gICAgICAgIHJlcy5lbmQoJ0JhZCBSZXF1ZXN0Jyk7XG4gICAgICAgIGN0eC53YWl0VW50aWwgPT0gbnVsbCA/IHZvaWQgMCA6IGN0eC53YWl0VW50aWwuY2FsbChjdHgsIFByb21pc2UucmVzb2x2ZSgpKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IHsgYnVpbGRJZCwgcGFyYW1zLCBuZXh0Q29uZmlnLCBpc0RyYWZ0TW9kZSwgcHJlcmVuZGVyTWFuaWZlc3QsIHJvdXRlclNlcnZlckNvbnRleHQsIGlzT25EZW1hbmRSZXZhbGlkYXRlLCByZXZhbGlkYXRlT25seUdlbmVyYXRlZCwgcmVzb2x2ZWRQYXRobmFtZSB9ID0gcHJlcGFyZVJlc3VsdDtcbiAgICBjb25zdCBub3JtYWxpemVkU3JjUGFnZSA9IG5vcm1hbGl6ZUFwcFBhdGgoc3JjUGFnZSk7XG4gICAgbGV0IGlzSXNyID0gQm9vbGVhbihwcmVyZW5kZXJNYW5pZmVzdC5keW5hbWljUm91dGVzW25vcm1hbGl6ZWRTcmNQYWdlXSB8fCBwcmVyZW5kZXJNYW5pZmVzdC5yb3V0ZXNbcmVzb2x2ZWRQYXRobmFtZV0pO1xuICAgIGlmIChpc0lzciAmJiAhaXNEcmFmdE1vZGUpIHtcbiAgICAgICAgY29uc3QgaXNQcmVyZW5kZXJlZCA9IEJvb2xlYW4ocHJlcmVuZGVyTWFuaWZlc3Qucm91dGVzW3Jlc29sdmVkUGF0aG5hbWVdKTtcbiAgICAgICAgY29uc3QgcHJlcmVuZGVySW5mbyA9IHByZXJlbmRlck1hbmlmZXN0LmR5bmFtaWNSb3V0ZXNbbm9ybWFsaXplZFNyY1BhZ2VdO1xuICAgICAgICBpZiAocHJlcmVuZGVySW5mbykge1xuICAgICAgICAgICAgaWYgKHByZXJlbmRlckluZm8uZmFsbGJhY2sgPT09IGZhbHNlICYmICFpc1ByZXJlbmRlcmVkKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vRmFsbGJhY2tFcnJvcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGxldCBjYWNoZUtleSA9IG51bGw7XG4gICAgaWYgKGlzSXNyICYmICFyb3V0ZU1vZHVsZS5pc0RldiAmJiAhaXNEcmFmdE1vZGUpIHtcbiAgICAgICAgY2FjaGVLZXkgPSByZXNvbHZlZFBhdGhuYW1lO1xuICAgICAgICAvLyBlbnN1cmUgL2luZGV4IGFuZCAvIGlzIG5vcm1hbGl6ZWQgdG8gb25lIGtleVxuICAgICAgICBjYWNoZUtleSA9IGNhY2hlS2V5ID09PSAnL2luZGV4JyA/ICcvJyA6IGNhY2hlS2V5O1xuICAgIH1cbiAgICBjb25zdCBzdXBwb3J0c0R5bmFtaWNSZXNwb25zZSA9IC8vIElmIHdlJ3JlIGluIGRldmVsb3BtZW50LCB3ZSBhbHdheXMgc3VwcG9ydCBkeW5hbWljIEhUTUxcbiAgICByb3V0ZU1vZHVsZS5pc0RldiA9PT0gdHJ1ZSB8fCAvLyBJZiB0aGlzIGlzIG5vdCBTU0cgb3IgZG9lcyBub3QgaGF2ZSBzdGF0aWMgcGF0aHMsIHRoZW4gaXQgc3VwcG9ydHNcbiAgICAvLyBkeW5hbWljIEhUTUwuXG4gICAgIWlzSXNyO1xuICAgIC8vIFRoaXMgaXMgYSByZXZhbGlkYXRpb24gcmVxdWVzdCBpZiB0aGUgcmVxdWVzdCBpcyBmb3IgYSBzdGF0aWNcbiAgICAvLyBwYWdlIGFuZCBpdCBpcyBub3QgYmVpbmcgcmVzdW1lZCBmcm9tIGEgcG9zdHBvbmVkIHJlbmRlciBhbmRcbiAgICAvLyBpdCBpcyBub3QgYSBkeW5hbWljIFJTQyByZXF1ZXN0IHRoZW4gaXQgaXMgYSByZXZhbGlkYXRpb25cbiAgICAvLyByZXF1ZXN0LlxuICAgIGNvbnN0IGlzUmV2YWxpZGF0ZSA9IGlzSXNyICYmICFzdXBwb3J0c0R5bmFtaWNSZXNwb25zZTtcbiAgICBjb25zdCBtZXRob2QgPSByZXEubWV0aG9kIHx8ICdHRVQnO1xuICAgIGNvbnN0IHRyYWNlciA9IGdldFRyYWNlcigpO1xuICAgIGNvbnN0IGFjdGl2ZVNwYW4gPSB0cmFjZXIuZ2V0QWN0aXZlU2NvcGVTcGFuKCk7XG4gICAgY29uc3QgY29udGV4dCA9IHtcbiAgICAgICAgcGFyYW1zLFxuICAgICAgICBwcmVyZW5kZXJNYW5pZmVzdCxcbiAgICAgICAgcmVuZGVyT3B0czoge1xuICAgICAgICAgICAgZXhwZXJpbWVudGFsOiB7XG4gICAgICAgICAgICAgICAgZHluYW1pY0lPOiBCb29sZWFuKG5leHRDb25maWcuZXhwZXJpbWVudGFsLmR5bmFtaWNJTyksXG4gICAgICAgICAgICAgICAgYXV0aEludGVycnVwdHM6IEJvb2xlYW4obmV4dENvbmZpZy5leHBlcmltZW50YWwuYXV0aEludGVycnVwdHMpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc3VwcG9ydHNEeW5hbWljUmVzcG9uc2UsXG4gICAgICAgICAgICBpbmNyZW1lbnRhbENhY2hlOiBnZXRSZXF1ZXN0TWV0YShyZXEsICdpbmNyZW1lbnRhbENhY2hlJyksXG4gICAgICAgICAgICBjYWNoZUxpZmVQcm9maWxlczogKF9uZXh0Q29uZmlnX2V4cGVyaW1lbnRhbCA9IG5leHRDb25maWcuZXhwZXJpbWVudGFsKSA9PSBudWxsID8gdm9pZCAwIDogX25leHRDb25maWdfZXhwZXJpbWVudGFsLmNhY2hlTGlmZSxcbiAgICAgICAgICAgIGlzUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgIHdhaXRVbnRpbDogY3R4LndhaXRVbnRpbCxcbiAgICAgICAgICAgIG9uQ2xvc2U6IChjYik9PntcbiAgICAgICAgICAgICAgICByZXMub24oJ2Nsb3NlJywgY2IpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9uQWZ0ZXJUYXNrRXJyb3I6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIG9uSW5zdHJ1bWVudGF0aW9uUmVxdWVzdEVycm9yOiAoZXJyb3IsIF9yZXF1ZXN0LCBlcnJvckNvbnRleHQpPT5yb3V0ZU1vZHVsZS5vblJlcXVlc3RFcnJvcihyZXEsIGVycm9yLCBlcnJvckNvbnRleHQsIHJvdXRlclNlcnZlckNvbnRleHQpXG4gICAgICAgIH0sXG4gICAgICAgIHNoYXJlZENvbnRleHQ6IHtcbiAgICAgICAgICAgIGJ1aWxkSWRcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3Qgbm9kZU5leHRSZXEgPSBuZXcgTm9kZU5leHRSZXF1ZXN0KHJlcSk7XG4gICAgY29uc3Qgbm9kZU5leHRSZXMgPSBuZXcgTm9kZU5leHRSZXNwb25zZShyZXMpO1xuICAgIGNvbnN0IG5leHRSZXEgPSBOZXh0UmVxdWVzdEFkYXB0ZXIuZnJvbU5vZGVOZXh0UmVxdWVzdChub2RlTmV4dFJlcSwgc2lnbmFsRnJvbU5vZGVSZXNwb25zZShyZXMpKTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBpbnZva2VSb3V0ZU1vZHVsZSA9IGFzeW5jIChzcGFuKT0+e1xuICAgICAgICAgICAgcmV0dXJuIHJvdXRlTW9kdWxlLmhhbmRsZShuZXh0UmVxLCBjb250ZXh0KS5maW5hbGx5KCgpPT57XG4gICAgICAgICAgICAgICAgaWYgKCFzcGFuKSByZXR1cm47XG4gICAgICAgICAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgJ2h0dHAuc3RhdHVzX2NvZGUnOiByZXMuc3RhdHVzQ29kZSxcbiAgICAgICAgICAgICAgICAgICAgJ25leHQucnNjJzogZmFsc2VcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjb25zdCByb290U3BhbkF0dHJpYnV0ZXMgPSB0cmFjZXIuZ2V0Um9vdFNwYW5BdHRyaWJ1dGVzKCk7XG4gICAgICAgICAgICAgICAgLy8gV2Ugd2VyZSB1bmFibGUgdG8gZ2V0IGF0dHJpYnV0ZXMsIHByb2JhYmx5IE9URUwgaXMgbm90IGVuYWJsZWRcbiAgICAgICAgICAgICAgICBpZiAoIXJvb3RTcGFuQXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChyb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnNwYW5fdHlwZScpICE9PSBCYXNlU2VydmVyU3Bhbi5oYW5kbGVSZXF1ZXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgVW5leHBlY3RlZCByb290IHNwYW4gdHlwZSAnJHtyb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnNwYW5fdHlwZScpfScuIFBsZWFzZSByZXBvcnQgdGhpcyBOZXh0LmpzIGlzc3VlIGh0dHBzOi8vZ2l0aHViLmNvbS92ZXJjZWwvbmV4dC5qc2ApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHJvdXRlID0gcm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5yb3V0ZScpO1xuICAgICAgICAgICAgICAgIGlmIChyb3V0ZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gYCR7bWV0aG9kfSAke3JvdXRlfWA7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4uc2V0QXR0cmlidXRlcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAnbmV4dC5yb3V0ZSc6IHJvdXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAucm91dGUnOiByb3V0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICduZXh0LnNwYW5fbmFtZSc6IG5hbWVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4udXBkYXRlTmFtZShuYW1lKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnVwZGF0ZU5hbWUoYCR7bWV0aG9kfSAke3JlcS51cmx9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGhhbmRsZVJlc3BvbnNlID0gYXN5bmMgKGN1cnJlbnRTcGFuKT0+e1xuICAgICAgICAgICAgdmFyIF9jYWNoZUVudHJ5X3ZhbHVlO1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VHZW5lcmF0b3IgPSBhc3luYyAoeyBwcmV2aW91c0NhY2hlRW50cnkgfSk9PntcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWdldFJlcXVlc3RNZXRhKHJlcSwgJ21pbmltYWxNb2RlJykgJiYgaXNPbkRlbWFuZFJldmFsaWRhdGUgJiYgcmV2YWxpZGF0ZU9ubHlHZW5lcmF0ZWQgJiYgIXByZXZpb3VzQ2FjaGVFbnRyeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLnN0YXR1c0NvZGUgPSA0MDQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBvbi1kZW1hbmQgcmV2YWxpZGF0ZSBhbHdheXMgc2V0cyB0aGlzIGhlYWRlclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLnNldEhlYWRlcigneC1uZXh0anMtY2FjaGUnLCAnUkVWQUxJREFURUQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5lbmQoJ1RoaXMgcGFnZSBjb3VsZCBub3QgYmUgZm91bmQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgaW52b2tlUm91dGVNb2R1bGUoY3VycmVudFNwYW4pO1xuICAgICAgICAgICAgICAgICAgICByZXEuZmV0Y2hNZXRyaWNzID0gY29udGV4dC5yZW5kZXJPcHRzLmZldGNoTWV0cmljcztcbiAgICAgICAgICAgICAgICAgICAgbGV0IHBlbmRpbmdXYWl0VW50aWwgPSBjb250ZXh0LnJlbmRlck9wdHMucGVuZGluZ1dhaXRVbnRpbDtcbiAgICAgICAgICAgICAgICAgICAgLy8gQXR0ZW1wdCB1c2luZyBwcm92aWRlZCB3YWl0VW50aWwgaWYgYXZhaWxhYmxlXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIGl0J3Mgbm90IHdlIGZhbGxiYWNrIHRvIHNlbmRSZXNwb25zZSdzIGhhbmRsaW5nXG4gICAgICAgICAgICAgICAgICAgIGlmIChwZW5kaW5nV2FpdFVudGlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3R4LndhaXRVbnRpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC53YWl0VW50aWwocGVuZGluZ1dhaXRVbnRpbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVuZGluZ1dhaXRVbnRpbCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjYWNoZVRhZ3MgPSBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkVGFncztcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlIHJlcXVlc3QgaXMgZm9yIGEgc3RhdGljIHJlc3BvbnNlLCB3ZSBjYW4gY2FjaGUgaXQgc28gbG9uZ1xuICAgICAgICAgICAgICAgICAgICAvLyBhcyBpdCdzIG5vdCBlZGdlLlxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNJc3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCByZXNwb25zZS5ibG9iKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDb3B5IHRoZSBoZWFkZXJzIGZyb20gdGhlIHJlc3BvbnNlLlxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaGVhZGVycyA9IHRvTm9kZU91dGdvaW5nSHR0cEhlYWRlcnMocmVzcG9uc2UuaGVhZGVycyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2FjaGVUYWdzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1tORVhUX0NBQ0hFX1RBR1NfSEVBREVSXSA9IGNhY2hlVGFncztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaGVhZGVyc1snY29udGVudC10eXBlJ10gJiYgYmxvYi50eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1snY29udGVudC10eXBlJ10gPSBibG9iLnR5cGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXZhbGlkYXRlID0gdHlwZW9mIGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRSZXZhbGlkYXRlID09PSAndW5kZWZpbmVkJyB8fCBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkUmV2YWxpZGF0ZSA+PSBJTkZJTklURV9DQUNIRSA/IGZhbHNlIDogY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZFJldmFsaWRhdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBleHBpcmUgPSB0eXBlb2YgY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZEV4cGlyZSA9PT0gJ3VuZGVmaW5lZCcgfHwgY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZEV4cGlyZSA+PSBJTkZJTklURV9DQUNIRSA/IHVuZGVmaW5lZCA6IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRFeHBpcmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgdGhlIGNhY2hlIGVudHJ5IGZvciB0aGUgcmVzcG9uc2UuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYWNoZUVudHJ5ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtpbmQ6IENhY2hlZFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib2R5OiBCdWZmZXIuZnJvbShhd2FpdCBibG9iLmFycmF5QnVmZmVyKCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWNoZUNvbnRyb2w6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwaXJlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjYWNoZUVudHJ5O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VuZCByZXNwb25zZSB3aXRob3V0IGNhY2hpbmcgaWYgbm90IElTUlxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2VuZFJlc3BvbnNlKG5vZGVOZXh0UmVxLCBub2RlTmV4dFJlcywgcmVzcG9uc2UsIGNvbnRleHQucmVuZGVyT3B0cy5wZW5kaW5nV2FpdFVudGlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoaXMgaXMgYSBiYWNrZ3JvdW5kIHJldmFsaWRhdGUgd2UgbmVlZCB0byByZXBvcnRcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHJlcXVlc3QgZXJyb3IgaGVyZSBhcyBpdCB3b24ndCBiZSBidWJibGVkXG4gICAgICAgICAgICAgICAgICAgIGlmIChwcmV2aW91c0NhY2hlRW50cnkgPT0gbnVsbCA/IHZvaWQgMCA6IHByZXZpb3VzQ2FjaGVFbnRyeS5pc1N0YWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCByb3V0ZU1vZHVsZS5vblJlcXVlc3RFcnJvcihyZXEsIGVyciwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdXRlcktpbmQ6ICdBcHAgUm91dGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZVBhdGg6IHNyY1BhZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm91dGVUeXBlOiAncm91dGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldmFsaWRhdGVSZWFzb246IGdldFJldmFsaWRhdGVSZWFzb24oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1JldmFsaWRhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzT25EZW1hbmRSZXZhbGlkYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHJvdXRlclNlcnZlckNvbnRleHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY29uc3QgY2FjaGVFbnRyeSA9IGF3YWl0IHJvdXRlTW9kdWxlLmhhbmRsZVJlc3BvbnNlKHtcbiAgICAgICAgICAgICAgICByZXEsXG4gICAgICAgICAgICAgICAgbmV4dENvbmZpZyxcbiAgICAgICAgICAgICAgICBjYWNoZUtleSxcbiAgICAgICAgICAgICAgICByb3V0ZUtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgICAgICAgICAgaXNGYWxsYmFjazogZmFsc2UsXG4gICAgICAgICAgICAgICAgcHJlcmVuZGVyTWFuaWZlc3QsXG4gICAgICAgICAgICAgICAgaXNSb3V0ZVBQUkVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGlzT25EZW1hbmRSZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgIHJldmFsaWRhdGVPbmx5R2VuZXJhdGVkLFxuICAgICAgICAgICAgICAgIHJlc3BvbnNlR2VuZXJhdG9yLFxuICAgICAgICAgICAgICAgIHdhaXRVbnRpbDogY3R4LndhaXRVbnRpbFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyB3ZSBkb24ndCBjcmVhdGUgYSBjYWNoZUVudHJ5IGZvciBJU1JcbiAgICAgICAgICAgIGlmICghaXNJc3IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgoY2FjaGVFbnRyeSA9PSBudWxsID8gdm9pZCAwIDogKF9jYWNoZUVudHJ5X3ZhbHVlID0gY2FjaGVFbnRyeS52YWx1ZSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9jYWNoZUVudHJ5X3ZhbHVlLmtpbmQpICE9PSBDYWNoZWRSb3V0ZUtpbmQuQVBQX1JPVVRFKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9jYWNoZUVudHJ5X3ZhbHVlMTtcbiAgICAgICAgICAgICAgICB0aHJvdyBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3IEVycm9yKGBJbnZhcmlhbnQ6IGFwcC1yb3V0ZSByZWNlaXZlZCBpbnZhbGlkIGNhY2hlIGVudHJ5ICR7Y2FjaGVFbnRyeSA9PSBudWxsID8gdm9pZCAwIDogKF9jYWNoZUVudHJ5X3ZhbHVlMSA9IGNhY2hlRW50cnkudmFsdWUpID09IG51bGwgPyB2b2lkIDAgOiBfY2FjaGVFbnRyeV92YWx1ZTEua2luZH1gKSwgXCJfX05FWFRfRVJST1JfQ09ERVwiLCB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBcIkU3MDFcIixcbiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFnZXRSZXF1ZXN0TWV0YShyZXEsICdtaW5pbWFsTW9kZScpKSB7XG4gICAgICAgICAgICAgICAgcmVzLnNldEhlYWRlcigneC1uZXh0anMtY2FjaGUnLCBpc09uRGVtYW5kUmV2YWxpZGF0ZSA/ICdSRVZBTElEQVRFRCcgOiBjYWNoZUVudHJ5LmlzTWlzcyA/ICdNSVNTJyA6IGNhY2hlRW50cnkuaXNTdGFsZSA/ICdTVEFMRScgOiAnSElUJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBEcmFmdCBtb2RlIHNob3VsZCBuZXZlciBiZSBjYWNoZWRcbiAgICAgICAgICAgIGlmIChpc0RyYWZ0TW9kZSkge1xuICAgICAgICAgICAgICAgIHJlcy5zZXRIZWFkZXIoJ0NhY2hlLUNvbnRyb2wnLCAncHJpdmF0ZSwgbm8tY2FjaGUsIG5vLXN0b3JlLCBtYXgtYWdlPTAsIG11c3QtcmV2YWxpZGF0ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgaGVhZGVycyA9IGZyb21Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycyhjYWNoZUVudHJ5LnZhbHVlLmhlYWRlcnMpO1xuICAgICAgICAgICAgaWYgKCEoZ2V0UmVxdWVzdE1ldGEocmVxLCAnbWluaW1hbE1vZGUnKSAmJiBpc0lzcikpIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLmRlbGV0ZShORVhUX0NBQ0hFX1RBR1NfSEVBREVSKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIElmIGNhY2hlIGNvbnRyb2wgaXMgYWxyZWFkeSBzZXQgb24gdGhlIHJlc3BvbnNlIHdlIGRvbid0XG4gICAgICAgICAgICAvLyBvdmVycmlkZSBpdCB0byBhbGxvdyB1c2VycyB0byBjdXN0b21pemUgaXQgdmlhIG5leHQuY29uZmlnXG4gICAgICAgICAgICBpZiAoY2FjaGVFbnRyeS5jYWNoZUNvbnRyb2wgJiYgIXJlcy5nZXRIZWFkZXIoJ0NhY2hlLUNvbnRyb2wnKSAmJiAhaGVhZGVycy5nZXQoJ0NhY2hlLUNvbnRyb2wnKSkge1xuICAgICAgICAgICAgICAgIGhlYWRlcnMuc2V0KCdDYWNoZS1Db250cm9sJywgZ2V0Q2FjaGVDb250cm9sSGVhZGVyKGNhY2hlRW50cnkuY2FjaGVDb250cm9sKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhd2FpdCBzZW5kUmVzcG9uc2Uobm9kZU5leHRSZXEsIG5vZGVOZXh0UmVzLCBuZXcgUmVzcG9uc2UoY2FjaGVFbnRyeS52YWx1ZS5ib2R5LCB7XG4gICAgICAgICAgICAgICAgaGVhZGVycyxcbiAgICAgICAgICAgICAgICBzdGF0dXM6IGNhY2hlRW50cnkudmFsdWUuc3RhdHVzIHx8IDIwMFxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIC8vIFRPRE86IGFjdGl2ZVNwYW4gY29kZSBwYXRoIGlzIGZvciB3aGVuIHdyYXBwZWQgYnlcbiAgICAgICAgLy8gbmV4dC1zZXJ2ZXIgY2FuIGJlIHJlbW92ZWQgd2hlbiB0aGlzIGlzIG5vIGxvbmdlciB1c2VkXG4gICAgICAgIGlmIChhY3RpdmVTcGFuKSB7XG4gICAgICAgICAgICBhd2FpdCBoYW5kbGVSZXNwb25zZShhY3RpdmVTcGFuKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGF3YWl0IHRyYWNlci53aXRoUHJvcGFnYXRlZENvbnRleHQocmVxLmhlYWRlcnMsICgpPT50cmFjZXIudHJhY2UoQmFzZVNlcnZlclNwYW4uaGFuZGxlUmVxdWVzdCwge1xuICAgICAgICAgICAgICAgICAgICBzcGFuTmFtZTogYCR7bWV0aG9kfSAke3JlcS51cmx9YCxcbiAgICAgICAgICAgICAgICAgICAga2luZDogU3BhbktpbmQuU0VSVkVSLFxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC5tZXRob2QnOiBtZXRob2QsXG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC50YXJnZXQnOiByZXEudXJsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCBoYW5kbGVSZXNwb25zZSkpO1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIC8vIGlmIHdlIGFyZW4ndCB3cmFwcGVkIGJ5IGJhc2Utc2VydmVyIGhhbmRsZSBoZXJlXG4gICAgICAgIGlmICghYWN0aXZlU3Bhbikge1xuICAgICAgICAgICAgYXdhaXQgcm91dGVNb2R1bGUub25SZXF1ZXN0RXJyb3IocmVxLCBlcnIsIHtcbiAgICAgICAgICAgICAgICByb3V0ZXJLaW5kOiAnQXBwIFJvdXRlcicsXG4gICAgICAgICAgICAgICAgcm91dGVQYXRoOiBub3JtYWxpemVkU3JjUGFnZSxcbiAgICAgICAgICAgICAgICByb3V0ZVR5cGU6ICdyb3V0ZScsXG4gICAgICAgICAgICAgICAgcmV2YWxpZGF0ZVJlYXNvbjogZ2V0UmV2YWxpZGF0ZVJlYXNvbih7XG4gICAgICAgICAgICAgICAgICAgIGlzUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gcmV0aHJvdyBzbyB0aGF0IHdlIGNhbiBoYW5kbGUgc2VydmluZyBlcnJvciBwYWdlXG4gICAgICAgIC8vIElmIHRoaXMgaXMgZHVyaW5nIHN0YXRpYyBnZW5lcmF0aW9uLCB0aHJvdyB0aGUgZXJyb3IgYWdhaW4uXG4gICAgICAgIGlmIChpc0lzcikgdGhyb3cgZXJyO1xuICAgICAgICAvLyBPdGhlcndpc2UsIHNlbmQgYSA1MDAgcmVzcG9uc2UuXG4gICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIG5ldyBSZXNwb25zZShudWxsLCB7XG4gICAgICAgICAgICBzdGF0dXM6IDUwMFxuICAgICAgICB9KSk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2Fregister%2Froute&page=%2Fapi%2Fauth%2Fregister%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fregister%2Froute.ts&appDir=%2Fhome%2Ferror51%2Fbitnob%2Fproject%2Fvillage-sacco%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Ferror51%2Fbitnob%2Fproject%2Fvillage-sacco&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/auth/register/route.ts":
/*!********************************************!*\
  !*** ./src/app/api/auth/register/route.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_supabase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../lib/supabase */ \"(rsc)/./src/lib/supabase.ts\");\n/* harmony import */ var _services_bitnob_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../services/bitnob.service */ \"(rsc)/./src/services/bitnob.service.ts\");\n\n\n\nasync function POST(request) {\n    try {\n        const { name, email, phone, password } = await request.json();\n        // Basic validation\n        if (!name || !email || !phone || !password) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                message: 'All fields are required'\n            }, {\n                status: 400\n            });\n        }\n        if (password.length < 6) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                message: 'Password must be at least 6 characters long'\n            }, {\n                status: 400\n            });\n        }\n        const supabase = (0,_lib_supabase__WEBPACK_IMPORTED_MODULE_1__.createServerSupabaseClient)();\n        const [firstName, ...lastNameParts] = name.split(' ');\n        const lastName = lastNameParts.join(' ') || '';\n        // Create user in Supabase Auth\n        const { data: authData, error: authError } = await supabase.auth.admin.createUser({\n            email,\n            password,\n            email_confirm: true\n        });\n        if (authError) {\n            console.error('Supabase auth error:', authError);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                message: 'Failed to create user account: ' + authError.message\n            }, {\n                status: 400\n            });\n        }\n        if (!authData.user) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                message: 'User creation failed - no user data returned'\n            }, {\n                status: 400\n            });\n        }\n        try {\n            // First, create user profile in database with server client (has admin privileges)\n            const { data: user, error: userError } = await supabase.from('users').insert({\n                id: authData.user.id,\n                email,\n                first_name: firstName,\n                last_name: lastName,\n                phone,\n                kyc_status: 'not_started',\n                is_active: true\n            }).select().single();\n            if (userError) {\n                console.error('User profile creation error:', userError);\n                // Clean up auth user if profile creation fails\n                await supabase.auth.admin.deleteUser(authData.user.id);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    message: 'Failed to create user profile: ' + userError.message\n                }, {\n                    status: 400\n                });\n            }\n            // Try to create Bitcoin wallet with Bitnob (optional)\n            let bitnobWalletId = null;\n            try {\n                const bitnobWallet = await _services_bitnob_service__WEBPACK_IMPORTED_MODULE_2__.bitnobService.createWallet({\n                    email: email,\n                    firstName,\n                    lastName,\n                    phoneNumber: phone\n                });\n                bitnobWalletId = bitnobWallet.id;\n                // Update user with wallet ID\n                await supabase.from('users').update({\n                    bitnob_wallet_id: bitnobWalletId\n                }).eq('id', authData.user.id);\n            } catch (bitnobError) {\n                console.warn('Bitnob wallet creation failed (non-critical):', bitnobError);\n            // Don't fail registration if wallet creation fails\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                message: bitnobWalletId ? 'Registration successful with Bitcoin wallet' : 'Registration successful (Bitcoin wallet will be created later)',\n                user: {\n                    id: user.id,\n                    email: user.email,\n                    name: `${user.first_name} ${user.last_name}`,\n                    phone: user.phone,\n                    role: 'member',\n                    bitnobWalletId: bitnobWalletId,\n                    kycStatus: user.kyc_status,\n                    created_at: user.created_at\n                }\n            }, {\n                status: 201\n            });\n        } catch (registrationError) {\n            console.error('Registration error:', registrationError);\n            // Clean up auth user if anything fails\n            await supabase.auth.admin.deleteUser(authData.user.id);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                message: 'Registration failed: ' + (registrationError instanceof Error ? registrationError.message : 'Unknown error')\n            }, {\n                status: 400\n            });\n        }\n    } catch (error) {\n        console.error('Registration error:', error);\n        // Handle specific network timeout errors\n        if (error instanceof TypeError && error.message === 'fetch failed') {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                message: 'Network connection timeout. Please check your internet connection and try again.'\n            }, {\n                status: 503\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            message: 'Internal server error'\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9hdXRoL3JlZ2lzdGVyL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBd0Q7QUFDYztBQUVGO0FBRTdELGVBQWVHLEtBQUtDLE9BQW9CO0lBQzdDLElBQUk7UUFDRixNQUFNLEVBQUVDLElBQUksRUFBRUMsS0FBSyxFQUFFQyxLQUFLLEVBQUVDLFFBQVEsRUFBRSxHQUFHLE1BQU1KLFFBQVFLLElBQUk7UUFFM0QsbUJBQW1CO1FBQ25CLElBQUksQ0FBQ0osUUFBUSxDQUFDQyxTQUFTLENBQUNDLFNBQVMsQ0FBQ0MsVUFBVTtZQUMxQyxPQUFPUixxREFBWUEsQ0FBQ1MsSUFBSSxDQUN0QjtnQkFBRUMsU0FBUztZQUEwQixHQUNyQztnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsSUFBSUgsU0FBU0ksTUFBTSxHQUFHLEdBQUc7WUFDdkIsT0FBT1oscURBQVlBLENBQUNTLElBQUksQ0FDdEI7Z0JBQUVDLFNBQVM7WUFBOEMsR0FDekQ7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLE1BQU1FLFdBQVdaLHlFQUEwQkE7UUFDM0MsTUFBTSxDQUFDYSxXQUFXLEdBQUdDLGNBQWMsR0FBR1YsS0FBS1csS0FBSyxDQUFDO1FBQ2pELE1BQU1DLFdBQVdGLGNBQWNHLElBQUksQ0FBQyxRQUFRO1FBRTVDLCtCQUErQjtRQUMvQixNQUFNLEVBQUVDLE1BQU1DLFFBQVEsRUFBRUMsT0FBT0MsU0FBUyxFQUFFLEdBQUcsTUFBTVQsU0FBU1UsSUFBSSxDQUFDQyxLQUFLLENBQUNDLFVBQVUsQ0FBQztZQUNoRm5CO1lBQ0FFO1lBQ0FrQixlQUFlO1FBQ2pCO1FBRUEsSUFBSUosV0FBVztZQUNiSyxRQUFRTixLQUFLLENBQUMsd0JBQXdCQztZQUN0QyxPQUFPdEIscURBQVlBLENBQUNTLElBQUksQ0FDdEI7Z0JBQUVDLFNBQVMsb0NBQW9DWSxVQUFVWixPQUFPO1lBQUMsR0FDakU7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLElB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bEI7UUFFQSxPQUFPWCxxREFBWUEsQ0FBQ1MsSUFBSSxDQUN0QjtZQUFFQyxTQUFTO1FBQXdCLEdBQ25DO1lBQUVDLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyIvaG9tZS9lcnJvcjUxL2JpdG5vYi9wcm9qZWN0L3ZpbGxhZ2Utc2FjY28vc3JjL2FwcC9hcGkvYXV0aC9yZWdpc3Rlci9yb3V0ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHsgY3JlYXRlU2VydmVyU3VwYWJhc2VDbGllbnQgfSBmcm9tICcuLi8uLi8uLi8uLi9saWIvc3VwYWJhc2UnO1xuaW1wb3J0IHsgVXNlclNlcnZpY2UgfSBmcm9tICcuLi8uLi8uLi8uLi9zZXJ2aWNlcy91c2VyLnNlcnZpY2UnO1xuaW1wb3J0IHsgYml0bm9iU2VydmljZSB9IGZyb20gJy4uLy4uLy4uLy4uL3NlcnZpY2VzL2JpdG5vYi5zZXJ2aWNlJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IG5hbWUsIGVtYWlsLCBwaG9uZSwgcGFzc3dvcmQgfSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuXG4gICAgLy8gQmFzaWMgdmFsaWRhdGlvblxuICAgIGlmICghbmFtZSB8fCAhZW1haWwgfHwgIXBob25lIHx8ICFwYXNzd29yZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IG1lc3NhZ2U6ICdBbGwgZmllbGRzIGFyZSByZXF1aXJlZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChwYXNzd29yZC5sZW5ndGggPCA2KSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgbWVzc2FnZTogJ1Bhc3N3b3JkIG11c3QgYmUgYXQgbGVhc3QgNiBjaGFyYWN0ZXJzIGxvbmcnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZVNlcnZlclN1cGFiYXNlQ2xpZW50KCk7XG4gICAgY29uc3QgW2ZpcnN0TmFtZSwgLi4ubGFzdE5hbWVQYXJ0c10gPSBuYW1lLnNwbGl0KCcgJyk7XG4gICAgY29uc3QgbGFzdE5hbWUgPSBsYXN0TmFtZVBhcnRzLmpvaW4oJyAnKSB8fCAnJztcblxuICAgIC8vIENyZWF0ZSB1c2VyIGluIFN1cGFiYXNlIEF1dGhcbiAgICBjb25zdCB7IGRhdGE6IGF1dGhEYXRhLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmFkbWluLmNyZWF0ZVVzZXIoe1xuICAgICAgZW1haWwsXG4gICAgICBwYXNzd29yZCxcbiAgICAgIGVtYWlsX2NvbmZpcm06IHRydWUsXG4gICAgfSk7XG5cbiAgICBpZiAoYXV0aEVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdTdXBhYmFzZSBhdXRoIGVycm9yOicsIGF1dGhFcnJvcik7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgbWVzc2FnZTogJ0ZhaWxlZCB0byBjcmVhdGUgdXNlciBhY2NvdW50OiAnICsgYXV0aEVycm9yLm1lc3NhZ2UgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGlmICghYXV0aERhdGEudXNlcikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IG1lc3NhZ2U6ICdVc2VyIGNyZWF0aW9uIGZhaWxlZCAtIG5vIHVzZXIgZGF0YSByZXR1cm5lZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAvLyBGaXJzdCwgY3JlYXRlIHVzZXIgcHJvZmlsZSBpbiBkYXRhYmFzZSB3aXRoIHNlcnZlciBjbGllbnQgKGhhcyBhZG1pbiBwcml2aWxlZ2VzKVxuICAgICAgY29uc3QgeyBkYXRhOiB1c2VyLCBlcnJvcjogdXNlckVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgndXNlcnMnKVxuICAgICAgICAuaW5zZXJ0KHtcbiAgICAgICAgICBpZDogYXV0aERhdGEudXNlci5pZCxcbiAgICAgICAgICBlbWFpbCxcbiAgICAgICAgICBmaXJzdF9uYW1lOiBmaXJzdE5hbWUsXG4gICAgICAgICAgbGFzdF9uYW1lOiBsYXN0TmFtZSxcbiAgICAgICAgICBwaG9uZSxcbiAgICAgICAgICBreWNfc3RhdHVzOiAnbm90X3N0YXJ0ZWQnLFxuICAgICAgICAgIGlzX2FjdGl2ZTogdHJ1ZSxcbiAgICAgICAgfSlcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5zaW5nbGUoKTtcblxuICAgICAgaWYgKHVzZXJFcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdVc2VyIHByb2ZpbGUgY3JlYXRpb24gZXJyb3I6JywgdXNlckVycm9yKTtcbiAgICAgICAgLy8gQ2xlYW4gdXAgYXV0aCB1c2VyIGlmIHByb2ZpbGUgY3JlYXRpb24gZmFpbHNcbiAgICAgICAgYXdhaXQgc3VwYWJhc2UuYXV0aC5hZG1pbi5kZWxldGVVc2VyKGF1dGhEYXRhLnVzZXIuaWQpO1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgeyBtZXNzYWdlOiAnRmFpbGVkIHRvIGNyZWF0ZSB1c2VyIHByb2ZpbGU6ICcgKyB1c2VyRXJyb3IubWVzc2FnZSB9LFxuICAgICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICAvLyBUcnkgdG8gY3JlYXRlIEJpdGNvaW4gd2FsbGV0IHdpdGggQml0bm9iIChvcHRpb25hbClcbiAgICAgIGxldCBiaXRub2JXYWxsZXRJZCA9IG51bGw7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBiaXRub2JXYWxsZXQgPSBhd2FpdCBiaXRub2JTZXJ2aWNlLmNyZWF0ZVdhbGxldCh7XG4gICAgICAgICAgZW1haWw6IGVtYWlsLFxuICAgICAgICAgIGZpcnN0TmFtZSxcbiAgICAgICAgICBsYXN0TmFtZSxcbiAgICAgICAgICBwaG9uZU51bWJlcjogcGhvbmUsXG4gICAgICAgIH0pO1xuICAgICAgICBiaXRub2JXYWxsZXRJZCA9IGJpdG5vYldhbGxldC5pZDtcblxuICAgICAgICAvLyBVcGRhdGUgdXNlciB3aXRoIHdhbGxldCBJRFxuICAgICAgICBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgIC5mcm9tKCd1c2VycycpXG4gICAgICAgICAgLnVwZGF0ZSh7IGJpdG5vYl93YWxsZXRfaWQ6IGJpdG5vYldhbGxldElkIH0pXG4gICAgICAgICAgLmVxKCdpZCcsIGF1dGhEYXRhLnVzZXIuaWQpO1xuICAgICAgfSBjYXRjaCAoYml0bm9iRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdCaXRub2Igd2FsbGV0IGNyZWF0aW9uIGZhaWxlZCAobm9uLWNyaXRpY2FsKTonLCBiaXRub2JFcnJvcik7XG4gICAgICAgIC8vIERvbid0IGZhaWwgcmVnaXN0cmF0aW9uIGlmIHdhbGxldCBjcmVhdGlvbiBmYWlsc1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBtZXNzYWdlOiBiaXRub2JXYWxsZXRJZCBcbiAgICAgICAgICA/ICdSZWdpc3RyYXRpb24gc3VjY2Vzc2Z1bCB3aXRoIEJpdGNvaW4gd2FsbGV0J1xuICAgICAgICAgIDogJ1JlZ2lzdHJhdGlvbiBzdWNjZXNzZnVsIChCaXRjb2luIHdhbGxldCB3aWxsIGJlIGNyZWF0ZWQgbGF0ZXIpJyxcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiB1c2VyLmlkLFxuICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgIG5hbWU6IGAke3VzZXIuZmlyc3RfbmFtZX0gJHt1c2VyLmxhc3RfbmFtZX1gLFxuICAgICAgICAgIHBob25lOiB1c2VyLnBob25lLFxuICAgICAgICAgIHJvbGU6ICdtZW1iZXInLFxuICAgICAgICAgIGJpdG5vYldhbGxldElkOiBiaXRub2JXYWxsZXRJZCxcbiAgICAgICAgICBreWNTdGF0dXM6IHVzZXIua3ljX3N0YXR1cyxcbiAgICAgICAgICBjcmVhdGVkX2F0OiB1c2VyLmNyZWF0ZWRfYXQsXG4gICAgICAgIH0sXG4gICAgICB9LCB7IHN0YXR1czogMjAxIH0pO1xuXG4gICAgfSBjYXRjaCAocmVnaXN0cmF0aW9uRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1JlZ2lzdHJhdGlvbiBlcnJvcjonLCByZWdpc3RyYXRpb25FcnJvcik7XG4gICAgICAvLyBDbGVhbiB1cCBhdXRoIHVzZXIgaWYgYW55dGhpbmcgZmFpbHNcbiAgICAgIGF3YWl0IHN1cGFiYXNlLmF1dGguYWRtaW4uZGVsZXRlVXNlcihhdXRoRGF0YS51c2VyLmlkKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBtZXNzYWdlOiAnUmVnaXN0cmF0aW9uIGZhaWxlZDogJyArIChyZWdpc3RyYXRpb25FcnJvciBpbnN0YW5jZW9mIEVycm9yID8gcmVnaXN0cmF0aW9uRXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJykgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApO1xuICAgIH1cblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1JlZ2lzdHJhdGlvbiBlcnJvcjonLCBlcnJvcik7XG4gICAgXG4gICAgLy8gSGFuZGxlIHNwZWNpZmljIG5ldHdvcmsgdGltZW91dCBlcnJvcnNcbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBUeXBlRXJyb3IgJiYgZXJyb3IubWVzc2FnZSA9PT0gJ2ZldGNoIGZhaWxlZCcpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBtZXNzYWdlOiAnTmV0d29yayBjb25uZWN0aW9uIHRpbWVvdXQuIFBsZWFzZSBjaGVjayB5b3VyIGludGVybmV0IGNvbm5lY3Rpb24gYW5kIHRyeSBhZ2Fpbi4nIH0sXG4gICAgICAgIHsgc3RhdHVzOiA1MDMgfVxuICAgICAgKTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBtZXNzYWdlOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImNyZWF0ZVNlcnZlclN1cGFiYXNlQ2xpZW50IiwiYml0bm9iU2VydmljZSIsIlBPU1QiLCJyZXF1ZXN0IiwibmFtZSIsImVtYWlsIiwicGhvbmUiLCJwYXNzd29yZCIsImpzb24iLCJtZXNzYWdlIiwic3RhdHVzIiwibGVuZ3RoIiwic3VwYWJhc2UiLCJmaXJzdE5hbWUiLCJsYXN0TmFtZVBhcnRzIiwic3BsaXQiLCJsYXN0TmFtZSIsImpvaW4iLCJkYXRhIiwiYXV0aERhdGEiLCJlcnJvciIsImF1dGhFcnJvciIsImF1dGgiLCJhZG1pbiIsImNyZWF0ZVVzZXIiLCJlbWFpbF9jb25maXJtIiwiY29uc29sZSIsInVzZXIiLCJ1c2VyRXJyb3IiLCJmcm9tIiwiaW5zZXJ0IiwiaWQiLCJmaXJzdF9uYW1lIiwibGFzdF9uYW1lIiwia3ljX3N0YXR1cyIsImlzX2FjdGl2ZSIsInNlbGVjdCIsInNpbmdsZSIsImRlbGV0ZVVzZXIiLCJiaXRub2JXYWxsZXRJZCIsImJpdG5vYldhbGxldCIsImNyZWF0ZVdhbGxldCIsInBob25lTnVtYmVyIiwidXBkYXRlIiwiYml0bm9iX3dhbGxldF9pZCIsImVxIiwiYml0bm9iRXJyb3IiLCJ3YXJuIiwic3VjY2VzcyIsInJvbGUiLCJreWNTdGF0dXMiLCJjcmVhdGVkX2F0IiwicmVnaXN0cmF0aW9uRXJyb3IiLCJFcnJvciIsIlR5cGVFcnJvciJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/auth/register/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/supabase.ts":
/*!*****************************!*\
  !*** ./src/lib/supabase.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createRealtimeSubscription: () => (/* binding */ createRealtimeSubscription),\n/* harmony export */   createServerSupabaseClient: () => (/* binding */ createServerSupabaseClient),\n/* harmony export */   handleSupabaseError: () => (/* binding */ handleSupabaseError),\n/* harmony export */   supabase: () => (/* binding */ supabase)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\nconst supabaseUrl = \"https://zvelgxclmqgohntjimyf.supabase.co\";\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp2ZWxneGNsbXFnb2hudGppbXlmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkyOTkzMDUsImV4cCI6MjA2NDg3NTMwNX0.CFdW-XH8y7hkOm7LUtqQxs36hPTRBYtha4EIeRhIXto\";\nif (!supabaseUrl || !supabaseAnonKey) {\n    throw new Error('Missing Supabase environment variables');\n}\n// Client-side Supabase client\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseAnonKey, {\n    auth: {\n        autoRefreshToken: true,\n        persistSession: true,\n        detectSessionInUrl: true\n    },\n    global: {\n        fetch: (url, options = {})=>{\n            return fetch(url, {\n                ...options,\n                // Increase timeout to 30 seconds\n                signal: AbortSignal.timeout(30000)\n            });\n        }\n    },\n    db: {\n        schema: 'public'\n    },\n    realtime: {\n        params: {\n            eventsPerSecond: 10\n        }\n    }\n});\n// Server-side Supabase client (for API routes)\nconst createServerSupabaseClient = ()=>{\n    const serviceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n    if (!serviceRoleKey) {\n        throw new Error('Missing SUPABASE_SERVICE_ROLE_KEY environment variable');\n    }\n    return (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, serviceRoleKey, {\n        auth: {\n            autoRefreshToken: false,\n            persistSession: false\n        }\n    });\n};\n// Helper function to handle Supabase errors\nconst handleSupabaseError = (error)=>{\n    console.error('Supabase error:', error);\n    if (error?.code === 'PGRST116') {\n        return 'No data found';\n    }\n    if (error?.code === '23505') {\n        return 'Record already exists';\n    }\n    if (error?.code === '23503') {\n        return 'Referenced record not found';\n    }\n    return error?.message || 'An unexpected error occurred';\n};\n// Real-time subscription helper\nconst createRealtimeSubscription = (table, filter, callback)=>{\n    return supabase.channel(`realtime-${table}`).on('postgres_changes', {\n        event: '*',\n        schema: 'public',\n        table,\n        filter\n    }, callback || ((payload)=>console.log('Realtime update:', payload))).subscribe();\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3N1cGFiYXNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQXFEO0FBR3JELE1BQU1DLGNBQWNDLDBDQUFvQztBQUN4RCxNQUFNRyxrQkFBa0JILGtOQUF5QztBQUVqRSxJQUFJLENBQUNELGVBQWUsQ0FBQ0ksaUJBQWlCO0lBQ3BDLE1BQU0sSUFBSUUsTUFBTTtBQUNsQjtBQUVBLDhCQUE4QjtBQUN2QixNQUFNQyxXQUFXUixtRUFBWUEsQ0FBV0MsYUFBYUksaUJBQWlCO0lBQzNFSSxNQUFNO1FBQ0pDLGtCQUFrQjtRQUNsQkMsZ0JBQWdCO1FBQ2hCQyxvQkFBb0I7SUFDdEI7SUFDQUMsUUFBUTtRQUNOQyxPQUFPLENBQUNDLEtBQUtDLFVBQVUsQ0FBQyxDQUFDO1lBQ3ZCLE9BQU9GLE1BQU1DLEtBQUs7Z0JBQ2hCLEdBQUdDLE9BQU87Z0JBQ1YsaUNBQWlDO2dCQUNqQ0MsUUFBUUMsWUFBWUMsT0FBTyxDQUFDO1lBQzlCO1FBQ0Y7SUFDRjtJQUNBQyxJQUFJO1FBQ0ZDLFFBQVE7SUFDVjtJQUNBQyxVQUFVO1FBQ1JDLFFBQVE7WUFDTkMsaUJBQWlCO1FBQ25CO0lBQ0Y7QUFDRixHQUFHO0FBRUgsK0NBQStDO0FBQ3hDLE1BQU1DLDZCQUE2QjtJQUN4QyxNQUFNQyxpQkFBaUJ4QixRQUFRQyxHQUFHLENBQUN3Qix5QkFBeUI7SUFFNUQsSUFBSSxDQUFDRCxnQkFBZ0I7UUFDbkIsTUFBTSxJQUFJbkIsTUFBTTtJQUNsQjtJQUVBLE9BQU9QLG1FQUFZQSxDQUFXQyxhQUFheUIsZ0JBQWdCO1FBQ3pEakIsTUFBTTtZQUNKQyxrQkFBa0I7WUFDbEJDLGdCQUFnQjtRQUNsQjtJQUNGO0FBQ0YsRUFBRTtBQUVGLDRDQUE0QztBQUNyQyxNQUFNaUIsc0JBQXNCLENBQUNDO0lBQ2xDQyxRQUFRRCxLQUFLLENBQUMsbUJBQW1CQTtJQUVqQyxJQUFJQSxPQUFPRSxTQUFTLFlBQVk7UUFDOUIsT0FBTztJQUNUO0lBRUEsSUFBSUYsT0FBT0UsU0FBUyxTQUFTO1FBQzNCLE9BQU87SUFDVDtJQUVBLElBQUlGLE9BQU9FLFNBQVMsU0FBUztRQUMzQixPQUFPO0lBQ1Q7SUFFQSxPQUFPRixPQUFPRyxXQUFXO0FBQzNCLEVBQUU7QUFFRixnQ0FBZ0M7QUFDekIsTUFBTUMsNkJBQTZCLENBQ3hDQyxPQUNBQyxRQUNBQztJQUVBLE9BQU81QixTQUNKNkIsT0FBTyxDQUFDLENBQUMsU0FBUyxFQUFFSCxPQUFPLEVBQzNCSSxFQUFFLENBQ0Qsb0JBQ0E7UUFDRUMsT0FBTztRQUNQbEIsUUFBUTtRQUNSYTtRQUNBQztJQUNGLEdBQ0FDLFlBQWEsRUFBQ0ksVUFBWVYsUUFBUVcsR0FBRyxDQUFDLG9CQUFvQkQsUUFBTyxHQUVsRUUsU0FBUztBQUNkLEVBQUUiLCJzb3VyY2VzIjpbIi9ob21lL2Vycm9yNTEvYml0bm9iL3Byb2plY3QvdmlsbGFnZS1zYWNjby9zcmMvbGliL3N1cGFiYXNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcyc7XG5pbXBvcnQgeyBEYXRhYmFzZSB9IGZyb20gJy4uL3R5cGVzJztcblxuY29uc3Qgc3VwYWJhc2VVcmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwhO1xuY29uc3Qgc3VwYWJhc2VBbm9uS2V5ID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkhO1xuXG5pZiAoIXN1cGFiYXNlVXJsIHx8ICFzdXBhYmFzZUFub25LZXkpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIFN1cGFiYXNlIGVudmlyb25tZW50IHZhcmlhYmxlcycpO1xufVxuXG4vLyBDbGllbnQtc2lkZSBTdXBhYmFzZSBjbGllbnRcbmV4cG9ydCBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZUNsaWVudDxEYXRhYmFzZT4oc3VwYWJhc2VVcmwsIHN1cGFiYXNlQW5vbktleSwge1xuICBhdXRoOiB7XG4gICAgYXV0b1JlZnJlc2hUb2tlbjogdHJ1ZSxcbiAgICBwZXJzaXN0U2Vzc2lvbjogdHJ1ZSxcbiAgICBkZXRlY3RTZXNzaW9uSW5Vcmw6IHRydWUsXG4gIH0sXG4gIGdsb2JhbDoge1xuICAgIGZldGNoOiAodXJsLCBvcHRpb25zID0ge30pID0+IHtcbiAgICAgIHJldHVybiBmZXRjaCh1cmwsIHtcbiAgICAgICAgLi4ub3B0aW9ucyxcbiAgICAgICAgLy8gSW5jcmVhc2UgdGltZW91dCB0byAzMCBzZWNvbmRzXG4gICAgICAgIHNpZ25hbDogQWJvcnRTaWduYWwudGltZW91dCgzMDAwMCksXG4gICAgICB9KTtcbiAgICB9LFxuICB9LFxuICBkYjoge1xuICAgIHNjaGVtYTogJ3B1YmxpYycsXG4gIH0sXG4gIHJlYWx0aW1lOiB7XG4gICAgcGFyYW1zOiB7XG4gICAgICBldmVudHNQZXJTZWNvbmQ6IDEwLFxuICAgIH0sXG4gIH0sXG59KTtcblxuLy8gU2VydmVyLXNpZGUgU3VwYWJhc2UgY2xpZW50IChmb3IgQVBJIHJvdXRlcylcbmV4cG9ydCBjb25zdCBjcmVhdGVTZXJ2ZXJTdXBhYmFzZUNsaWVudCA9ICgpID0+IHtcbiAgY29uc3Qgc2VydmljZVJvbGVLZXkgPSBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZO1xuICBcbiAgaWYgKCFzZXJ2aWNlUm9sZUtleSkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIGVudmlyb25tZW50IHZhcmlhYmxlJyk7XG4gIH1cblxuICByZXR1cm4gY3JlYXRlQ2xpZW50PERhdGFiYXNlPihzdXBhYmFzZVVybCwgc2VydmljZVJvbGVLZXksIHtcbiAgICBhdXRoOiB7XG4gICAgICBhdXRvUmVmcmVzaFRva2VuOiBmYWxzZSxcbiAgICAgIHBlcnNpc3RTZXNzaW9uOiBmYWxzZSxcbiAgICB9LFxuICB9KTtcbn07XG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byBoYW5kbGUgU3VwYWJhc2UgZXJyb3JzXG5leHBvcnQgY29uc3QgaGFuZGxlU3VwYWJhc2VFcnJvciA9IChlcnJvcjogYW55KSA9PiB7XG4gIGNvbnNvbGUuZXJyb3IoJ1N1cGFiYXNlIGVycm9yOicsIGVycm9yKTtcbiAgXG4gIGlmIChlcnJvcj8uY29kZSA9PT0gJ1BHUlNUMTE2Jykge1xuICAgIHJldHVybiAnTm8gZGF0YSBmb3VuZCc7XG4gIH1cbiAgXG4gIGlmIChlcnJvcj8uY29kZSA9PT0gJzIzNTA1Jykge1xuICAgIHJldHVybiAnUmVjb3JkIGFscmVhZHkgZXhpc3RzJztcbiAgfVxuICBcbiAgaWYgKGVycm9yPy5jb2RlID09PSAnMjM1MDMnKSB7XG4gICAgcmV0dXJuICdSZWZlcmVuY2VkIHJlY29yZCBub3QgZm91bmQnO1xuICB9XG4gIFxuICByZXR1cm4gZXJyb3I/Lm1lc3NhZ2UgfHwgJ0FuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWQnO1xufTtcblxuLy8gUmVhbC10aW1lIHN1YnNjcmlwdGlvbiBoZWxwZXJcbmV4cG9ydCBjb25zdCBjcmVhdGVSZWFsdGltZVN1YnNjcmlwdGlvbiA9IChcbiAgdGFibGU6IHN0cmluZyxcbiAgZmlsdGVyPzogc3RyaW5nLFxuICBjYWxsYmFjaz86IChwYXlsb2FkOiBhbnkpID0+IHZvaWRcbikgPT4ge1xuICByZXR1cm4gc3VwYWJhc2VcbiAgICAuY2hhbm5lbChgcmVhbHRpbWUtJHt0YWJsZX1gKVxuICAgIC5vbihcbiAgICAgICdwb3N0Z3Jlc19jaGFuZ2VzJyxcbiAgICAgIHtcbiAgICAgICAgZXZlbnQ6ICcqJyxcbiAgICAgICAgc2NoZW1hOiAncHVibGljJyxcbiAgICAgICAgdGFibGUsXG4gICAgICAgIGZpbHRlcixcbiAgICAgIH0sXG4gICAgICBjYWxsYmFjayB8fCAoKHBheWxvYWQpID0+IGNvbnNvbGUubG9nKCdSZWFsdGltZSB1cGRhdGU6JywgcGF5bG9hZCkpXG4gICAgKVxuICAgIC5zdWJzY3JpYmUoKTtcbn07XG4iXSwibmFtZXMiOlsiY3JlYXRlQ2xpZW50Iiwic3VwYWJhc2VVcmwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwic3VwYWJhc2VBbm9uS2V5IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJFcnJvciIsInN1cGFiYXNlIiwiYXV0aCIsImF1dG9SZWZyZXNoVG9rZW4iLCJwZXJzaXN0U2Vzc2lvbiIsImRldGVjdFNlc3Npb25JblVybCIsImdsb2JhbCIsImZldGNoIiwidXJsIiwib3B0aW9ucyIsInNpZ25hbCIsIkFib3J0U2lnbmFsIiwidGltZW91dCIsImRiIiwic2NoZW1hIiwicmVhbHRpbWUiLCJwYXJhbXMiLCJldmVudHNQZXJTZWNvbmQiLCJjcmVhdGVTZXJ2ZXJTdXBhYmFzZUNsaWVudCIsInNlcnZpY2VSb2xlS2V5IiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsImhhbmRsZVN1cGFiYXNlRXJyb3IiLCJlcnJvciIsImNvbnNvbGUiLCJjb2RlIiwibWVzc2FnZSIsImNyZWF0ZVJlYWx0aW1lU3Vic2NyaXB0aW9uIiwidGFibGUiLCJmaWx0ZXIiLCJjYWxsYmFjayIsImNoYW5uZWwiLCJvbiIsImV2ZW50IiwicGF5bG9hZCIsImxvZyIsInN1YnNjcmliZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/supabase.ts\n");

/***/ }),

/***/ "(rsc)/./src/services/bitnob.service.ts":
/*!****************************************!*\
  !*** ./src/services/bitnob.service.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BitnobService: () => (/* binding */ BitnobService),\n/* harmony export */   bitnobService: () => (/* binding */ bitnobService),\n/* harmony export */   createBitnobService: () => (/* binding */ createBitnobService)\n/* harmony export */ });\n/* harmony import */ var _mock_bitnob_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./mock-bitnob.service */ \"(rsc)/./src/services/mock-bitnob.service.ts\");\n/**\n * Bitnob Service - Blockchain integration for SACCO platform\n * Handles Bitcoin Lightning Network payments, wallet operations, and KYC\n */ \nclass BitnobService {\n    constructor(config){\n        this.config = config;\n        this.baseURL = config.baseURL || (config.environment === 'production' ? 'https://api.bitnob.com/api/v1' : 'https://sandboxapi.bitnob.com/api/v1');\n        this.mockServices = _mock_bitnob_service__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getInstance();\n    }\n    generateSignature(method, path, timestamp, nonce, body = '') {\n        const crypto = __webpack_require__(/*! crypto */ \"crypto\");\n        const message = `${method}${path}${timestamp}${nonce}${body}`;\n        return crypto.createHmac('sha256', this.config.secretKey).update(message).digest('hex');\n    }\n    async makeRequest(endpoint, method = 'GET', data) {\n        try {\n            const crypto = __webpack_require__(/*! crypto */ \"crypto\");\n            const timestamp = Date.now().toString();\n            const nonce = crypto.randomBytes(16).toString('hex');\n            const body = data ? JSON.stringify(data) : '';\n            const signature = this.generateSignature(method, endpoint, timestamp, nonce, body);\n            // Create timeout controller\n            const controller = new AbortController();\n            const timeoutId = setTimeout(()=>controller.abort(), 10000); // 10 second timeout\n            const response = await fetch(`${this.baseURL}${endpoint}`, {\n                method,\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Accept': 'application/json',\n                    'x-auth-timestamp': timestamp,\n                    'x-auth-nonce': nonce,\n                    'x-auth-signature': signature\n                },\n                body: data ? JSON.stringify(data) : undefined,\n                signal: controller.signal\n            });\n            clearTimeout(timeoutId);\n            if (!response.ok) {\n                const errorData = await response.json().catch(()=>({}));\n                throw new Error(`Bitnob API Error: ${response.status} - ${errorData.message || response.statusText}`);\n            }\n            return await response.json();\n        } catch (error) {\n            console.error('Bitnob Service Error:', error);\n            // Handle specific network errors\n            if (error instanceof Error) {\n                if (error.message.includes('getaddrinfo ENOTFOUND') || error.message.includes('fetch failed')) {\n                    throw new Error('Bitnob service is currently unavailable. Please try again later.');\n                }\n                if (error.name === 'AbortError') {\n                    throw new Error('Bitnob service request timed out. Please try again.');\n                }\n            }\n            throw error;\n        }\n    }\n    // Check if Bitnob service is available\n    async isServiceAvailable() {\n        try {\n            // Check if credentials are configured\n            if (!this.config.secretKey) {\n                console.warn('Bitnob credentials not configured');\n                return false;\n            }\n            // Test with wallets endpoint (confirmed working)\n            const response = await this.makeRequest('/wallets');\n            return response && (response.statusCode === 200 || response.status === 'success');\n        } catch (error) {\n            console.error('Bitnob service availability check failed:', error);\n            // If it's a 401/403, credentials are wrong but service is available\n            if (error instanceof Error && (error.message.includes('401') || error.message.includes('403'))) {\n                console.warn('Bitnob credentials may be invalid, but service is available');\n                return true; // Service is available, just auth issue\n            }\n            return false;\n        }\n    }\n    // Get available features in current Bitnob environment\n    async getAvailableFeatures() {\n        return {\n            wallets: true,\n            transactions: true,\n            lightning: false,\n            crossBorder: false,\n            virtualCards: false,\n            stablecoins: false,\n            message: 'Bitnob sandbox currently supports wallet management and transaction history only. Lightning and other advanced features may be available in production.'\n        };\n    }\n    // Test available endpoints\n    async testEndpoints() {\n        const endpoints = [\n            '/health',\n            '/ping',\n            '/wallets',\n            '/lightning/invoice',\n            '/lightning/send',\n            '/bitcoin/send',\n            '/rates'\n        ];\n        const results = {};\n        for (const endpoint of endpoints){\n            try {\n                const crypto = __webpack_require__(/*! crypto */ \"crypto\");\n                const timestamp = Date.now().toString();\n                const nonce = crypto.randomBytes(16).toString('hex');\n                const signature = this.generateSignature('GET', endpoint, timestamp, nonce);\n                const response = await fetch(`${this.baseURL}${endpoint}`, {\n                    method: 'GET',\n                    headers: {\n                        'x-auth-timestamp': timestamp,\n                        'x-auth-nonce': nonce,\n                        'x-auth-signature': signature,\n                        'Content-Type': 'application/json'\n                    }\n                });\n                results[endpoint] = response.status !== 404;\n            } catch (error) {\n                results[endpoint] = false;\n            }\n        }\n        return results;\n    }\n    // Authentication and User Management\n    async createWallet(userData) {\n        try {\n            // Use the available /wallets endpoint for wallet operations\n            const response = await this.makeRequest('/wallets', 'POST', {\n                phoneNumber: userData.phoneNumber,\n                email: userData.email,\n                firstName: userData.firstName,\n                lastName: userData.lastName,\n                dateOfBirth: userData.dateOfBirth,\n                address: userData.address\n            });\n            return response.data;\n        } catch (error) {\n            console.error('Bitnob wallet creation error:', error);\n            throw new Error(`Wallet creation failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    async getWalletDetails(walletId) {\n        try {\n            const response = await this.makeRequest(`/wallets/${walletId}`);\n            return response.data;\n        } catch (error) {\n            throw new Error(`Failed to get wallet details: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    async getWalletBalance(walletId) {\n        try {\n            const response = await this.makeRequest(`/wallets/${walletId}/balance`);\n            return response.data;\n        } catch (error) {\n            throw new Error(`Balance inquiry failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    // Lightning Network Operations (Enhanced with Mock Services)\n    async sendLightningPayment(paymentData) {\n        try {\n            // Use mock service in sandbox environment\n            if (this.config.environment === 'sandbox') {\n                console.log('🌩️ Using mock Lightning service in sandbox mode');\n                const mockPayment = await this.mockServices.sendLightningPayment(`lnbc${paymentData.amount}`, paymentData.amount);\n                return {\n                    success: true,\n                    data: mockPayment,\n                    message: 'Lightning payment initiated (mock service)'\n                };\n            }\n            // Production Lightning payment\n            const response = await this.makeRequest('/lightning/send', 'POST', paymentData);\n            return response.data;\n        } catch (error) {\n            console.error('Lightning payment error:', error);\n            throw error;\n        }\n    }\n    async createLightningInvoice(invoiceData) {\n        try {\n            // Use mock service in sandbox environment\n            if (this.config.environment === 'sandbox') {\n                console.log('⚡ Using mock Lightning invoice service in sandbox mode');\n                const mockInvoice = await this.mockServices.createLightningInvoice(invoiceData.amount, invoiceData.memo || 'SACCO Platform Payment');\n                return {\n                    success: true,\n                    data: mockInvoice,\n                    message: 'Lightning invoice created (mock service)'\n                };\n            }\n            // Production Lightning invoice\n            const response = await this.makeRequest('/lightning/invoice', 'POST', {\n                amount: invoiceData.amount,\n                currency: invoiceData.currency,\n                reference: invoiceData.reference,\n                memo: invoiceData.memo || 'SACCO Platform Payment',\n                expiresIn: invoiceData.expiresIn || 3600\n            });\n            return response.data;\n        } catch (error) {\n            throw new Error(`Invoice creation failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    async payLightningInvoice(invoice, walletId) {\n        try {\n            // Use mock service in sandbox environment\n            if (this.config.environment === 'sandbox') {\n                console.log('💰 Using mock Lightning payment service in sandbox mode');\n                const mockPayment = await this.mockServices.sendLightningPayment(invoice, 0);\n                return {\n                    success: true,\n                    data: mockPayment,\n                    message: 'Lightning invoice paid (mock service)'\n                };\n            }\n            // Production Lightning payment\n            const response = await this.makeRequest('/lightning/pay', 'POST', {\n                invoice,\n                walletId\n            });\n            return response.data;\n        } catch (error) {\n            throw new Error(`Invoice payment failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    // Bitcoin On-Chain Operations\n    async sendBitcoin(paymentData) {\n        try {\n            const response = await this.makeRequest('/bitcoin/send', 'POST', {\n                amount: paymentData.amount,\n                address: paymentData.address,\n                reference: paymentData.reference,\n                narration: paymentData.narration || 'SACCO Platform Payment'\n            });\n            return response.data;\n        } catch (error) {\n            throw new Error(`Bitcoin transaction failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    async generateBitcoinAddress(walletId) {\n        try {\n            const response = await this.makeRequest(`/bitcoin/address/${walletId}`, 'POST');\n            return response.data;\n        } catch (error) {\n            throw new Error(`Address generation failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    // KYC Operations\n    async submitKYC(kycData) {\n        try {\n            // Note: File uploads would need FormData instead of JSON\n            const formData = new FormData();\n            Object.entries(kycData).forEach(([key, value])=>{\n                if (value instanceof File) {\n                    formData.append(key, value);\n                } else if (value) {\n                    formData.append(key, value.toString());\n                }\n            });\n            const crypto = __webpack_require__(/*! crypto */ \"crypto\");\n            const timestamp = Date.now().toString();\n            const nonce = crypto.randomBytes(16).toString('hex');\n            const signature = this.generateSignature('POST', '/kyc/submit', timestamp, nonce);\n            const response = await fetch(`${this.baseURL}/kyc/submit`, {\n                method: 'POST',\n                headers: {\n                    'x-auth-timestamp': timestamp,\n                    'x-auth-nonce': nonce,\n                    'x-auth-signature': signature\n                },\n                body: formData\n            });\n            if (!response.ok) {\n                const errorData = await response.json().catch(()=>({}));\n                throw new Error(`KYC submission failed: ${errorData.message || response.statusText}`);\n            }\n            const result = await response.json();\n            return result.data;\n        } catch (error) {\n            throw new Error(`KYC submission failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    async getKYCStatus(userId) {\n        try {\n            const response = await this.makeRequest(`/kyc/status/${userId}`);\n            return response.data;\n        } catch (error) {\n            throw new Error(`KYC status check failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    // Currency Conversion\n    async convertBTCToFiat(conversionData) {\n        try {\n            const response = await this.makeRequest('/convert', 'POST', {\n                amount: conversionData.amount,\n                fromCurrency: conversionData.fromCurrency,\n                toCurrency: conversionData.toCurrency,\n                reference: conversionData.reference\n            });\n            return response.data;\n        } catch (error) {\n            throw new Error(`Conversion failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    async getExchangeRates(baseCurrency = 'BTC') {\n        try {\n            const response = await this.makeRequest(`/rates?base=${baseCurrency}`);\n            return response.data;\n        } catch (error) {\n            throw new Error(`Failed to get exchange rates: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    // Transaction History\n    async getTransactionHistory(walletId, limit = 50, offset = 0) {\n        try {\n            const response = await this.makeRequest(`/transactions?walletId=${walletId}&limit=${limit}&offset=${offset}`);\n            return response.data;\n        } catch (error) {\n            throw new Error(`Failed to get transaction history: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    async getTransactionDetails(transactionId) {\n        try {\n            const response = await this.makeRequest(`/transactions/${transactionId}`);\n            return response.data;\n        } catch (error) {\n            throw new Error(`Failed to get transaction details: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    // Webhook verification (for backend use)\n    verifyWebhookSignature(payload, signature, secret) {\n        // Implementation would depend on Bitnob's webhook signature method\n        // This is a placeholder for the actual verification logic\n        try {\n            const crypto = __webpack_require__(/*! crypto */ \"crypto\");\n            const expectedSignature = crypto.createHmac('sha256', secret).update(payload).digest('hex');\n            return crypto.timingSafeEqual(Buffer.from(signature, 'hex'), Buffer.from(expectedSignature, 'hex'));\n        } catch (error) {\n            console.error('Webhook signature verification failed:', error);\n            return false;\n        }\n    }\n    // USDT/Stablecoin Operations\n    async sendUSDT(stablecoinData) {\n        try {\n            const response = await this.makeRequest('/stablecoins/usdt/send', 'POST', {\n                amount: stablecoinData.amount,\n                currency: stablecoinData.currency,\n                targetNetwork: stablecoinData.targetNetwork,\n                recipientAddress: stablecoinData.recipientAddress,\n                reference: stablecoinData.reference\n            });\n            return response.data;\n        } catch (error) {\n            throw new Error(`USDT transfer failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    async convertToUSDT(conversionData) {\n        try {\n            const response = await this.makeRequest('/stablecoins/convert', 'POST', {\n                amount: conversionData.amount,\n                fromCurrency: conversionData.fromCurrency,\n                toCurrency: 'USDT',\n                reference: conversionData.reference\n            });\n            return response.data;\n        } catch (error) {\n            throw new Error(`USDT conversion failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    async getCrossBorderRates(sourceCurrency, targetCurrency, recipientCountry) {\n        try {\n            const response = await this.makeRequest(`/cross-border/rates?source=${sourceCurrency}&target=${targetCurrency}&country=${recipientCountry}`);\n            return response.data;\n        } catch (error) {\n            throw new Error(`Failed to get cross-border rates: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    async updateCardLimit(cardId, newLimit) {\n        try {\n            const response = await this.makeRequest(`/virtual-cards/${cardId}/limit`, 'PUT', {\n                spendingLimit: newLimit\n            });\n            return response.data;\n        } catch (error) {\n            throw new Error(`Failed to update card limit: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    // Cross-Border Payment Operations (Enhanced with Mock Services)\n    async sendCrossBorderPayment(paymentData) {\n        try {\n            // Use mock service in sandbox environment\n            if (this.config.environment === 'sandbox') {\n                console.log('🌍 Using mock cross-border service in sandbox mode');\n                const mockTransfer = await this.mockServices.initiateCrossBorderTransfer(paymentData.amount, paymentData.targetCurrency, paymentData.recipientCountry);\n                return {\n                    success: true,\n                    data: mockTransfer,\n                    message: 'Cross-border payment initiated (mock service)'\n                };\n            }\n            // Production cross-border payment\n            const response = await this.makeRequest('/cross-border/send', 'POST', paymentData);\n            return response.data;\n        } catch (error) {\n            throw new Error(`Cross-border payment failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    async getCrossBorderTransfers() {\n        try {\n            // Use mock service in sandbox environment\n            if (this.config.environment === 'sandbox') {\n                console.log('📋 Using mock cross-border history in sandbox mode');\n                const mockTransfers = await this.mockServices.getCrossBorderTransfers();\n                return {\n                    success: true,\n                    data: mockTransfers,\n                    message: 'Cross-border transfers retrieved (mock service)'\n                };\n            }\n            // Production cross-border history\n            const response = await this.makeRequest('/cross-border/transfers');\n            return response.data;\n        } catch (error) {\n            throw new Error(`Failed to get cross-border transfers: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    // Virtual Card Operations (Enhanced with Mock Services)\n    async createVirtualCard(cardData) {\n        try {\n            // Use mock service in sandbox environment\n            if (this.config.environment === 'sandbox') {\n                console.log('💳 Using mock virtual card service in sandbox mode');\n                const mockCard = await this.mockServices.createVirtualCard('visa');\n                return {\n                    success: true,\n                    data: mockCard,\n                    message: 'Virtual card created (mock service)'\n                };\n            }\n            // Production virtual card creation\n            const response = await this.makeRequest('/virtual-cards', 'POST', cardData);\n            return response.data;\n        } catch (error) {\n            throw new Error(`Virtual card creation failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    async getVirtualCards(userId) {\n        try {\n            // Use mock service in sandbox environment\n            if (this.config.environment === 'sandbox') {\n                console.log('🗂️ Using mock virtual card list in sandbox mode');\n                const mockCards = await this.mockServices.getVirtualCards();\n                return {\n                    success: true,\n                    data: mockCards,\n                    message: 'Virtual cards retrieved (mock service)'\n                };\n            }\n            // Production virtual cards\n            const endpoint = userId ? `/virtual-cards/user/${userId}` : '/virtual-cards';\n            const response = await this.makeRequest(endpoint);\n            return response.data;\n        } catch (error) {\n            throw new Error(`Failed to get virtual cards: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    async fundVirtualCard(cardId, amount) {\n        try {\n            // Use mock service in sandbox environment\n            if (this.config.environment === 'sandbox') {\n                console.log('💰 Using mock card funding in sandbox mode');\n                const success = await this.mockServices.fundVirtualCard(cardId, amount);\n                return {\n                    success,\n                    message: `Virtual card ${success ? 'funded' : 'funding failed'} (mock service)`\n                };\n            }\n            // Production card funding\n            const response = await this.makeRequest(`/virtual-cards/${cardId}/fund`, 'POST', {\n                amount\n            });\n            return response.data;\n        } catch (error) {\n            throw new Error(`Failed to fund card: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    async freezeCard(cardId) {\n        try {\n            // Use mock service in sandbox environment\n            if (this.config.environment === 'sandbox') {\n                console.log('🧊 Using mock card freeze in sandbox mode');\n                const success = await this.mockServices.freezeVirtualCard(cardId);\n                return {\n                    success,\n                    message: `Virtual card ${success ? 'frozen' : 'freeze failed'} (mock service)`\n                };\n            }\n            // Production card freeze\n            const response = await this.makeRequest(`/virtual-cards/${cardId}/freeze`, 'POST');\n            return response.data;\n        } catch (error) {\n            throw new Error(`Failed to freeze card: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    async unfreezeCard(cardId) {\n        try {\n            // Use mock service in sandbox environment\n            if (this.config.environment === 'sandbox') {\n                console.log('🔥 Mock card unfreeze not implemented - using production endpoint');\n            }\n            // Production card unfreeze\n            const response = await this.makeRequest(`/virtual-cards/${cardId}/unfreeze`, 'POST');\n            return response.data;\n        } catch (error) {\n            throw new Error(`Failed to unfreeze card: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    // USDT/Stablecoin Operations\n    async buyStablecoin(stablecoinData) {\n        try {\n            // Use mock service in sandbox environment\n            if (this.config.environment === 'sandbox') {\n                console.log('🪙 Using mock USDT buy service in sandbox mode');\n                const mockOperation = await this.mockServices.buyUSDT(stablecoinData.amount);\n                return {\n                    success: true,\n                    data: mockOperation,\n                    message: 'USDT purchased (mock service)'\n                };\n            }\n            // Production stablecoin purchase\n            const response = await this.makeRequest('/stablecoins/buy', 'POST', stablecoinData);\n            return response.data;\n        } catch (error) {\n            throw new Error(`Stablecoin purchase failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    async sellStablecoin(stablecoinData) {\n        try {\n            // Use mock service in sandbox environment\n            if (this.config.environment === 'sandbox') {\n                console.log('💱 Using mock USDT sell service in sandbox mode');\n                const mockOperation = await this.mockServices.sellUSDT(stablecoinData.amount);\n                return {\n                    success: true,\n                    data: mockOperation,\n                    message: 'USDT sold (mock service)'\n                };\n            }\n            // Production stablecoin sale\n            const response = await this.makeRequest('/stablecoins/sell', 'POST', stablecoinData);\n            return response.data;\n        } catch (error) {\n            throw new Error(`Stablecoin sale failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    async transferStablecoin(stablecoinData) {\n        try {\n            // Use mock service in sandbox environment\n            if (this.config.environment === 'sandbox') {\n                console.log('🔄 Using mock USDT transfer service in sandbox mode');\n                const mockOperation = await this.mockServices.transferUSDT(stablecoinData.amount, stablecoinData.recipientAddress || 'mock-recipient');\n                return {\n                    success: true,\n                    data: mockOperation,\n                    message: 'USDT transferred (mock service)'\n                };\n            }\n            // Production stablecoin transfer\n            const response = await this.makeRequest('/stablecoins/transfer', 'POST', stablecoinData);\n            return response.data;\n        } catch (error) {\n            throw new Error(`Stablecoin transfer failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    async getStablecoinOperations() {\n        try {\n            // Use mock service in sandbox environment\n            if (this.config.environment === 'sandbox') {\n                console.log('📊 Using mock USDT operations in sandbox mode');\n                const mockOperations = await this.mockServices.getUSDTOperations();\n                return {\n                    success: true,\n                    data: mockOperations,\n                    message: 'USDT operations retrieved (mock service)'\n                };\n            }\n            // Production stablecoin operations\n            const response = await this.makeRequest('/stablecoins/operations');\n            return response.data;\n        } catch (error) {\n            throw new Error(`Failed to get stablecoin operations: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    // Health check\n    async healthCheck() {\n        try {\n            const response = await this.makeRequest('/health');\n            return response;\n        } catch (error) {\n            throw new Error(`Health check failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n}\n// Singleton instance for frontend use\nlet bitnobServiceInstance = null;\nfunction createBitnobService() {\n    if (bitnobServiceInstance) {\n        return bitnobServiceInstance;\n    }\n    // Get configuration from environment variables\n    const secretKey = process.env.BITNOB_SECRET_KEY || '';\n    const baseURL = process.env.NEXT_PUBLIC_BITNOB_BASE_URL || process.env.BITNOB_BASE_URL || 'https://sandboxapi.bitnob.com/api/v1';\n    const serviceConfig = {\n        secretKey,\n        environment: baseURL.includes('sandbox') ? 'sandbox' : 'production',\n        baseURL: baseURL\n    };\n    // Warn if credentials are missing\n    if (!secretKey) {\n        console.warn('Bitnob credentials not configured. Bitcoin wallet features will be disabled.');\n    }\n    bitnobServiceInstance = new BitnobService(serviceConfig);\n    return bitnobServiceInstance;\n}\n// Default export for convenience\nconst bitnobService = createBitnobService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q3hDLE9BQU9lLFNBQVNiLElBQUk7UUFDdEIsRUFBRSxPQUFPMEIsT0FBTztZQUNkLE1BQU0sSUFBSUgsTUFBTSxDQUFDLHFDQUFxQyxFQUFFRyxpQkFBaUJILFFBQVFHLE1BQU1qQyxPQUFPLEdBQUcsaUJBQWlCO1FBQ3BIO0lBQ0Y7SUFFQSxlQUFlO0lBQ2YsTUFBTW9KLGNBQWM7UUFDbEIsSUFBSTtZQUNGLE1BQU1oSSxXQUFXLE1BQU0sSUFBSSxDQUFDZixXQUFXLENBQUM7WUFDeEMsT0FBT2U7UUFDVCxFQUFFLE9BQU9hLE9BQU87WUFDZCxNQUFNLElBQUlILE1BQU0sQ0FBQyxxQkFBcUIsRUFBRUcsaUJBQWlCSCxRQUFRRyxNQUFNakMsT0FBTyxHQUFHLGlCQUFpQjtRQUNwRztJQUNGO0FBQ0Y7QUFFQSxzQ0FBc0M7QUFDdEMsSUFBSXFKLHdCQUE4QztBQUUzQyxTQUFTQztJQUNkLElBQUlELHVCQUF1QjtRQUN6QixPQUFPQTtJQUNUO0lBRUEsK0NBQStDO0lBQy9DLE1BQU1uSixZQUFZcUosUUFBUUMsR0FBRyxDQUFDQyxpQkFBaUIsSUFBSTtJQUNuRCxNQUFNckssVUFBVW1LLFFBQVFDLEdBQUcsQ0FBQ0UsMkJBQTJCLElBQUlILFFBQVFDLEdBQUcsQ0FBQ0csZUFBZSxJQUFJO0lBRTFGLE1BQU1DLGdCQUE4QjtRQUNsQzFKO1FBQ0FiLGFBQWFELFFBQVErQyxRQUFRLENBQUMsYUFBYSxZQUFZO1FBQ3ZEL0MsU0FBU0E7SUFDWDtJQUVBLGtDQUFrQztJQUNsQyxJQUFJLENBQUNjLFdBQVc7UUFDZGdDLFFBQVFJLElBQUksQ0FBQztJQUNmO0lBRUErRyx3QkFBd0IsSUFBSW5LLGNBQWMwSztJQUUxQyxPQUFPUDtBQUNUO0FBRUEsaUNBQWlDO0FBQzFCLE1BQU1RLGdCQUFnQlAsc0JBQXNCIiwic291cmNlcyI6WyIvaG9tZS9lcnJvcjUxL2JpdG5vYi9wcm9qZWN0L3ZpbGxhZ2Utc2FjY28vc3JjL3NlcnZpY2VzL2JpdG5vYi5zZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQml0bm9iIFNlcnZpY2UgLSBCbG9ja2NoYWluIGludGVncmF0aW9uIGZvciBTQUNDTyBwbGF0Zm9ybVxuICogSGFuZGxlcyBCaXRjb2luIExpZ2h0bmluZyBOZXR3b3JrIHBheW1lbnRzLCB3YWxsZXQgb3BlcmF0aW9ucywgYW5kIEtZQ1xuICovXG5cbmltcG9ydCBjcnlwdG8gZnJvbSAnY3J5cHRvJztcbmltcG9ydCBNb2NrQml0bm9iU2VydmljZXMgZnJvbSAnLi9tb2NrLWJpdG5vYi5zZXJ2aWNlJztcblxuaW50ZXJmYWNlIEJpdG5vYkNvbmZpZyB7XG4gIHNlY3JldEtleTogc3RyaW5nO1xuICBiYXNlVVJMOiBzdHJpbmc7XG4gIGVudmlyb25tZW50OiAnc2FuZGJveCcgfCAncHJvZHVjdGlvbic7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgV2FsbGV0RGF0YSB7XG4gIHBob25lTnVtYmVyOiBzdHJpbmc7XG4gIGVtYWlsOiBzdHJpbmc7XG4gIGZpcnN0TmFtZTogc3RyaW5nO1xuICBsYXN0TmFtZTogc3RyaW5nO1xuICBkYXRlT2ZCaXJ0aD86IHN0cmluZztcbiAgYWRkcmVzcz86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQYXltZW50RGF0YSB7XG4gIGFtb3VudDogbnVtYmVyO1xuICBjdXJyZW5jeTogc3RyaW5nO1xuICByZWNpcGllbnRJZD86IHN0cmluZztcbiAgcGhvbmVOdW1iZXI/OiBzdHJpbmc7XG4gIGVtYWlsPzogc3RyaW5nO1xuICByZWZlcmVuY2U6IHN0cmluZztcbiAgbmFycmF0aW9uPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIExpZ2h0bmluZ0ludm9pY2VEYXRhIHtcbiAgYW1vdW50OiBudW1iZXI7XG4gIGN1cnJlbmN5OiBzdHJpbmc7XG4gIHJlZmVyZW5jZTogc3RyaW5nO1xuICBtZW1vPzogc3RyaW5nO1xuICBleHBpcmVzSW4/OiBudW1iZXI7IC8vIHNlY29uZHNcbn1cblxuZXhwb3J0IGludGVyZmFjZSBLWUNEYXRhIHtcbiAgZmlyc3ROYW1lOiBzdHJpbmc7XG4gIGxhc3ROYW1lOiBzdHJpbmc7XG4gIGRhdGVPZkJpcnRoOiBzdHJpbmc7XG4gIHBob25lTnVtYmVyOiBzdHJpbmc7XG4gIGVtYWlsOiBzdHJpbmc7XG4gIGFkZHJlc3M6IHN0cmluZztcbiAgaWRUeXBlOiAnbmluJyB8ICdwYXNzcG9ydCcgfCAnZHJpdmVyc19saWNlbnNlJztcbiAgaWROdW1iZXI6IHN0cmluZztcbiAgaWREb2N1bWVudD86IEZpbGU7XG4gIHByb29mT2ZBZGRyZXNzPzogRmlsZTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb252ZXJzaW9uRGF0YSB7XG4gIGFtb3VudDogbnVtYmVyO1xuICBmcm9tQ3VycmVuY3k6IHN0cmluZztcbiAgdG9DdXJyZW5jeTogc3RyaW5nO1xuICByZWZlcmVuY2U6IHN0cmluZztcbn1cblxuLy8gTmV3IEJpdG5vYiBTZXJ2aWNlIFR5cGVzXG5leHBvcnQgaW50ZXJmYWNlIFN0YWJsZWNvaW5EYXRhIHtcbiAgYW1vdW50OiBudW1iZXI7XG4gIGN1cnJlbmN5OiBzdHJpbmc7XG4gIHRhcmdldE5ldHdvcms6ICdldGhlcmV1bScgfCAndHJvbicgfCAncG9seWdvbic7XG4gIHJlY2lwaWVudEFkZHJlc3M/OiBzdHJpbmc7XG4gIHJlZmVyZW5jZTogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENyb3NzQm9yZGVyUGF5bWVudERhdGEge1xuICBhbW91bnQ6IG51bWJlcjtcbiAgc291cmNlQ3VycmVuY3k6IHN0cmluZztcbiAgdGFyZ2V0Q3VycmVuY3k6IHN0cmluZztcbiAgcmVjaXBpZW50Q291bnRyeTogc3RyaW5nO1xuICByZWNpcGllbnRQaG9uZU51bWJlcj86IHN0cmluZztcbiAgcmVjaXBpZW50QmFua0FjY291bnQ/OiBzdHJpbmc7XG4gIHJlZmVyZW5jZTogc3RyaW5nO1xuICBkZXNjcmlwdGlvbj86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBWaXJ0dWFsQ2FyZERhdGEge1xuICB1c2VySWQ6IHN0cmluZztcbiAgY2FyZEhvbGRlck5hbWU6IHN0cmluZztcbiAgc3BlbmRpbmdMaW1pdDogbnVtYmVyO1xuICBjdXJyZW5jeTogc3RyaW5nO1xuICB0eXBlOiAndmlydHVhbCcgfCAncGh5c2ljYWwnO1xufVxuXG5leHBvcnQgY2xhc3MgQml0bm9iU2VydmljZSB7XG4gIHByaXZhdGUgY29uZmlnOiBCaXRub2JDb25maWc7XG4gIHByaXZhdGUgYmFzZVVSTDogc3RyaW5nO1xuICBwcml2YXRlIG1vY2tTZXJ2aWNlczogTW9ja0JpdG5vYlNlcnZpY2VzO1xuXG4gIGNvbnN0cnVjdG9yKGNvbmZpZzogQml0bm9iQ29uZmlnKSB7XG4gICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gICAgdGhpcy5iYXNlVVJMID0gY29uZmlnLmJhc2VVUkwgfHwgXG4gICAgICAoY29uZmlnLmVudmlyb25tZW50ID09PSAncHJvZHVjdGlvbicgXG4gICAgICAgID8gJ2h0dHBzOi8vYXBpLmJpdG5vYi5jb20vYXBpL3YxJyBcbiAgICAgICAgOiAnaHR0cHM6Ly9zYW5kYm94YXBpLmJpdG5vYi5jb20vYXBpL3YxJyk7XG4gICAgdGhpcy5tb2NrU2VydmljZXMgPSBNb2NrQml0bm9iU2VydmljZXMuZ2V0SW5zdGFuY2UoKTtcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVTaWduYXR1cmUobWV0aG9kOiBzdHJpbmcsIHBhdGg6IHN0cmluZywgdGltZXN0YW1wOiBzdHJpbmcsIG5vbmNlOiBzdHJpbmcsIGJvZHk6IHN0cmluZyA9ICcnKTogc3RyaW5nIHtcbiAgICBjb25zdCBjcnlwdG8gPSByZXF1aXJlKCdjcnlwdG8nKTtcbiAgICBjb25zdCBtZXNzYWdlID0gYCR7bWV0aG9kfSR7cGF0aH0ke3RpbWVzdGFtcH0ke25vbmNlfSR7Ym9keX1gO1xuICAgIHJldHVybiBjcnlwdG9cbiAgICAgIC5jcmVhdGVIbWFjKCdzaGEyNTYnLCB0aGlzLmNvbmZpZy5zZWNyZXRLZXkpXG4gICAgICAudXBkYXRlKG1lc3NhZ2UpXG4gICAgICAuZGlnZXN0KCdoZXgnKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgbWFrZVJlcXVlc3QoZW5kcG9pbnQ6IHN0cmluZywgbWV0aG9kOiBzdHJpbmcgPSAnR0VUJywgZGF0YT86IGFueSkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjcnlwdG8gPSByZXF1aXJlKCdjcnlwdG8nKTtcbiAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IERhdGUubm93KCkudG9TdHJpbmcoKTtcbiAgICAgIGNvbnN0IG5vbmNlID0gY3J5cHRvLnJhbmRvbUJ5dGVzKDE2KS50b1N0cmluZygnaGV4Jyk7XG4gICAgICBjb25zdCBib2R5ID0gZGF0YSA/IEpTT04uc3RyaW5naWZ5KGRhdGEpIDogJyc7XG4gICAgICBjb25zdCBzaWduYXR1cmUgPSB0aGlzLmdlbmVyYXRlU2lnbmF0dXJlKG1ldGhvZCwgZW5kcG9pbnQsIHRpbWVzdGFtcCwgbm9uY2UsIGJvZHkpO1xuXG4gICAgICAvLyBDcmVhdGUgdGltZW91dCBjb250cm9sbGVyXG4gICAgICBjb25zdCBjb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuICAgICAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiBjb250cm9sbGVyLmFib3J0KCksIDEwMDAwKTsgLy8gMTAgc2Vjb25kIHRpbWVvdXRcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmJhc2VVUkx9JHtlbmRwb2ludH1gLCB7XG4gICAgICAgIG1ldGhvZCxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAneC1hdXRoLXRpbWVzdGFtcCc6IHRpbWVzdGFtcCxcbiAgICAgICAgICAneC1hdXRoLW5vbmNlJzogbm9uY2UsXG4gICAgICAgICAgJ3gtYXV0aC1zaWduYXR1cmUnOiBzaWduYXR1cmUsXG4gICAgICAgIH0sXG4gICAgICAgIGJvZHk6IGRhdGEgPyBKU09OLnN0cmluZ2lmeShkYXRhKSA6IHVuZGVmaW5lZCxcbiAgICAgICAgc2lnbmFsOiBjb250cm9sbGVyLnNpZ25hbCxcbiAgICAgIH0pO1xuXG4gICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcblxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICBjb25zdCBlcnJvckRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCkuY2F0Y2goKCkgPT4gKHt9KSk7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQml0bm9iIEFQSSBFcnJvcjogJHtyZXNwb25zZS5zdGF0dXN9IC0gJHtlcnJvckRhdGEubWVzc2FnZSB8fCByZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdCaXRub2IgU2VydmljZSBFcnJvcjonLCBlcnJvcik7XG4gICAgICBcbiAgICAgIC8vIEhhbmRsZSBzcGVjaWZpYyBuZXR3b3JrIGVycm9yc1xuICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgaWYgKGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ2dldGFkZHJpbmZvIEVOT1RGT1VORCcpIHx8IGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ2ZldGNoIGZhaWxlZCcpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdCaXRub2Igc2VydmljZSBpcyBjdXJyZW50bHkgdW5hdmFpbGFibGUuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGVycm9yLm5hbWUgPT09ICdBYm9ydEVycm9yJykge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQml0bm9iIHNlcnZpY2UgcmVxdWVzdCB0aW1lZCBvdXQuIFBsZWFzZSB0cnkgYWdhaW4uJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLy8gQ2hlY2sgaWYgQml0bm9iIHNlcnZpY2UgaXMgYXZhaWxhYmxlXG4gIGFzeW5jIGlzU2VydmljZUF2YWlsYWJsZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0cnkge1xuICAgICAgLy8gQ2hlY2sgaWYgY3JlZGVudGlhbHMgYXJlIGNvbmZpZ3VyZWRcbiAgICAgIGlmICghdGhpcy5jb25maWcuc2VjcmV0S2V5KSB7XG4gICAgICAgIGNvbnNvbGUud2FybignQml0bm9iIGNyZWRlbnRpYWxzIG5vdCBjb25maWd1cmVkJyk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgLy8gVGVzdCB3aXRoIHdhbGxldHMgZW5kcG9pbnQgKGNvbmZpcm1lZCB3b3JraW5nKVxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KCcvd2FsbGV0cycpO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlICYmIChyZXNwb25zZS5zdGF0dXNDb2RlID09PSAyMDAgfHwgcmVzcG9uc2Uuc3RhdHVzID09PSAnc3VjY2VzcycpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdCaXRub2Igc2VydmljZSBhdmFpbGFiaWxpdHkgY2hlY2sgZmFpbGVkOicsIGVycm9yKTtcbiAgICAgIC8vIElmIGl0J3MgYSA0MDEvNDAzLCBjcmVkZW50aWFscyBhcmUgd3JvbmcgYnV0IHNlcnZpY2UgaXMgYXZhaWxhYmxlXG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiAoZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnNDAxJykgfHwgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnNDAzJykpKSB7XG4gICAgICAgIGNvbnNvbGUud2FybignQml0bm9iIGNyZWRlbnRpYWxzIG1heSBiZSBpbnZhbGlkLCBidXQgc2VydmljZSBpcyBhdmFpbGFibGUnKTtcbiAgICAgICAgcmV0dXJuIHRydWU7IC8vIFNlcnZpY2UgaXMgYXZhaWxhYmxlLCBqdXN0IGF1dGggaXNzdWVcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvLyBHZXQgYXZhaWxhYmxlIGZlYXR1cmVzIGluIGN1cnJlbnQgQml0bm9iIGVudmlyb25tZW50XG4gIGFzeW5jIGdldEF2YWlsYWJsZUZlYXR1cmVzKCkge1xuICAgIHJldHVybiB7XG4gICAgICB3YWxsZXRzOiB0cnVlLCAgICAgICAgICAgLy8g4pyFIC93YWxsZXRzIGVuZHBvaW50IGF2YWlsYWJsZVxuICAgICAgdHJhbnNhY3Rpb25zOiB0cnVlLCAgICAgIC8vIOKchSAvdHJhbnNhY3Rpb25zIGVuZHBvaW50IGF2YWlsYWJsZSAgXG4gICAgICBsaWdodG5pbmc6IGZhbHNlLCAgICAgICAgLy8g4p2MIExpZ2h0bmluZyBlbmRwb2ludHMgbm90IGF2YWlsYWJsZSBpbiBzYW5kYm94XG4gICAgICBjcm9zc0JvcmRlcjogZmFsc2UsICAgICAgLy8g4p2MIENyb3NzLWJvcmRlciBlbmRwb2ludHMgbm90IGZvdW5kXG4gICAgICB2aXJ0dWFsQ2FyZHM6IGZhbHNlLCAgICAgLy8g4p2MIFZpcnR1YWwgY2FyZCBlbmRwb2ludHMgbm90IGZvdW5kXG4gICAgICBzdGFibGVjb2luczogZmFsc2UsICAgICAgLy8g4p2MIFN0YWJsZWNvaW4gZW5kcG9pbnRzIG5vdCBmb3VuZFxuICAgICAgbWVzc2FnZTogJ0JpdG5vYiBzYW5kYm94IGN1cnJlbnRseSBzdXBwb3J0cyB3YWxsZXQgbWFuYWdlbWVudCBhbmQgdHJhbnNhY3Rpb24gaGlzdG9yeSBvbmx5LiBMaWdodG5pbmcgYW5kIG90aGVyIGFkdmFuY2VkIGZlYXR1cmVzIG1heSBiZSBhdmFpbGFibGUgaW4gcHJvZHVjdGlvbi4nXG4gICAgfTtcbiAgfVxuXG4gIC8vIFRlc3QgYXZhaWxhYmxlIGVuZHBvaW50c1xuICBhc3luYyB0ZXN0RW5kcG9pbnRzKCk6IFByb21pc2U8eyBba2V5OiBzdHJpbmddOiBib29sZWFuIH0+IHtcbiAgICBjb25zdCBlbmRwb2ludHMgPSBbXG4gICAgICAnL2hlYWx0aCcsXG4gICAgICAnL3BpbmcnLCBcbiAgICAgICcvd2FsbGV0cycsXG4gICAgICAnL2xpZ2h0bmluZy9pbnZvaWNlJyxcbiAgICAgICcvbGlnaHRuaW5nL3NlbmQnLFxuICAgICAgJy9iaXRjb2luL3NlbmQnLFxuICAgICAgJy9yYXRlcydcbiAgICBdO1xuXG4gICAgY29uc3QgcmVzdWx0czogeyBba2V5OiBzdHJpbmddOiBib29sZWFuIH0gPSB7fTtcblxuICAgIGZvciAoY29uc3QgZW5kcG9pbnQgb2YgZW5kcG9pbnRzKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBjcnlwdG8gPSByZXF1aXJlKCdjcnlwdG8nKTtcbiAgICAgICAgY29uc3QgdGltZXN0YW1wID0gRGF0ZS5ub3coKS50b1N0cmluZygpO1xuICAgICAgICBjb25zdCBub25jZSA9IGNyeXB0by5yYW5kb21CeXRlcygxNikudG9TdHJpbmcoJ2hleCcpO1xuICAgICAgICBjb25zdCBzaWduYXR1cmUgPSB0aGlzLmdlbmVyYXRlU2lnbmF0dXJlKCdHRVQnLCBlbmRwb2ludCwgdGltZXN0YW1wLCBub25jZSk7XG5cbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmJhc2VVUkx9JHtlbmRwb2ludH1gLCB7XG4gICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAneC1hdXRoLXRpbWVzdGFtcCc6IHRpbWVzdGFtcCxcbiAgICAgICAgICAgICd4LWF1dGgtbm9uY2UnOiBub25jZSxcbiAgICAgICAgICAgICd4LWF1dGgtc2lnbmF0dXJlJzogc2lnbmF0dXJlLFxuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgcmVzdWx0c1tlbmRwb2ludF0gPSByZXNwb25zZS5zdGF0dXMgIT09IDQwNDtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJlc3VsdHNbZW5kcG9pbnRdID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH1cblxuICAvLyBBdXRoZW50aWNhdGlvbiBhbmQgVXNlciBNYW5hZ2VtZW50XG4gIGFzeW5jIGNyZWF0ZVdhbGxldCh1c2VyRGF0YTogV2FsbGV0RGF0YSkge1xuICAgIHRyeSB7XG4gICAgICAvLyBVc2UgdGhlIGF2YWlsYWJsZSAvd2FsbGV0cyBlbmRwb2ludCBmb3Igd2FsbGV0IG9wZXJhdGlvbnNcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5tYWtlUmVxdWVzdCgnL3dhbGxldHMnLCAnUE9TVCcsIHtcbiAgICAgICAgcGhvbmVOdW1iZXI6IHVzZXJEYXRhLnBob25lTnVtYmVyLFxuICAgICAgICBlbWFpbDogdXNlckRhdGEuZW1haWwsXG4gICAgICAgIGZpcnN0TmFtZTogdXNlckRhdGEuZmlyc3ROYW1lLFxuICAgICAgICBsYXN0TmFtZTogdXNlckRhdGEubGFzdE5hbWUsXG4gICAgICAgIGRhdGVPZkJpcnRoOiB1c2VyRGF0YS5kYXRlT2ZCaXJ0aCxcbiAgICAgICAgYWRkcmVzczogdXNlckRhdGEuYWRkcmVzcyxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0JpdG5vYiB3YWxsZXQgY3JlYXRpb24gZXJyb3I6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBXYWxsZXQgY3JlYXRpb24gZmFpbGVkOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdldFdhbGxldERldGFpbHMod2FsbGV0SWQ6IHN0cmluZykge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMubWFrZVJlcXVlc3QoYC93YWxsZXRzLyR7d2FsbGV0SWR9YCk7XG4gICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZ2V0IHdhbGxldCBkZXRhaWxzOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdldFdhbGxldEJhbGFuY2Uod2FsbGV0SWQ6IHN0cmluZykge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMubWFrZVJlcXVlc3QoYC93YWxsZXRzLyR7d2FsbGV0SWR9L2JhbGFuY2VgKTtcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEJhbGFuY2UgaW5xdWlyeSBmYWlsZWQ6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG4gICAgfVxuICB9XG5cbiAgLy8gTGlnaHRuaW5nIE5ldHdvcmsgT3BlcmF0aW9ucyAoRW5oYW5jZWQgd2l0aCBNb2NrIFNlcnZpY2VzKVxuICBhc3luYyBzZW5kTGlnaHRuaW5nUGF5bWVudChwYXltZW50RGF0YTogUGF5bWVudERhdGEpIHtcbiAgICB0cnkge1xuICAgICAgLy8gVXNlIG1vY2sgc2VydmljZSBpbiBzYW5kYm94IGVudmlyb25tZW50XG4gICAgICBpZiAodGhpcy5jb25maWcuZW52aXJvbm1lbnQgPT09ICdzYW5kYm94Jykge1xuICAgICAgICBjb25zb2xlLmxvZygn8J+Mqe+4jyBVc2luZyBtb2NrIExpZ2h0bmluZyBzZXJ2aWNlIGluIHNhbmRib3ggbW9kZScpO1xuICAgICAgICBjb25zdCBtb2NrUGF5bWVudCA9IGF3YWl0IHRoaXMubW9ja1NlcnZpY2VzLnNlbmRMaWdodG5pbmdQYXltZW50KFxuICAgICAgICAgIGBsbmJjJHtwYXltZW50RGF0YS5hbW91bnR9YCwgXG4gICAgICAgICAgcGF5bWVudERhdGEuYW1vdW50XG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBkYXRhOiBtb2NrUGF5bWVudCxcbiAgICAgICAgICBtZXNzYWdlOiAnTGlnaHRuaW5nIHBheW1lbnQgaW5pdGlhdGVkIChtb2NrIHNlcnZpY2UpJ1xuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICAvLyBQcm9kdWN0aW9uIExpZ2h0bmluZyBwYXltZW50XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMubWFrZVJlcXVlc3QoJy9saWdodG5pbmcvc2VuZCcsICdQT1NUJywgcGF5bWVudERhdGEpO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0xpZ2h0bmluZyBwYXltZW50IGVycm9yOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZUxpZ2h0bmluZ0ludm9pY2UoaW52b2ljZURhdGE6IExpZ2h0bmluZ0ludm9pY2VEYXRhKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFVzZSBtb2NrIHNlcnZpY2UgaW4gc2FuZGJveCBlbnZpcm9ubWVudFxuICAgICAgaWYgKHRoaXMuY29uZmlnLmVudmlyb25tZW50ID09PSAnc2FuZGJveCcpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ+KaoSBVc2luZyBtb2NrIExpZ2h0bmluZyBpbnZvaWNlIHNlcnZpY2UgaW4gc2FuZGJveCBtb2RlJyk7XG4gICAgICAgIGNvbnN0IG1vY2tJbnZvaWNlID0gYXdhaXQgdGhpcy5tb2NrU2VydmljZXMuY3JlYXRlTGlnaHRuaW5nSW52b2ljZShcbiAgICAgICAgICBpbnZvaWNlRGF0YS5hbW91bnQsXG4gICAgICAgICAgaW52b2ljZURhdGEubWVtbyB8fCAnU0FDQ08gUGxhdGZvcm0gUGF5bWVudCdcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGRhdGE6IG1vY2tJbnZvaWNlLFxuICAgICAgICAgIG1lc3NhZ2U6ICdMaWdodG5pbmcgaW52b2ljZSBjcmVhdGVkIChtb2NrIHNlcnZpY2UpJ1xuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICAvLyBQcm9kdWN0aW9uIExpZ2h0bmluZyBpbnZvaWNlXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMubWFrZVJlcXVlc3QoJy9saWdodG5pbmcvaW52b2ljZScsICdQT1NUJywge1xuICAgICAgICBhbW91bnQ6IGludm9pY2VEYXRhLmFtb3VudCxcbiAgICAgICAgY3VycmVuY3k6IGludm9pY2VEYXRhLmN1cnJlbmN5LFxuICAgICAgICByZWZlcmVuY2U6IGludm9pY2VEYXRhLnJlZmVyZW5jZSxcbiAgICAgICAgbWVtbzogaW52b2ljZURhdGEubWVtbyB8fCAnU0FDQ08gUGxhdGZvcm0gUGF5bWVudCcsXG4gICAgICAgIGV4cGlyZXNJbjogaW52b2ljZURhdGEuZXhwaXJlc0luIHx8IDM2MDAsIC8vIDEgaG91ciBkZWZhdWx0XG4gICAgICB9KTtcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEludm9pY2UgY3JlYXRpb24gZmFpbGVkOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHBheUxpZ2h0bmluZ0ludm9pY2UoaW52b2ljZTogc3RyaW5nLCB3YWxsZXRJZDogc3RyaW5nKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFVzZSBtb2NrIHNlcnZpY2UgaW4gc2FuZGJveCBlbnZpcm9ubWVudFxuICAgICAgaWYgKHRoaXMuY29uZmlnLmVudmlyb25tZW50ID09PSAnc2FuZGJveCcpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ/CfkrAgVXNpbmcgbW9jayBMaWdodG5pbmcgcGF5bWVudCBzZXJ2aWNlIGluIHNhbmRib3ggbW9kZScpO1xuICAgICAgICBjb25zdCBtb2NrUGF5bWVudCA9IGF3YWl0IHRoaXMubW9ja1NlcnZpY2VzLnNlbmRMaWdodG5pbmdQYXltZW50KGludm9pY2UsIDApO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgZGF0YTogbW9ja1BheW1lbnQsXG4gICAgICAgICAgbWVzc2FnZTogJ0xpZ2h0bmluZyBpbnZvaWNlIHBhaWQgKG1vY2sgc2VydmljZSknXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIFByb2R1Y3Rpb24gTGlnaHRuaW5nIHBheW1lbnRcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5tYWtlUmVxdWVzdCgnL2xpZ2h0bmluZy9wYXknLCAnUE9TVCcsIHtcbiAgICAgICAgaW52b2ljZSxcbiAgICAgICAgd2FsbGV0SWQsXG4gICAgICB9KTtcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEludm9pY2UgcGF5bWVudCBmYWlsZWQ6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG4gICAgfVxuICB9XG5cbiAgLy8gQml0Y29pbiBPbi1DaGFpbiBPcGVyYXRpb25zXG4gIGFzeW5jIHNlbmRCaXRjb2luKHBheW1lbnREYXRhOiBQYXltZW50RGF0YSAmIHsgYWRkcmVzczogc3RyaW5nIH0pIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KCcvYml0Y29pbi9zZW5kJywgJ1BPU1QnLCB7XG4gICAgICAgIGFtb3VudDogcGF5bWVudERhdGEuYW1vdW50LFxuICAgICAgICBhZGRyZXNzOiBwYXltZW50RGF0YS5hZGRyZXNzLFxuICAgICAgICByZWZlcmVuY2U6IHBheW1lbnREYXRhLnJlZmVyZW5jZSxcbiAgICAgICAgbmFycmF0aW9uOiBwYXltZW50RGF0YS5uYXJyYXRpb24gfHwgJ1NBQ0NPIFBsYXRmb3JtIFBheW1lbnQnLFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBCaXRjb2luIHRyYW5zYWN0aW9uIGZhaWxlZDogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZW5lcmF0ZUJpdGNvaW5BZGRyZXNzKHdhbGxldElkOiBzdHJpbmcpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KGAvYml0Y29pbi9hZGRyZXNzLyR7d2FsbGV0SWR9YCwgJ1BPU1QnKTtcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEFkZHJlc3MgZ2VuZXJhdGlvbiBmYWlsZWQ6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG4gICAgfVxuICB9XG5cbiAgLy8gS1lDIE9wZXJhdGlvbnNcbiAgYXN5bmMgc3VibWl0S1lDKGt5Y0RhdGE6IEtZQ0RhdGEpIHtcbiAgICB0cnkge1xuICAgICAgLy8gTm90ZTogRmlsZSB1cGxvYWRzIHdvdWxkIG5lZWQgRm9ybURhdGEgaW5zdGVhZCBvZiBKU09OXG4gICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgICAgT2JqZWN0LmVudHJpZXMoa3ljRGF0YSkuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEZpbGUpIHtcbiAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoa2V5LCB2YWx1ZSk7XG4gICAgICAgIH0gZWxzZSBpZiAodmFsdWUpIHtcbiAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoa2V5LCB2YWx1ZS50b1N0cmluZygpKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IGNyeXB0byA9IHJlcXVpcmUoJ2NyeXB0bycpO1xuICAgICAgY29uc3QgdGltZXN0YW1wID0gRGF0ZS5ub3coKS50b1N0cmluZygpO1xuICAgICAgY29uc3Qgbm9uY2UgPSBjcnlwdG8ucmFuZG9tQnl0ZXMoMTYpLnRvU3RyaW5nKCdoZXgnKTtcbiAgICAgIGNvbnN0IHNpZ25hdHVyZSA9IHRoaXMuZ2VuZXJhdGVTaWduYXR1cmUoJ1BPU1QnLCAnL2t5Yy9zdWJtaXQnLCB0aW1lc3RhbXAsIG5vbmNlKTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmJhc2VVUkx9L2t5Yy9zdWJtaXRgLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ3gtYXV0aC10aW1lc3RhbXAnOiB0aW1lc3RhbXAsXG4gICAgICAgICAgJ3gtYXV0aC1ub25jZSc6IG5vbmNlLFxuICAgICAgICAgICd4LWF1dGgtc2lnbmF0dXJlJzogc2lnbmF0dXJlLFxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBmb3JtRGF0YSxcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKS5jYXRjaCgoKSA9PiAoe30pKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBLWUMgc3VibWlzc2lvbiBmYWlsZWQ6ICR7ZXJyb3JEYXRhLm1lc3NhZ2UgfHwgcmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgcmV0dXJuIHJlc3VsdC5kYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEtZQyBzdWJtaXNzaW9uIGZhaWxlZDogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRLWUNTdGF0dXModXNlcklkOiBzdHJpbmcpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KGAva3ljL3N0YXR1cy8ke3VzZXJJZH1gKTtcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEtZQyBzdGF0dXMgY2hlY2sgZmFpbGVkOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuICAgIH1cbiAgfVxuXG4gIC8vIEN1cnJlbmN5IENvbnZlcnNpb25cbiAgYXN5bmMgY29udmVydEJUQ1RvRmlhdChjb252ZXJzaW9uRGF0YTogQ29udmVyc2lvbkRhdGEpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KCcvY29udmVydCcsICdQT1NUJywge1xuICAgICAgICBhbW91bnQ6IGNvbnZlcnNpb25EYXRhLmFtb3VudCxcbiAgICAgICAgZnJvbUN1cnJlbmN5OiBjb252ZXJzaW9uRGF0YS5mcm9tQ3VycmVuY3ksXG4gICAgICAgIHRvQ3VycmVuY3k6IGNvbnZlcnNpb25EYXRhLnRvQ3VycmVuY3ksXG4gICAgICAgIHJlZmVyZW5jZTogY29udmVyc2lvbkRhdGEucmVmZXJlbmNlLFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb252ZXJzaW9uIGZhaWxlZDogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRFeGNoYW5nZVJhdGVzKGJhc2VDdXJyZW5jeTogc3RyaW5nID0gJ0JUQycpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KGAvcmF0ZXM/YmFzZT0ke2Jhc2VDdXJyZW5jeX1gKTtcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBnZXQgZXhjaGFuZ2UgcmF0ZXM6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG4gICAgfVxuICB9XG5cbiAgLy8gVHJhbnNhY3Rpb24gSGlzdG9yeVxuICBhc3luYyBnZXRUcmFuc2FjdGlvbkhpc3Rvcnkod2FsbGV0SWQ6IHN0cmluZywgbGltaXQ6IG51bWJlciA9IDUwLCBvZmZzZXQ6IG51bWJlciA9IDApIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KFxuICAgICAgICBgL3RyYW5zYWN0aW9ucz93YWxsZXRJZD0ke3dhbGxldElkfSZsaW1pdD0ke2xpbWl0fSZvZmZzZXQ9JHtvZmZzZXR9YFxuICAgICAgKTtcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBnZXQgdHJhbnNhY3Rpb24gaGlzdG9yeTogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRUcmFuc2FjdGlvbkRldGFpbHModHJhbnNhY3Rpb25JZDogc3RyaW5nKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5tYWtlUmVxdWVzdChgL3RyYW5zYWN0aW9ucy8ke3RyYW5zYWN0aW9uSWR9YCk7XG4gICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZ2V0IHRyYW5zYWN0aW9uIGRldGFpbHM6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG4gICAgfVxuICB9XG5cbiAgLy8gV2ViaG9vayB2ZXJpZmljYXRpb24gKGZvciBiYWNrZW5kIHVzZSlcbiAgdmVyaWZ5V2ViaG9va1NpZ25hdHVyZShwYXlsb2FkOiBzdHJpbmcsIHNpZ25hdHVyZTogc3RyaW5nLCBzZWNyZXQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIC8vIEltcGxlbWVudGF0aW9uIHdvdWxkIGRlcGVuZCBvbiBCaXRub2IncyB3ZWJob29rIHNpZ25hdHVyZSBtZXRob2RcbiAgICAvLyBUaGlzIGlzIGEgcGxhY2Vob2xkZXIgZm9yIHRoZSBhY3R1YWwgdmVyaWZpY2F0aW9uIGxvZ2ljXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNyeXB0byA9IHJlcXVpcmUoJ2NyeXB0bycpO1xuICAgICAgY29uc3QgZXhwZWN0ZWRTaWduYXR1cmUgPSBjcnlwdG9cbiAgICAgICAgLmNyZWF0ZUhtYWMoJ3NoYTI1NicsIHNlY3JldClcbiAgICAgICAgLnVwZGF0ZShwYXlsb2FkKVxuICAgICAgICAuZGlnZXN0KCdoZXgnKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIGNyeXB0by50aW1pbmdTYWZlRXF1YWwoXG4gICAgICAgIEJ1ZmZlci5mcm9tKHNpZ25hdHVyZSwgJ2hleCcpLFxuICAgICAgICBCdWZmZXIuZnJvbShleHBlY3RlZFNpZ25hdHVyZSwgJ2hleCcpXG4gICAgICApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdXZWJob29rIHNpZ25hdHVyZSB2ZXJpZmljYXRpb24gZmFpbGVkOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvLyBVU0RUL1N0YWJsZWNvaW4gT3BlcmF0aW9uc1xuICBhc3luYyBzZW5kVVNEVChzdGFibGVjb2luRGF0YTogU3RhYmxlY29pbkRhdGEpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KCcvc3RhYmxlY29pbnMvdXNkdC9zZW5kJywgJ1BPU1QnLCB7XG4gICAgICAgIGFtb3VudDogc3RhYmxlY29pbkRhdGEuYW1vdW50LFxuICAgICAgICBjdXJyZW5jeTogc3RhYmxlY29pbkRhdGEuY3VycmVuY3ksXG4gICAgICAgIHRhcmdldE5ldHdvcms6IHN0YWJsZWNvaW5EYXRhLnRhcmdldE5ldHdvcmssXG4gICAgICAgIHJlY2lwaWVudEFkZHJlc3M6IHN0YWJsZWNvaW5EYXRhLnJlY2lwaWVudEFkZHJlc3MsXG4gICAgICAgIHJlZmVyZW5jZTogc3RhYmxlY29pbkRhdGEucmVmZXJlbmNlLFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBVU0RUIHRyYW5zZmVyIGZhaWxlZDogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBjb252ZXJ0VG9VU0RUKGNvbnZlcnNpb25EYXRhOiBDb252ZXJzaW9uRGF0YSkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMubWFrZVJlcXVlc3QoJy9zdGFibGVjb2lucy9jb252ZXJ0JywgJ1BPU1QnLCB7XG4gICAgICAgIGFtb3VudDogY29udmVyc2lvbkRhdGEuYW1vdW50LFxuICAgICAgICBmcm9tQ3VycmVuY3k6IGNvbnZlcnNpb25EYXRhLmZyb21DdXJyZW5jeSxcbiAgICAgICAgdG9DdXJyZW5jeTogJ1VTRFQnLFxuICAgICAgICByZWZlcmVuY2U6IGNvbnZlcnNpb25EYXRhLnJlZmVyZW5jZSxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVVNEVCBjb252ZXJzaW9uIGZhaWxlZDogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRDcm9zc0JvcmRlclJhdGVzKHNvdXJjZUN1cnJlbmN5OiBzdHJpbmcsIHRhcmdldEN1cnJlbmN5OiBzdHJpbmcsIHJlY2lwaWVudENvdW50cnk6IHN0cmluZykge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMubWFrZVJlcXVlc3QoXG4gICAgICAgIGAvY3Jvc3MtYm9yZGVyL3JhdGVzP3NvdXJjZT0ke3NvdXJjZUN1cnJlbmN5fSZ0YXJnZXQ9JHt0YXJnZXRDdXJyZW5jeX0mY291bnRyeT0ke3JlY2lwaWVudENvdW50cnl9YFxuICAgICAgKTtcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBnZXQgY3Jvc3MtYm9yZGVyIHJhdGVzOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZUNhcmRMaW1pdChjYXJkSWQ6IHN0cmluZywgbmV3TGltaXQ6IG51bWJlcikge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMubWFrZVJlcXVlc3QoYC92aXJ0dWFsLWNhcmRzLyR7Y2FyZElkfS9saW1pdGAsICdQVVQnLCB7XG4gICAgICAgIHNwZW5kaW5nTGltaXQ6IG5ld0xpbWl0LFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gdXBkYXRlIGNhcmQgbGltaXQ6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG4gICAgfVxuICB9XG5cbiAgLy8gQ3Jvc3MtQm9yZGVyIFBheW1lbnQgT3BlcmF0aW9ucyAoRW5oYW5jZWQgd2l0aCBNb2NrIFNlcnZpY2VzKVxuICBhc3luYyBzZW5kQ3Jvc3NCb3JkZXJQYXltZW50KHBheW1lbnREYXRhOiBDcm9zc0JvcmRlclBheW1lbnREYXRhKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFVzZSBtb2NrIHNlcnZpY2UgaW4gc2FuZGJveCBlbnZpcm9ubWVudFxuICAgICAgaWYgKHRoaXMuY29uZmlnLmVudmlyb25tZW50ID09PSAnc2FuZGJveCcpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ/CfjI0gVXNpbmcgbW9jayBjcm9zcy1ib3JkZXIgc2VydmljZSBpbiBzYW5kYm94IG1vZGUnKTtcbiAgICAgICAgY29uc3QgbW9ja1RyYW5zZmVyID0gYXdhaXQgdGhpcy5tb2NrU2VydmljZXMuaW5pdGlhdGVDcm9zc0JvcmRlclRyYW5zZmVyKFxuICAgICAgICAgIHBheW1lbnREYXRhLmFtb3VudCxcbiAgICAgICAgICBwYXltZW50RGF0YS50YXJnZXRDdXJyZW5jeSxcbiAgICAgICAgICBwYXltZW50RGF0YS5yZWNpcGllbnRDb3VudHJ5XG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBkYXRhOiBtb2NrVHJhbnNmZXIsXG4gICAgICAgICAgbWVzc2FnZTogJ0Nyb3NzLWJvcmRlciBwYXltZW50IGluaXRpYXRlZCAobW9jayBzZXJ2aWNlKSdcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gUHJvZHVjdGlvbiBjcm9zcy1ib3JkZXIgcGF5bWVudFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KCcvY3Jvc3MtYm9yZGVyL3NlbmQnLCAnUE9TVCcsIHBheW1lbnREYXRhKTtcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYENyb3NzLWJvcmRlciBwYXltZW50IGZhaWxlZDogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRDcm9zc0JvcmRlclRyYW5zZmVycygpIHtcbiAgICB0cnkge1xuICAgICAgLy8gVXNlIG1vY2sgc2VydmljZSBpbiBzYW5kYm94IGVudmlyb25tZW50XG4gICAgICBpZiAodGhpcy5jb25maWcuZW52aXJvbm1lbnQgPT09ICdzYW5kYm94Jykge1xuICAgICAgICBjb25zb2xlLmxvZygn8J+TiyBVc2luZyBtb2NrIGNyb3NzLWJvcmRlciBoaXN0b3J5IGluIHNhbmRib3ggbW9kZScpO1xuICAgICAgICBjb25zdCBtb2NrVHJhbnNmZXJzID0gYXdhaXQgdGhpcy5tb2NrU2VydmljZXMuZ2V0Q3Jvc3NCb3JkZXJUcmFuc2ZlcnMoKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGRhdGE6IG1vY2tUcmFuc2ZlcnMsXG4gICAgICAgICAgbWVzc2FnZTogJ0Nyb3NzLWJvcmRlciB0cmFuc2ZlcnMgcmV0cmlldmVkIChtb2NrIHNlcnZpY2UpJ1xuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICAvLyBQcm9kdWN0aW9uIGNyb3NzLWJvcmRlciBoaXN0b3J5XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMubWFrZVJlcXVlc3QoJy9jcm9zcy1ib3JkZXIvdHJhbnNmZXJzJyk7XG4gICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZ2V0IGNyb3NzLWJvcmRlciB0cmFuc2ZlcnM6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG4gICAgfVxuICB9XG5cbiAgLy8gVmlydHVhbCBDYXJkIE9wZXJhdGlvbnMgKEVuaGFuY2VkIHdpdGggTW9jayBTZXJ2aWNlcylcbiAgYXN5bmMgY3JlYXRlVmlydHVhbENhcmQoY2FyZERhdGE6IFZpcnR1YWxDYXJkRGF0YSkge1xuICAgIHRyeSB7XG4gICAgICAvLyBVc2UgbW9jayBzZXJ2aWNlIGluIHNhbmRib3ggZW52aXJvbm1lbnRcbiAgICAgIGlmICh0aGlzLmNvbmZpZy5lbnZpcm9ubWVudCA9PT0gJ3NhbmRib3gnKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5KzIFVzaW5nIG1vY2sgdmlydHVhbCBjYXJkIHNlcnZpY2UgaW4gc2FuZGJveCBtb2RlJyk7XG4gICAgICAgIGNvbnN0IG1vY2tDYXJkID0gYXdhaXQgdGhpcy5tb2NrU2VydmljZXMuY3JlYXRlVmlydHVhbENhcmQoJ3Zpc2EnKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGRhdGE6IG1vY2tDYXJkLFxuICAgICAgICAgIG1lc3NhZ2U6ICdWaXJ0dWFsIGNhcmQgY3JlYXRlZCAobW9jayBzZXJ2aWNlKSdcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gUHJvZHVjdGlvbiB2aXJ0dWFsIGNhcmQgY3JlYXRpb25cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5tYWtlUmVxdWVzdCgnL3ZpcnR1YWwtY2FyZHMnLCAnUE9TVCcsIGNhcmREYXRhKTtcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFZpcnR1YWwgY2FyZCBjcmVhdGlvbiBmYWlsZWQ6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0VmlydHVhbENhcmRzKHVzZXJJZD86IHN0cmluZykge1xuICAgIHRyeSB7XG4gICAgICAvLyBVc2UgbW9jayBzZXJ2aWNlIGluIHNhbmRib3ggZW52aXJvbm1lbnRcbiAgICAgIGlmICh0aGlzLmNvbmZpZy5lbnZpcm9ubWVudCA9PT0gJ3NhbmRib3gnKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5eC77iPIFVzaW5nIG1vY2sgdmlydHVhbCBjYXJkIGxpc3QgaW4gc2FuZGJveCBtb2RlJyk7XG4gICAgICAgIGNvbnN0IG1vY2tDYXJkcyA9IGF3YWl0IHRoaXMubW9ja1NlcnZpY2VzLmdldFZpcnR1YWxDYXJkcygpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgZGF0YTogbW9ja0NhcmRzLFxuICAgICAgICAgIG1lc3NhZ2U6ICdWaXJ0dWFsIGNhcmRzIHJldHJpZXZlZCAobW9jayBzZXJ2aWNlKSdcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gUHJvZHVjdGlvbiB2aXJ0dWFsIGNhcmRzXG4gICAgICBjb25zdCBlbmRwb2ludCA9IHVzZXJJZCA/IGAvdmlydHVhbC1jYXJkcy91c2VyLyR7dXNlcklkfWAgOiAnL3ZpcnR1YWwtY2FyZHMnO1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KGVuZHBvaW50KTtcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBnZXQgdmlydHVhbCBjYXJkczogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBmdW5kVmlydHVhbENhcmQoY2FyZElkOiBzdHJpbmcsIGFtb3VudDogbnVtYmVyKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFVzZSBtb2NrIHNlcnZpY2UgaW4gc2FuZGJveCBlbnZpcm9ubWVudFxuICAgICAgaWYgKHRoaXMuY29uZmlnLmVudmlyb25tZW50ID09PSAnc2FuZGJveCcpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ/CfkrAgVXNpbmcgbW9jayBjYXJkIGZ1bmRpbmcgaW4gc2FuZGJveCBtb2RlJyk7XG4gICAgICAgIGNvbnN0IHN1Y2Nlc3MgPSBhd2FpdCB0aGlzLm1vY2tTZXJ2aWNlcy5mdW5kVmlydHVhbENhcmQoY2FyZElkLCBhbW91bnQpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3MsXG4gICAgICAgICAgbWVzc2FnZTogYFZpcnR1YWwgY2FyZCAke3N1Y2Nlc3MgPyAnZnVuZGVkJyA6ICdmdW5kaW5nIGZhaWxlZCd9IChtb2NrIHNlcnZpY2UpYFxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICAvLyBQcm9kdWN0aW9uIGNhcmQgZnVuZGluZ1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KGAvdmlydHVhbC1jYXJkcy8ke2NhcmRJZH0vZnVuZGAsICdQT1NUJywgeyBhbW91bnQgfSk7XG4gICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZnVuZCBjYXJkOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGZyZWV6ZUNhcmQoY2FyZElkOiBzdHJpbmcpIHtcbiAgICB0cnkge1xuICAgICAgLy8gVXNlIG1vY2sgc2VydmljZSBpbiBzYW5kYm94IGVudmlyb25tZW50XG4gICAgICBpZiAodGhpcy5jb25maWcuZW52aXJvbm1lbnQgPT09ICdzYW5kYm94Jykge1xuICAgICAgICBjb25zb2xlLmxvZygn8J+niiBVc2luZyBtb2NrIGNhcmQgZnJlZXplIGluIHNhbmRib3ggbW9kZScpO1xuICAgICAgICBjb25zdCBzdWNjZXNzID0gYXdhaXQgdGhpcy5tb2NrU2VydmljZXMuZnJlZXplVmlydHVhbENhcmQoY2FyZElkKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzLFxuICAgICAgICAgIG1lc3NhZ2U6IGBWaXJ0dWFsIGNhcmQgJHtzdWNjZXNzID8gJ2Zyb3plbicgOiAnZnJlZXplIGZhaWxlZCd9IChtb2NrIHNlcnZpY2UpYFxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICAvLyBQcm9kdWN0aW9uIGNhcmQgZnJlZXplXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMubWFrZVJlcXVlc3QoYC92aXJ0dWFsLWNhcmRzLyR7Y2FyZElkfS9mcmVlemVgLCAnUE9TVCcpO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGZyZWV6ZSBjYXJkOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHVuZnJlZXplQ2FyZChjYXJkSWQ6IHN0cmluZykge1xuICAgIHRyeSB7XG4gICAgICAvLyBVc2UgbW9jayBzZXJ2aWNlIGluIHNhbmRib3ggZW52aXJvbm1lbnRcbiAgICAgIGlmICh0aGlzLmNvbmZpZy5lbnZpcm9ubWVudCA9PT0gJ3NhbmRib3gnKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5SlIE1vY2sgY2FyZCB1bmZyZWV6ZSBub3QgaW1wbGVtZW50ZWQgLSB1c2luZyBwcm9kdWN0aW9uIGVuZHBvaW50Jyk7XG4gICAgICB9XG5cbiAgICAgIC8vIFByb2R1Y3Rpb24gY2FyZCB1bmZyZWV6ZVxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KGAvdmlydHVhbC1jYXJkcy8ke2NhcmRJZH0vdW5mcmVlemVgLCAnUE9TVCcpO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIHVuZnJlZXplIGNhcmQ6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG4gICAgfVxuICB9XG5cbiAgLy8gVVNEVC9TdGFibGVjb2luIE9wZXJhdGlvbnNcbiAgYXN5bmMgYnV5U3RhYmxlY29pbihzdGFibGVjb2luRGF0YTogU3RhYmxlY29pbkRhdGEpIHtcbiAgICB0cnkge1xuICAgICAgLy8gVXNlIG1vY2sgc2VydmljZSBpbiBzYW5kYm94IGVudmlyb25tZW50XG4gICAgICBpZiAodGhpcy5jb25maWcuZW52aXJvbm1lbnQgPT09ICdzYW5kYm94Jykge1xuICAgICAgICBjb25zb2xlLmxvZygn8J+qmSBVc2luZyBtb2NrIFVTRFQgYnV5IHNlcnZpY2UgaW4gc2FuZGJveCBtb2RlJyk7XG4gICAgICAgIGNvbnN0IG1vY2tPcGVyYXRpb24gPSBhd2FpdCB0aGlzLm1vY2tTZXJ2aWNlcy5idXlVU0RUKHN0YWJsZWNvaW5EYXRhLmFtb3VudCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBkYXRhOiBtb2NrT3BlcmF0aW9uLFxuICAgICAgICAgIG1lc3NhZ2U6ICdVU0RUIHB1cmNoYXNlZCAobW9jayBzZXJ2aWNlKSdcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gUHJvZHVjdGlvbiBzdGFibGVjb2luIHB1cmNoYXNlXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMubWFrZVJlcXVlc3QoJy9zdGFibGVjb2lucy9idXknLCAnUE9TVCcsIHN0YWJsZWNvaW5EYXRhKTtcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFN0YWJsZWNvaW4gcHVyY2hhc2UgZmFpbGVkOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHNlbGxTdGFibGVjb2luKHN0YWJsZWNvaW5EYXRhOiBTdGFibGVjb2luRGF0YSkge1xuICAgIHRyeSB7XG4gICAgICAvLyBVc2UgbW9jayBzZXJ2aWNlIGluIHNhbmRib3ggZW52aXJvbm1lbnRcbiAgICAgIGlmICh0aGlzLmNvbmZpZy5lbnZpcm9ubWVudCA9PT0gJ3NhbmRib3gnKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5KxIFVzaW5nIG1vY2sgVVNEVCBzZWxsIHNlcnZpY2UgaW4gc2FuZGJveCBtb2RlJyk7XG4gICAgICAgIGNvbnN0IG1vY2tPcGVyYXRpb24gPSBhd2FpdCB0aGlzLm1vY2tTZXJ2aWNlcy5zZWxsVVNEVChzdGFibGVjb2luRGF0YS5hbW91bnQpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgZGF0YTogbW9ja09wZXJhdGlvbixcbiAgICAgICAgICBtZXNzYWdlOiAnVVNEVCBzb2xkIChtb2NrIHNlcnZpY2UpJ1xuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICAvLyBQcm9kdWN0aW9uIHN0YWJsZWNvaW4gc2FsZVxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KCcvc3RhYmxlY29pbnMvc2VsbCcsICdQT1NUJywgc3RhYmxlY29pbkRhdGEpO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgU3RhYmxlY29pbiBzYWxlIGZhaWxlZDogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyB0cmFuc2ZlclN0YWJsZWNvaW4oc3RhYmxlY29pbkRhdGE6IFN0YWJsZWNvaW5EYXRhKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFVzZSBtb2NrIHNlcnZpY2UgaW4gc2FuZGJveCBlbnZpcm9ubWVudFxuICAgICAgaWYgKHRoaXMuY29uZmlnLmVudmlyb25tZW50ID09PSAnc2FuZGJveCcpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ/CflIQgVXNpbmcgbW9jayBVU0RUIHRyYW5zZmVyIHNlcnZpY2UgaW4gc2FuZGJveCBtb2RlJyk7XG4gICAgICAgIGNvbnN0IG1vY2tPcGVyYXRpb24gPSBhd2FpdCB0aGlzLm1vY2tTZXJ2aWNlcy50cmFuc2ZlclVTRFQoXG4gICAgICAgICAgc3RhYmxlY29pbkRhdGEuYW1vdW50LCBcbiAgICAgICAgICBzdGFibGVjb2luRGF0YS5yZWNpcGllbnRBZGRyZXNzIHx8ICdtb2NrLXJlY2lwaWVudCdcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGRhdGE6IG1vY2tPcGVyYXRpb24sXG4gICAgICAgICAgbWVzc2FnZTogJ1VTRFQgdHJhbnNmZXJyZWQgKG1vY2sgc2VydmljZSknXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIFByb2R1Y3Rpb24gc3RhYmxlY29pbiB0cmFuc2ZlclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KCcvc3RhYmxlY29pbnMvdHJhbnNmZXInLCAnUE9TVCcsIHN0YWJsZWNvaW5EYXRhKTtcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFN0YWJsZWNvaW4gdHJhbnNmZXIgZmFpbGVkOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdldFN0YWJsZWNvaW5PcGVyYXRpb25zKCkge1xuICAgIHRyeSB7XG4gICAgICAvLyBVc2UgbW9jayBzZXJ2aWNlIGluIHNhbmRib3ggZW52aXJvbm1lbnRcbiAgICAgIGlmICh0aGlzLmNvbmZpZy5lbnZpcm9ubWVudCA9PT0gJ3NhbmRib3gnKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5OKIFVzaW5nIG1vY2sgVVNEVCBvcGVyYXRpb25zIGluIHNhbmRib3ggbW9kZScpO1xuICAgICAgICBjb25zdCBtb2NrT3BlcmF0aW9ucyA9IGF3YWl0IHRoaXMubW9ja1NlcnZpY2VzLmdldFVTRFRPcGVyYXRpb25zKCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBkYXRhOiBtb2NrT3BlcmF0aW9ucyxcbiAgICAgICAgICBtZXNzYWdlOiAnVVNEVCBvcGVyYXRpb25zIHJldHJpZXZlZCAobW9jayBzZXJ2aWNlKSdcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gUHJvZHVjdGlvbiBzdGFibGVjb2luIG9wZXJhdGlvbnNcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5tYWtlUmVxdWVzdCgnL3N0YWJsZWNvaW5zL29wZXJhdGlvbnMnKTtcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBnZXQgc3RhYmxlY29pbiBvcGVyYXRpb25zOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuICAgIH1cbiAgfVxuXG4gIC8vIEhlYWx0aCBjaGVja1xuICBhc3luYyBoZWFsdGhDaGVjaygpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KCcvaGVhbHRoJyk7XG4gICAgICByZXR1cm4gcmVzcG9uc2U7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgSGVhbHRoIGNoZWNrIGZhaWxlZDogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcbiAgICB9XG4gIH1cbn1cblxuLy8gU2luZ2xldG9uIGluc3RhbmNlIGZvciBmcm9udGVuZCB1c2VcbmxldCBiaXRub2JTZXJ2aWNlSW5zdGFuY2U6IEJpdG5vYlNlcnZpY2UgfCBudWxsID0gbnVsbDtcblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUJpdG5vYlNlcnZpY2UoKTogQml0bm9iU2VydmljZSB7XG4gIGlmIChiaXRub2JTZXJ2aWNlSW5zdGFuY2UpIHtcbiAgICByZXR1cm4gYml0bm9iU2VydmljZUluc3RhbmNlO1xuICB9XG5cbiAgLy8gR2V0IGNvbmZpZ3VyYXRpb24gZnJvbSBlbnZpcm9ubWVudCB2YXJpYWJsZXNcbiAgY29uc3Qgc2VjcmV0S2V5ID0gcHJvY2Vzcy5lbnYuQklUTk9CX1NFQ1JFVF9LRVkgfHwgJyc7XG4gIGNvbnN0IGJhc2VVUkwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19CSVROT0JfQkFTRV9VUkwgfHwgcHJvY2Vzcy5lbnYuQklUTk9CX0JBU0VfVVJMIHx8ICdodHRwczovL3NhbmRib3hhcGkuYml0bm9iLmNvbS9hcGkvdjEnO1xuXG4gIGNvbnN0IHNlcnZpY2VDb25maWc6IEJpdG5vYkNvbmZpZyA9IHtcbiAgICBzZWNyZXRLZXksXG4gICAgZW52aXJvbm1lbnQ6IGJhc2VVUkwuaW5jbHVkZXMoJ3NhbmRib3gnKSA/ICdzYW5kYm94JyA6ICdwcm9kdWN0aW9uJyxcbiAgICBiYXNlVVJMOiBiYXNlVVJMLFxuICB9O1xuXG4gIC8vIFdhcm4gaWYgY3JlZGVudGlhbHMgYXJlIG1pc3NpbmdcbiAgaWYgKCFzZWNyZXRLZXkpIHtcbiAgICBjb25zb2xlLndhcm4oJ0JpdG5vYiBjcmVkZW50aWFscyBub3QgY29uZmlndXJlZC4gQml0Y29pbiB3YWxsZXQgZmVhdHVyZXMgd2lsbCBiZSBkaXNhYmxlZC4nKTtcbiAgfVxuXG4gIGJpdG5vYlNlcnZpY2VJbnN0YW5jZSA9IG5ldyBCaXRub2JTZXJ2aWNlKHNlcnZpY2VDb25maWcpO1xuXG4gIHJldHVybiBiaXRub2JTZXJ2aWNlSW5zdGFuY2U7XG59XG5cbi8vIERlZmF1bHQgZXhwb3J0IGZvciBjb252ZW5pZW5jZVxuZXhwb3J0IGNvbnN0IGJpdG5vYlNlcnZpY2UgPSBjcmVhdGVCaXRub2JTZXJ2aWNlKCk7XG4iXSwibmFtZXMiOlsiTW9ja0JpdG5vYlNlcnZpY2VzIiwiQml0bm9iU2VydmljZSIsImNvbmZpZyIsImJhc2VVUkwiLCJlbnZpcm9ubWVudCIsIm1vY2tTZXJ2aWNlcyIsImdldEluc3RhbmNlIiwiZ2VuZXJhdGVTaWduYXR1cmUiLCJtZXRob2QiLCJwYXRoIiwidGltZXN0YW1wIiwibm9uY2UiLCJib2R5IiwiY3J5cHRvIiwicmVxdWlyZSIsIm1lc3NhZ2UiLCJjcmVhdGVIbWFjIiwic2VjcmV0S2V5IiwidXBkYXRlIiwiZGlnZXN0IiwibWFrZVJlcXVlc3QiLCJlbmRwb2ludCIsImRhdGEiLCJEYXRlIiwibm93IiwidG9TdHJpbmciLCJyYW5kb21CeXRlcyIsIkpTT04iLCJzdHJpbmdpZnkiLCJzaWduYXR1cmUiLCJjb250cm9sbGVyIiwiQWJvcnRDb250cm9sbGVyIiwidGltZW91dElkIiwic2V0VGltZW91dCIsImFib3J0IiwicmVzcG9uc2UiLCJmZXRjaCIsImhlYWRlcnMiLCJ1bmRlZmluZWQiLCJzaWduYWwiLCJjbGVhclRpbWVvdXQiLCJvayIsImVycm9yRGF0YSIsImpzb24iLCJjYXRjaCIsIkVycm9yIiwic3RhdHVzIiwic3RhdHVzVGV4dCIsImVycm9yIiwiY29uc29sZSIsImluY2x1ZGVzIiwibmFtZSIsImlzU2VydmljZUF2YWlsYWJsZSIsIndhcm4iLCJzdGF0dXNDb2RlIiwiZ2V0QXZhaWxhYmxlRmVhdHVyZXMiLCJ3YWxsZXRzIiwidHJhbnNhY3Rpb25zIiwibGlnaHRuaW5nIiwiY3Jvc3NCb3JkZXIiLCJ2aXJ0dWFsQ2FyZHMiLCJzdGFibGVjb2lucyIsInRlc3RFbmRwb2ludHMiLCJlbmRwb2ludHMiLCJyZXN1bHRzIiwiY3JlYXRlV2FsbGV0IiwidXNlckRhdGEiLCJwaG9uZU51bWJlciIsImVtYWlsIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJkYXRlT2ZCaXJ0aCIsImFkZHJlc3MiLCJnZXRXYWxsZXREZXRhaWxzIiwid2FsbGV0SWQiLCJnZXRXYWxsZXRCYWxhbmNlIiwic2VuZExpZ2h0bmluZ1BheW1lbnQiLCJwYXltZW50RGF0YSIsImxvZyIsIm1vY2tQYXltZW50IiwiYW1vdW50Iiwic3VjY2VzcyIsImNyZWF0ZUxpZ2h0bmluZ0ludm9pY2UiLCJpbnZvaWNlRGF0YSIsIm1vY2tJbnZvaWNlIiwibWVtbyIsImN1cnJlbmN5IiwicmVmZXJlbmNlIiwiZXhwaXJlc0luIiwicGF5TGlnaHRuaW5nSW52b2ljZSIsImludm9pY2UiLCJzZW5kQml0Y29pbiIsIm5hcnJhdGlvbiIsImdlbmVyYXRlQml0Y29pbkFkZHJlc3MiLCJzdWJtaXRLWUMiLCJreWNEYXRhIiwiZm9ybURhdGEiLCJGb3JtRGF0YSIsIk9iamVjdCIsImVudHJpZXMiLCJmb3JFYWNoIiwia2V5IiwidmFsdWUiLCJGaWxlIiwiYXBwZW5kIiwicmVzdWx0IiwiZ2V0S1lDU3RhdHVzIiwidXNlcklkIiwiY29udmVydEJUQ1RvRmlhdCIsImNvbnZlcnNpb25EYXRhIiwiZnJvbUN1cnJlbmN5IiwidG9DdXJyZW5jeSIsImdldEV4Y2hhbmdlUmF0ZXMiLCJiYXNlQ3VycmVuY3kiLCJnZXRUcmFuc2FjdGlvbkhpc3RvcnkiLCJsaW1pdCIsIm9mZnNldCIsImdldFRyYW5zYWN0aW9uRGV0YWlscyIsInRyYW5zYWN0aW9uSWQiLCJ2ZXJpZnlXZWJob29rU2lnbmF0dXJlIiwicGF5bG9hZCIsInNlY3JldCIsImV4cGVjdGVkU2lnbmF0dXJlIiwidGltaW5nU2FmZUVxdWFsIiwiQnVmZmVyIiwiZnJvbSIsInNlbmRVU0RUIiwic3RhYmxlY29pbkRhdGEiLCJ0YXJnZXROZXR3b3JrIiwicmVjaXBpZW50QWRkcmVzcyIsImNvbnZlcnRUb1VTRFQiLCJnZXRDcm9zc0JvcmRlclJhdGVzIiwic291cmNlQ3VycmVuY3kiLCJ0YXJnZXRDdXJyZW5jeSIsInJlY2lwaWVudENvdW50cnkiLCJ1cGRhdGVDYXJkTGltaXQiLCJjYXJkSWQiLCJuZXdMaW1pdCIsInNwZW5kaW5nTGltaXQiLCJzZW5kQ3Jvc3NCb3JkZXJQYXltZW50IiwibW9ja1RyYW5zZmVyIiwiaW5pdGlhdGVDcm9zc0JvcmRlclRyYW5zZmVyIiwiZ2V0Q3Jvc3NCb3JkZXJUcmFuc2ZlcnMiLCJtb2NrVHJhbnNmZXJzIiwiY3JlYXRlVmlydHVhbENhcmQiLCJjYXJkRGF0YSIsIm1vY2tDYXJkIiwiZ2V0VmlydHVhbENhcmRzIiwibW9ja0NhcmRzIiwiZnVuZFZpcnR1YWxDYXJkIiwiZnJlZXplQ2FyZCIsImZyZWV6ZVZpcnR1YWxDYXJkIiwidW5mcmVlemVDYXJkIiwiYnV5U3RhYmxlY29pbiIsIm1vY2tPcGVyYXRpb24iLCJidXlVU0RUIiwic2VsbFN0YWJsZWNvaW4iLCJzZWxsVVNEVCIsInRyYW5zZmVyU3RhYmxlY29pbiIsInRyYW5zZmVyVVNEVCIsImdldFN0YWJsZWNvaW5PcGVyYXRpb25zIiwibW9ja09wZXJhdGlvbnMiLCJnZXRVU0RUT3BlcmF0aW9ucyIsImhlYWx0aENoZWNrIiwiYml0bm9iU2VydmljZUluc3RhbmNlIiwiY3JlYXRlQml0bm9iU2VydmljZSIsInByb2Nlc3MiLCJlbnYiLCJCSVROT0JfU0VDUkVUX0tFWSIsIk5FWFRfUFVCTElDX0JJVE5PQl9CQVNFX1VSTCIsIkJJVE5PQl9CQVNFX1VSTCIsInNlcnZpY2VDb25maWciLCJiaXRub2JTZXJ2aWNlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/services/bitnob.service.ts\n");

/***/ }),

/***/ "(rsc)/./src/services/mock-bitnob.service.ts":
/*!*********************************************!*\
  !*** ./src/services/mock-bitnob.service.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MockBitnobServices: () => (/* binding */ MockBitnobServices),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n// Mock services for features not available in Bitnob Sandbox\n/**\n * Mock Services for features not available in Bitnob Sandbox\n * These provide realistic simulations for development and testing\n */ class MockBitnobServices {\n    constructor(){\n        this.lightningPayments = [];\n        this.crossBorderTransfers = [];\n        this.virtualCards = [];\n        this.usdtOperations = [];\n    }\n    static getInstance() {\n        if (!MockBitnobServices.instance) {\n            MockBitnobServices.instance = new MockBitnobServices();\n        }\n        return MockBitnobServices.instance;\n    }\n    // Lightning Network Mock Services\n    async createLightningInvoice(amount, description) {\n        const invoice = {\n            id: `ln_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            amount,\n            status: 'pending',\n            invoice: `lnbc${amount}n1p${Math.random().toString(36).substr(2, 20)}`,\n            timestamp: new Date().toISOString()\n        };\n        this.lightningPayments.push(invoice);\n        // Simulate processing after 2 seconds\n        setTimeout(()=>{\n            invoice.status = Math.random() > 0.1 ? 'completed' : 'failed';\n        }, 2000);\n        return invoice;\n    }\n    async sendLightningPayment(invoice, amount) {\n        const payment = {\n            id: `ln_pay_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            amount,\n            status: 'pending',\n            timestamp: new Date().toISOString()\n        };\n        this.lightningPayments.push(payment);\n        // Simulate processing\n        setTimeout(()=>{\n            payment.status = Math.random() > 0.15 ? 'completed' : 'failed';\n        }, 3000);\n        return payment;\n    }\n    async getLightningPayments() {\n        return this.lightningPayments;\n    }\n    // Cross-Border Transfer Mock Services\n    async initiateCrossBorderTransfer(amount, currency, recipientCountry) {\n        const exchangeRates = {\n            'USD': 1.0,\n            'NGN': 750,\n            'KES': 130,\n            'GHS': 12,\n            'EUR': 0.85,\n            'GBP': 0.75\n        };\n        const transfer = {\n            id: `cb_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            amount,\n            currency,\n            recipientCountry,\n            status: 'processing',\n            exchangeRate: exchangeRates[currency] || 1.0,\n            timestamp: new Date().toISOString()\n        };\n        this.crossBorderTransfers.push(transfer);\n        // Simulate processing time (5-10 seconds for cross-border)\n        setTimeout(()=>{\n            transfer.status = Math.random() > 0.05 ? 'completed' : 'failed';\n        }, Math.random() * 5000 + 5000);\n        return transfer;\n    }\n    async getCrossBorderTransfers() {\n        return this.crossBorderTransfers;\n    }\n    // Virtual Card Mock Services\n    async createVirtualCard(type = 'visa') {\n        const card = {\n            id: `card_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            cardNumber: this.generateCardNumber(type),\n            expiryDate: this.generateExpiryDate(),\n            status: 'active',\n            balance: 0,\n            type\n        };\n        this.virtualCards.push(card);\n        return card;\n    }\n    async fundVirtualCard(cardId, amount) {\n        const card = this.virtualCards.find((c)=>c.id === cardId);\n        if (card) {\n            card.balance += amount;\n            return true;\n        }\n        return false;\n    }\n    async getVirtualCards() {\n        return this.virtualCards;\n    }\n    async freezeVirtualCard(cardId) {\n        const card = this.virtualCards.find((c)=>c.id === cardId);\n        if (card) {\n            card.status = 'blocked';\n            return true;\n        }\n        return false;\n    }\n    // USDT/Stablecoin Mock Services\n    async buyUSDT(amount) {\n        const operation = {\n            id: `usdt_buy_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            amount,\n            type: 'buy',\n            status: 'pending',\n            rate: 1.0 + (Math.random() - 0.5) * 0.02,\n            timestamp: new Date().toISOString()\n        };\n        this.usdtOperations.push(operation);\n        setTimeout(()=>{\n            operation.status = Math.random() > 0.05 ? 'completed' : 'failed';\n        }, 2000);\n        return operation;\n    }\n    async sellUSDT(amount) {\n        const operation = {\n            id: `usdt_sell_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            amount,\n            type: 'sell',\n            status: 'pending',\n            rate: 1.0 + (Math.random() - 0.5) * 0.02,\n            timestamp: new Date().toISOString()\n        };\n        this.usdtOperations.push(operation);\n        setTimeout(()=>{\n            operation.status = Math.random() > 0.05 ? 'completed' : 'failed';\n        }, 2000);\n        return operation;\n    }\n    async transferUSDT(amount, recipient) {\n        const operation = {\n            id: `usdt_transfer_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            amount,\n            type: 'transfer',\n            status: 'pending',\n            rate: 1.0,\n            timestamp: new Date().toISOString()\n        };\n        this.usdtOperations.push(operation);\n        setTimeout(()=>{\n            operation.status = Math.random() > 0.1 ? 'completed' : 'failed';\n        }, 1500);\n        return operation;\n    }\n    async getUSDTOperations() {\n        return this.usdtOperations;\n    }\n    // Helper methods\n    generateCardNumber(type) {\n        const prefix = type === 'visa' ? '4' : '5';\n        let cardNumber = prefix;\n        for(let i = 1; i < 16; i++){\n            cardNumber += Math.floor(Math.random() * 10);\n        }\n        return cardNumber.replace(/(.{4})/g, '$1 ').trim();\n    }\n    generateExpiryDate() {\n        const currentDate = new Date();\n        const expiryDate = new Date(currentDate.getFullYear() + 3, currentDate.getMonth() + Math.floor(Math.random() * 12));\n        return `${(expiryDate.getMonth() + 1).toString().padStart(2, '0')}/${expiryDate.getFullYear().toString().substr(2)}`;\n    }\n    // Development utilities\n    async clearAllMockData() {\n        this.lightningPayments = [];\n        this.crossBorderTransfers = [];\n        this.virtualCards = [];\n        this.usdtOperations = [];\n    }\n    async generateTestData() {\n        // Generate some test Lightning payments\n        await this.createLightningInvoice(50000, 'Test Invoice 1');\n        await this.createLightningInvoice(25000, 'Test Invoice 2');\n        // Generate test cross-border transfers\n        await this.initiateCrossBorderTransfer(100, 'NGN', 'Nigeria');\n        await this.initiateCrossBorderTransfer(50, 'KES', 'Kenya');\n        // Generate test virtual cards\n        await this.createVirtualCard('visa');\n        await this.createVirtualCard('mastercard');\n        // Generate test USDT operations\n        await this.buyUSDT(100);\n        await this.sellUSDT(50);\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (MockBitnobServices);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvc2VydmljZXMvbW9jay1iaXRub2Iuc2VydmljZS50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLDZEQUE2RDtBQXNDN0Q7OztDQUdDLEdBQ00sTUFBTUE7SUFPWCxhQUFzQjthQUxkQyxvQkFBNEMsRUFBRTthQUM5Q0MsdUJBQWtELEVBQUU7YUFDcERDLGVBQWtDLEVBQUU7YUFDcENDLGlCQUFzQyxFQUFFO0lBRXpCO0lBRXZCLE9BQU9DLGNBQWtDO1FBQ3ZDLElBQUksQ0FBQ0wsbUJBQW1CTSxRQUFRLEVBQUU7WUFDaENOLG1CQUFtQk0sUUFBUSxHQUFHLElBQUlOO1FBQ3BDO1FBQ0EsT0FBT0EsbUJBQW1CTSxRQUFRO0lBQ3BDO0lBRUEsa0NBQWtDO0lBQ2xDLE1BQU1DLHVCQUF1QkMsTUFBYyxFQUFFQyxXQUFtQixFQUFpQztRQUMvRixNQUFNQyxVQUFnQztZQUNwQ0MsSUFBSSxDQUFDLEdBQUcsRUFBRUMsS0FBS0MsR0FBRyxHQUFHLENBQUMsRUFBRUMsS0FBS0MsTUFBTSxHQUFHQyxRQUFRLENBQUMsSUFBSUMsTUFBTSxDQUFDLEdBQUcsSUFBSTtZQUNqRVQ7WUFDQVUsUUFBUTtZQUNSUixTQUFTLENBQUMsSUFBSSxFQUFFRixPQUFPLEdBQUcsRUFBRU0sS0FBS0MsTUFBTSxHQUFHQyxRQUFRLENBQUMsSUFBSUMsTUFBTSxDQUFDLEdBQUcsS0FBSztZQUN0RUUsV0FBVyxJQUFJUCxPQUFPUSxXQUFXO1FBQ25DO1FBRUEsSUFBSSxDQUFDbkIsaUJBQWlCLENBQUNvQixJQUFJLENBQUNYO1FBRTVCLHNDQUFzQztRQUN0Q1ksV0FBVztZQUNUWixRQUFRUSxNQUFNLEdBQUdKLEtBQUtDLE1BQU0sS0FBSyxNQUFNLGNBQWM7UUFDdkQsR0FBRztRQUVILE9BQU9MO0lBQ1Q7SUFFQSxNQUFNYSxxQkFBcUJiLE9BQWUsRUFBRUYsTUFBYyxFQUFpQztRQUN6RixNQUFNZ0IsVUFBZ0M7WUFDcENiLElBQUksQ0FBQyxPQUFPLEVBQUVDLEtBQUtDLEdB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WUFBWSxHQUFHLEVBQUU7UUFDdEIsSUFBSSxDQUFDQyxjQUFjLEdBQUcsRUFBRTtJQUMxQjtJQUVBLE1BQU00RCxtQkFBa0M7UUFDdEMsd0NBQXdDO1FBQ3hDLE1BQU0sSUFBSSxDQUFDekQsc0JBQXNCLENBQUMsT0FBTztRQUN6QyxNQUFNLElBQUksQ0FBQ0Esc0JBQXNCLENBQUMsT0FBTztRQUV6Qyx1Q0FBdUM7UUFDdkMsTUFBTSxJQUFJLENBQUNtQiwyQkFBMkIsQ0FBQyxLQUFLLE9BQU87UUFDbkQsTUFBTSxJQUFJLENBQUNBLDJCQUEyQixDQUFDLElBQUksT0FBTztRQUVsRCw4QkFBOEI7UUFDOUIsTUFBTSxJQUFJLENBQUNPLGlCQUFpQixDQUFDO1FBQzdCLE1BQU0sSUFBSSxDQUFDQSxpQkFBaUIsQ0FBQztRQUU3QixnQ0FBZ0M7UUFDaEMsTUFBTSxJQUFJLENBQUNjLE9BQU8sQ0FBQztRQUNuQixNQUFNLElBQUksQ0FBQ0csUUFBUSxDQUFDO0lBQ3RCO0FBQ0Y7QUFFQSxpRUFBZWxELGtCQUFrQkEsRUFBQyIsInNvdXJjZXMiOlsiL2hvbWUvZXJyb3I1MS9iaXRub2IvcHJvamVjdC92aWxsYWdlLXNhY2NvL3NyYy9zZXJ2aWNlcy9tb2NrLWJpdG5vYi5zZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIE1vY2sgc2VydmljZXMgZm9yIGZlYXR1cmVzIG5vdCBhdmFpbGFibGUgaW4gQml0bm9iIFNhbmRib3hcblxuaW50ZXJmYWNlIE1vY2tMaWdodG5pbmdQYXltZW50IHtcbiAgaWQ6IHN0cmluZztcbiAgYW1vdW50OiBudW1iZXI7XG4gIHN0YXR1czogJ3BlbmRpbmcnIHwgJ2NvbXBsZXRlZCcgfCAnZmFpbGVkJztcbiAgaW52b2ljZT86IHN0cmluZztcbiAgdGltZXN0YW1wOiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBNb2NrQ3Jvc3NCb3JkZXJUcmFuc2ZlciB7XG4gIGlkOiBzdHJpbmc7XG4gIGFtb3VudDogbnVtYmVyO1xuICBjdXJyZW5jeTogc3RyaW5nO1xuICByZWNpcGllbnRDb3VudHJ5OiBzdHJpbmc7XG4gIHN0YXR1czogJ3Byb2Nlc3NpbmcnIHwgJ2NvbXBsZXRlZCcgfCAnZmFpbGVkJztcbiAgZXhjaGFuZ2VSYXRlOiBudW1iZXI7XG4gIHRpbWVzdGFtcDogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgTW9ja1ZpcnR1YWxDYXJkIHtcbiAgaWQ6IHN0cmluZztcbiAgY2FyZE51bWJlcjogc3RyaW5nO1xuICBleHBpcnlEYXRlOiBzdHJpbmc7XG4gIHN0YXR1czogJ2FjdGl2ZScgfCAnYmxvY2tlZCcgfCAnZXhwaXJlZCc7XG4gIGJhbGFuY2U6IG51bWJlcjtcbiAgdHlwZTogJ3Zpc2EnIHwgJ21hc3RlcmNhcmQnO1xufVxuXG5pbnRlcmZhY2UgTW9ja1VTRFRPcGVyYXRpb24ge1xuICBpZDogc3RyaW5nO1xuICBhbW91bnQ6IG51bWJlcjtcbiAgdHlwZTogJ2J1eScgfCAnc2VsbCcgfCAndHJhbnNmZXInO1xuICBzdGF0dXM6ICdwZW5kaW5nJyB8ICdjb21wbGV0ZWQnIHwgJ2ZhaWxlZCc7XG4gIHJhdGU6IG51bWJlcjtcbiAgdGltZXN0YW1wOiBzdHJpbmc7XG59XG5cbi8qKlxuICogTW9jayBTZXJ2aWNlcyBmb3IgZmVhdHVyZXMgbm90IGF2YWlsYWJsZSBpbiBCaXRub2IgU2FuZGJveFxuICogVGhlc2UgcHJvdmlkZSByZWFsaXN0aWMgc2ltdWxhdGlvbnMgZm9yIGRldmVsb3BtZW50IGFuZCB0ZXN0aW5nXG4gKi9cbmV4cG9ydCBjbGFzcyBNb2NrQml0bm9iU2VydmljZXMge1xuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogTW9ja0JpdG5vYlNlcnZpY2VzO1xuICBwcml2YXRlIGxpZ2h0bmluZ1BheW1lbnRzOiBNb2NrTGlnaHRuaW5nUGF5bWVudFtdID0gW107XG4gIHByaXZhdGUgY3Jvc3NCb3JkZXJUcmFuc2ZlcnM6IE1vY2tDcm9zc0JvcmRlclRyYW5zZmVyW10gPSBbXTtcbiAgcHJpdmF0ZSB2aXJ0dWFsQ2FyZHM6IE1vY2tWaXJ0dWFsQ2FyZFtdID0gW107XG4gIHByaXZhdGUgdXNkdE9wZXJhdGlvbnM6IE1vY2tVU0RUT3BlcmF0aW9uW10gPSBbXTtcblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge31cblxuICBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogTW9ja0JpdG5vYlNlcnZpY2VzIHtcbiAgICBpZiAoIU1vY2tCaXRub2JTZXJ2aWNlcy5pbnN0YW5jZSkge1xuICAgICAgTW9ja0JpdG5vYlNlcnZpY2VzLmluc3RhbmNlID0gbmV3IE1vY2tCaXRub2JTZXJ2aWNlcygpO1xuICAgIH1cbiAgICByZXR1cm4gTW9ja0JpdG5vYlNlcnZpY2VzLmluc3RhbmNlO1xuICB9XG5cbiAgLy8gTGlnaHRuaW5nIE5ldHdvcmsgTW9jayBTZXJ2aWNlc1xuICBhc3luYyBjcmVhdGVMaWdodG5pbmdJbnZvaWNlKGFtb3VudDogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nKTogUHJvbWlzZTxNb2NrTGlnaHRuaW5nUGF5bWVudD4ge1xuICAgIGNvbnN0IGludm9pY2U6IE1vY2tMaWdodG5pbmdQYXltZW50ID0ge1xuICAgICAgaWQ6IGBsbl8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWAsXG4gICAgICBhbW91bnQsXG4gICAgICBzdGF0dXM6ICdwZW5kaW5nJyxcbiAgICAgIGludm9pY2U6IGBsbmJjJHthbW91bnR9bjFwJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgMjApfWAsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIH07XG4gICAgXG4gICAgdGhpcy5saWdodG5pbmdQYXltZW50cy5wdXNoKGludm9pY2UpO1xuICAgIFxuICAgIC8vIFNpbXVsYXRlIHByb2Nlc3NpbmcgYWZ0ZXIgMiBzZWNvbmRzXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBpbnZvaWNlLnN0YXR1cyA9IE1hdGgucmFuZG9tKCkgPiAwLjEgPyAnY29tcGxldGVkJyA6ICdmYWlsZWQnO1xuICAgIH0sIDIwMDApO1xuICAgIFxuICAgIHJldHVybiBpbnZvaWNlO1xuICB9XG5cbiAgYXN5bmMgc2VuZExpZ2h0bmluZ1BheW1lbnQoaW52b2ljZTogc3RyaW5nLCBhbW91bnQ6IG51bWJlcik6IFByb21pc2U8TW9ja0xpZ2h0bmluZ1BheW1lbnQ+IHtcbiAgICBjb25zdCBwYXltZW50OiBNb2NrTGlnaHRuaW5nUGF5bWVudCA9IHtcbiAgICAgIGlkOiBgbG5fcGF5XyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YCxcbiAgICAgIGFtb3VudCxcbiAgICAgIHN0YXR1czogJ3BlbmRpbmcnLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICB9O1xuICAgIFxuICAgIHRoaXMubGlnaHRuaW5nUGF5bWVudHMucHVzaChwYXltZW50KTtcbiAgICBcbiAgICAvLyBTaW11bGF0ZSBwcm9jZXNzaW5nXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBwYXltZW50LnN0YXR1cyA9IE1hdGgucmFuZG9tKCkgPiAwLjE1ID8gJ2NvbXBsZXRlZCcgOiAnZmFpbGVkJztcbiAgICB9LCAzMDAwKTtcbiAgICBcbiAgICByZXR1cm4gcGF5bWVudDtcbiAgfVxuXG4gIGFzeW5jIGdldExpZ2h0bmluZ1BheW1lbnRzKCk6IFByb21pc2U8TW9ja0xpZ2h0bmluZ1BheW1lbnRbXT4ge1xuICAgIHJldHVybiB0aGlzLmxpZ2h0bmluZ1BheW1lbnRzO1xuICB9XG5cbiAgLy8gQ3Jvc3MtQm9yZGVyIFRyYW5zZmVyIE1vY2sgU2VydmljZXNcbiAgYXN5bmMgaW5pdGlhdGVDcm9zc0JvcmRlclRyYW5zZmVyKFxuICAgIGFtb3VudDogbnVtYmVyLCBcbiAgICBjdXJyZW5jeTogc3RyaW5nLCBcbiAgICByZWNpcGllbnRDb3VudHJ5OiBzdHJpbmdcbiAgKTogUHJvbWlzZTxNb2NrQ3Jvc3NCb3JkZXJUcmFuc2Zlcj4ge1xuICAgIGNvbnN0IGV4Y2hhbmdlUmF0ZXM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7XG4gICAgICAnVVNEJzogMS4wLFxuICAgICAgJ05HTic6IDc1MCxcbiAgICAgICdLRVMnOiAxMzAsXG4gICAgICAnR0hTJzogMTIsXG4gICAgICAnRVVSJzogMC44NSxcbiAgICAgICdHQlAnOiAwLjc1XG4gICAgfTtcblxuICAgIGNvbnN0IHRyYW5zZmVyOiBNb2NrQ3Jvc3NCb3JkZXJUcmFuc2ZlciA9IHtcbiAgICAgIGlkOiBgY2JfJHtEYXRlLm5vdygpfV8ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KX1gLFxuICAgICAgYW1vdW50LFxuICAgICAgY3VycmVuY3ksXG4gICAgICByZWNpcGllbnRDb3VudHJ5LFxuICAgICAgc3RhdHVzOiAncHJvY2Vzc2luZycsXG4gICAgICBleGNoYW5nZVJhdGU6IGV4Y2hhbmdlUmF0ZXNbY3VycmVuY3ldIHx8IDEuMCxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgfTtcbiAgICBcbiAgICB0aGlzLmNyb3NzQm9yZGVyVHJhbnNmZXJzLnB1c2godHJhbnNmZXIpO1xuICAgIFxuICAgIC8vIFNpbXVsYXRlIHByb2Nlc3NpbmcgdGltZSAoNS0xMCBzZWNvbmRzIGZvciBjcm9zcy1ib3JkZXIpXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0cmFuc2Zlci5zdGF0dXMgPSBNYXRoLnJhbmRvbSgpID4gMC4wNSA/ICdjb21wbGV0ZWQnIDogJ2ZhaWxlZCc7XG4gICAgfSwgTWF0aC5yYW5kb20oKSAqIDUwMDAgKyA1MDAwKTtcbiAgICBcbiAgICByZXR1cm4gdHJhbnNmZXI7XG4gIH1cblxuICBhc3luYyBnZXRDcm9zc0JvcmRlclRyYW5zZmVycygpOiBQcm9taXNlPE1vY2tDcm9zc0JvcmRlclRyYW5zZmVyW10+IHtcbiAgICByZXR1cm4gdGhpcy5jcm9zc0JvcmRlclRyYW5zZmVycztcbiAgfVxuXG4gIC8vIFZpcnR1YWwgQ2FyZCBNb2NrIFNlcnZpY2VzXG4gIGFzeW5jIGNyZWF0ZVZpcnR1YWxDYXJkKHR5cGU6ICd2aXNhJyB8ICdtYXN0ZXJjYXJkJyA9ICd2aXNhJyk6IFByb21pc2U8TW9ja1ZpcnR1YWxDYXJkPiB7XG4gICAgY29uc3QgY2FyZDogTW9ja1ZpcnR1YWxDYXJkID0ge1xuICAgICAgaWQ6IGBjYXJkXyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YCxcbiAgICAgIGNhcmROdW1iZXI6IHRoaXMuZ2VuZXJhdGVDYXJkTnVtYmVyKHR5cGUpLFxuICAgICAgZXhwaXJ5RGF0ZTogdGhpcy5nZW5lcmF0ZUV4cGlyeURhdGUoKSxcbiAgICAgIHN0YXR1czogJ2FjdGl2ZScsXG4gICAgICBiYWxhbmNlOiAwLFxuICAgICAgdHlwZVxuICAgIH07XG4gICAgXG4gICAgdGhpcy52aXJ0dWFsQ2FyZHMucHVzaChjYXJkKTtcbiAgICByZXR1cm4gY2FyZDtcbiAgfVxuXG4gIGFzeW5jIGZ1bmRWaXJ0dWFsQ2FyZChjYXJkSWQ6IHN0cmluZywgYW1vdW50OiBudW1iZXIpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBjb25zdCBjYXJkID0gdGhpcy52aXJ0dWFsQ2FyZHMuZmluZChjID0+IGMuaWQgPT09IGNhcmRJZCk7XG4gICAgaWYgKGNhcmQpIHtcbiAgICAgIGNhcmQuYmFsYW5jZSArPSBhbW91bnQ7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgYXN5bmMgZ2V0VmlydHVhbENhcmRzKCk6IFByb21pc2U8TW9ja1ZpcnR1YWxDYXJkW10+IHtcbiAgICByZXR1cm4gdGhpcy52aXJ0dWFsQ2FyZHM7XG4gIH1cblxuICBhc3luYyBmcmVlemVWaXJ0dWFsQ2FyZChjYXJkSWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IGNhcmQgPSB0aGlzLnZpcnR1YWxDYXJkcy5maW5kKGMgPT4gYy5pZCA9PT0gY2FyZElkKTtcbiAgICBpZiAoY2FyZCkge1xuICAgICAgY2FyZC5zdGF0dXMgPSAnYmxvY2tlZCc7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLy8gVVNEVC9TdGFibGVjb2luIE1vY2sgU2VydmljZXNcbiAgYXN5bmMgYnV5VVNEVChhbW91bnQ6IG51bWJlcik6IFByb21pc2U8TW9ja1VTRFRPcGVyYXRpb24+IHtcbiAgICBjb25zdCBvcGVyYXRpb246IE1vY2tVU0RUT3BlcmF0aW9uID0ge1xuICAgICAgaWQ6IGB1c2R0X2J1eV8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWAsXG4gICAgICBhbW91bnQsXG4gICAgICB0eXBlOiAnYnV5JyxcbiAgICAgIHN0YXR1czogJ3BlbmRpbmcnLFxuICAgICAgcmF0ZTogMS4wICsgKE1hdGgucmFuZG9tKCkgLSAwLjUpICogMC4wMiwgLy8gU2ltdWxhdGUgc2xpZ2h0IHJhdGUgZmx1Y3R1YXRpb25cbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgfTtcbiAgICBcbiAgICB0aGlzLnVzZHRPcGVyYXRpb25zLnB1c2gob3BlcmF0aW9uKTtcbiAgICBcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIG9wZXJhdGlvbi5zdGF0dXMgPSBNYXRoLnJhbmRvbSgpID4gMC4wNSA/ICdjb21wbGV0ZWQnIDogJ2ZhaWxlZCc7XG4gICAgfSwgMjAwMCk7XG4gICAgXG4gICAgcmV0dXJuIG9wZXJhdGlvbjtcbiAgfVxuXG4gIGFzeW5jIHNlbGxVU0RUKGFtb3VudDogbnVtYmVyKTogUHJvbWlzZTxNb2NrVVNEVE9wZXJhdGlvbj4ge1xuICAgIGNvbnN0IG9wZXJhdGlvbjogTW9ja1VTRFRPcGVyYXRpb24gPSB7XG4gICAgICBpZDogYHVzZHRfc2VsbF8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWAsXG4gICAgICBhbW91bnQsXG4gICAgICB0eXBlOiAnc2VsbCcsXG4gICAgICBzdGF0dXM6ICdwZW5kaW5nJyxcbiAgICAgIHJhdGU6IDEuMCArIChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIDAuMDIsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIH07XG4gICAgXG4gICAgdGhpcy51c2R0T3BlcmF0aW9ucy5wdXNoKG9wZXJhdGlvbik7XG4gICAgXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBvcGVyYXRpb24uc3RhdHVzID0gTWF0aC5yYW5kb20oKSA+IDAuMDUgPyAnY29tcGxldGVkJyA6ICdmYWlsZWQnO1xuICAgIH0sIDIwMDApO1xuICAgIFxuICAgIHJldHVybiBvcGVyYXRpb247XG4gIH1cblxuICBhc3luYyB0cmFuc2ZlclVTRFQoYW1vdW50OiBudW1iZXIsIHJlY2lwaWVudDogc3RyaW5nKTogUHJvbWlzZTxNb2NrVVNEVE9wZXJhdGlvbj4ge1xuICAgIGNvbnN0IG9wZXJhdGlvbjogTW9ja1VTRFRPcGVyYXRpb24gPSB7XG4gICAgICBpZDogYHVzZHRfdHJhbnNmZXJfJHtEYXRlLm5vdygpfV8ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KX1gLFxuICAgICAgYW1vdW50LFxuICAgICAgdHlwZTogJ3RyYW5zZmVyJyxcbiAgICAgIHN0YXR1czogJ3BlbmRpbmcnLFxuICAgICAgcmF0ZTogMS4wLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICB9O1xuICAgIFxuICAgIHRoaXMudXNkdE9wZXJhdGlvbnMucHVzaChvcGVyYXRpb24pO1xuICAgIFxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgb3BlcmF0aW9uLnN0YXR1cyA9IE1hdGgucmFuZG9tKCkgPiAwLjEgPyAnY29tcGxldGVkJyA6ICdmYWlsZWQnO1xuICAgIH0sIDE1MDApO1xuICAgIFxuICAgIHJldHVybiBvcGVyYXRpb247XG4gIH1cblxuICBhc3luYyBnZXRVU0RUT3BlcmF0aW9ucygpOiBQcm9taXNlPE1vY2tVU0RUT3BlcmF0aW9uW10+IHtcbiAgICByZXR1cm4gdGhpcy51c2R0T3BlcmF0aW9ucztcbiAgfVxuXG4gIC8vIEhlbHBlciBtZXRob2RzXG4gIHByaXZhdGUgZ2VuZXJhdGVDYXJkTnVtYmVyKHR5cGU6ICd2aXNhJyB8ICdtYXN0ZXJjYXJkJyk6IHN0cmluZyB7XG4gICAgY29uc3QgcHJlZml4ID0gdHlwZSA9PT0gJ3Zpc2EnID8gJzQnIDogJzUnO1xuICAgIGxldCBjYXJkTnVtYmVyID0gcHJlZml4O1xuICAgIFxuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgMTY7IGkrKykge1xuICAgICAgY2FyZE51bWJlciArPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBjYXJkTnVtYmVyLnJlcGxhY2UoLyguezR9KS9nLCAnJDEgJykudHJpbSgpO1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZUV4cGlyeURhdGUoKTogc3RyaW5nIHtcbiAgICBjb25zdCBjdXJyZW50RGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgY29uc3QgZXhwaXJ5RGF0ZSA9IG5ldyBEYXRlKGN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCkgKyAzLCBjdXJyZW50RGF0ZS5nZXRNb250aCgpICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTIpKTtcbiAgICByZXR1cm4gYCR7KGV4cGlyeURhdGUuZ2V0TW9udGgoKSArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX0vJHtleHBpcnlEYXRlLmdldEZ1bGxZZWFyKCkudG9TdHJpbmcoKS5zdWJzdHIoMil9YDtcbiAgfVxuXG4gIC8vIERldmVsb3BtZW50IHV0aWxpdGllc1xuICBhc3luYyBjbGVhckFsbE1vY2tEYXRhKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMubGlnaHRuaW5nUGF5bWVudHMgPSBbXTtcbiAgICB0aGlzLmNyb3NzQm9yZGVyVHJhbnNmZXJzID0gW107XG4gICAgdGhpcy52aXJ0dWFsQ2FyZHMgPSBbXTtcbiAgICB0aGlzLnVzZHRPcGVyYXRpb25zID0gW107XG4gIH1cblxuICBhc3luYyBnZW5lcmF0ZVRlc3REYXRhKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIEdlbmVyYXRlIHNvbWUgdGVzdCBMaWdodG5pbmcgcGF5bWVudHNcbiAgICBhd2FpdCB0aGlzLmNyZWF0ZUxpZ2h0bmluZ0ludm9pY2UoNTAwMDAsICdUZXN0IEludm9pY2UgMScpO1xuICAgIGF3YWl0IHRoaXMuY3JlYXRlTGlnaHRuaW5nSW52b2ljZSgyNTAwMCwgJ1Rlc3QgSW52b2ljZSAyJyk7XG4gICAgXG4gICAgLy8gR2VuZXJhdGUgdGVzdCBjcm9zcy1ib3JkZXIgdHJhbnNmZXJzXG4gICAgYXdhaXQgdGhpcy5pbml0aWF0ZUNyb3NzQm9yZGVyVHJhbnNmZXIoMTAwLCAnTkdOJywgJ05pZ2VyaWEnKTtcbiAgICBhd2FpdCB0aGlzLmluaXRpYXRlQ3Jvc3NCb3JkZXJUcmFuc2Zlcig1MCwgJ0tFUycsICdLZW55YScpO1xuICAgIFxuICAgIC8vIEdlbmVyYXRlIHRlc3QgdmlydHVhbCBjYXJkc1xuICAgIGF3YWl0IHRoaXMuY3JlYXRlVmlydHVhbENhcmQoJ3Zpc2EnKTtcbiAgICBhd2FpdCB0aGlzLmNyZWF0ZVZpcnR1YWxDYXJkKCdtYXN0ZXJjYXJkJyk7XG4gICAgXG4gICAgLy8gR2VuZXJhdGUgdGVzdCBVU0RUIG9wZXJhdGlvbnNcbiAgICBhd2FpdCB0aGlzLmJ1eVVTRFQoMTAwKTtcbiAgICBhd2FpdCB0aGlzLnNlbGxVU0RUKDUwKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBNb2NrQml0bm9iU2VydmljZXM7XG4iXSwibmFtZXMiOlsiTW9ja0JpdG5vYlNlcnZpY2VzIiwibGlnaHRuaW5nUGF5bWVudHMiLCJjcm9zc0JvcmRlclRyYW5zZmVycyIsInZpcnR1YWxDYXJkcyIsInVzZHRPcGVyYXRpb25zIiwiZ2V0SW5zdGFuY2UiLCJpbnN0YW5jZSIsImNyZWF0ZUxpZ2h0bmluZ0ludm9pY2UiLCJhbW91bnQiLCJkZXNjcmlwdGlvbiIsImludm9pY2UiLCJpZCIsIkRhdGUiLCJub3ciLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHIiLCJzdGF0dXMiLCJ0aW1lc3RhbXAiLCJ0b0lTT1N0cmluZyIsInB1c2giLCJzZXRUaW1lb3V0Iiwic2VuZExpZ2h0bmluZ1BheW1lbnQiLCJwYXltZW50IiwiZ2V0TGlnaHRuaW5nUGF5bWVudHMiLCJpbml0aWF0ZUNyb3NzQm9yZGVyVHJhbnNmZXIiLCJjdXJyZW5jeSIsInJlY2lwaWVudENvdW50cnkiLCJleGNoYW5nZVJhdGVzIiwidHJhbnNmZXIiLCJleGNoYW5nZVJhdGUiLCJnZXRDcm9zc0JvcmRlclRyYW5zZmVycyIsImNyZWF0ZVZpcnR1YWxDYXJkIiwidHlwZSIsImNhcmQiLCJjYXJkTnVtYmVyIiwiZ2VuZXJhdGVDYXJkTnVtYmVyIiwiZXhwaXJ5RGF0ZSIsImdlbmVyYXRlRXhwaXJ5RGF0ZSIsImJhbGFuY2UiLCJmdW5kVmlydHVhbENhcmQiLCJjYXJkSWQiLCJmaW5kIiwiYyIsImdldFZpcnR1YWxDYXJkcyIsImZyZWV6ZVZpcnR1YWxDYXJkIiwiYnV5VVNEVCIsIm9wZXJhdGlvbiIsInJhdGUiLCJzZWxsVVNEVCIsInRyYW5zZmVyVVNEVCIsInJlY2lwaWVudCIsImdldFVTRFRPcGVyYXRpb25zIiwicHJlZml4IiwiaSIsImZsb29yIiwicmVwbGFjZSIsInRyaW0iLCJjdXJyZW50RGF0ZSIsImdldEZ1bGxZZWFyIiwiZ2V0TW9udGgiLCJwYWRTdGFydCIsImNsZWFyQWxsTW9ja0RhdGEiLCJnZW5lcmF0ZVRlc3REYXRhIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/services/mock-bitnob.service.ts\n");

/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "./work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "?32c4":
/*!****************************!*\
  !*** bufferutil (ignored) ***!
  \****************************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "?66e9":
/*!********************************!*\
  !*** utf-8-validate (ignored) ***!
  \********************************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("net");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "next/dist/shared/lib/no-fallback-error.external":
/*!******************************************************************!*\
  !*** external "next/dist/shared/lib/no-fallback-error.external" ***!
  \******************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/no-fallback-error.external");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/app-paths":
/*!**************************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/app-paths" ***!
  \**************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/app-paths");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

"use strict";
module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/ws","vendor-chunks/whatwg-url","vendor-chunks/webidl-conversions","vendor-chunks/isows"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2Fregister%2Froute&page=%2Fapi%2Fauth%2Fregister%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fregister%2Froute.ts&appDir=%2Fhome%2Ferror51%2Fbitnob%2Fproject%2Fvillage-sacco%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Ferror51%2Fbitnob%2Fproject%2Fvillage-sacco&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!")));
module.exports = __webpack_exports__;

})();